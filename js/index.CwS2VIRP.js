import{r as oe,o as t,c as be,d as Je,m as pt,u as Ze,a as ge,L as Ne,e as Fe,b as s,f as e,g as F,w as R,h as Y,t as c,F as A,i as E,j as x,k as fe,l as Xe,n as Ce,p as it,q as ze,s as et,P as je,v as ye,x as le,y as re,z as Te,A as vt,B as o,T as $e,C as q,D as ee,E as Qe,G as te,H as dt,I as Se,J as gt,K as Le,M as xe,N as qe,O as pe,Q as He,R as ke,S as bt,U as _e,V as Ae,W as Be,X as Ge,Y as rt,Z as yt,_ as $t,$ as ht,a0 as Ee,a1 as wt,a2 as _t,a3 as kt}from"./vendor-Kzoi8GQQ-chunk.js";(function(){const b=document.createElement("link").relList;if(b&&b.supports&&b.supports("modulepreload"))return;for(const k of document.querySelectorAll('link[rel="modulepreload"]'))M(k);new MutationObserver(k=>{for(const H of k)if(H.type==="childList")for(const V of H.addedNodes)V.tagName==="LINK"&&V.rel==="modulepreload"&&M(V)}).observe(document,{childList:!0,subtree:!0});function T(k){const H={};return k.integrity&&(H.integrity=k.integrity),k.referrerPolicy&&(H.referrerPolicy=k.referrerPolicy),k.crossOrigin==="use-credentials"?H.credentials="include":k.crossOrigin==="anonymous"?H.credentials="omit":H.credentials="same-origin",H}function M(k){if(k.ep)return;k.ep=!0;const H=T(k);fetch(k.href,H)}})();const St={__name:"App",setup(r){return(b,T)=>{const M=oe("router-view");return t(),be(M)}}},Tt=Je({id:"alert",state:()=>({alert:null}),actions:{success(r){this.alert={message:r,type:"alert-success"}},error(r){this.alert={message:r,type:"alert-danger"}},clear(){this.alert=null}}});function tt(){const r=N=>{var $;let L=N,n=L.response,I="";if(!L.response)return N.message;if(n.status===500){if(typeof n.data=="string")return n.data;if(n.data.content)return n.data.content;if(n.data.detail)return n.data.detail}if(n.status===401){const K=`${window.location.pathname}${window.location.search}`;I=`You are not authorized or your session timed out. Please click <a href='${`/accounts/login/?returnUrl=${encodeURIComponent(K)}`}'>here</a> to login.`}else if(n.status===400){let K=L.response.data.errors;I=L.response.data.title||L.response.data,K&&(I+="<ul>");for(let J in K){let u=K[J];for(let p in K[J]){let W=u[p];I+=`<li>${W}</li>`}}K&&(I+="</ul>"),I||(I=L.message),I&&I.content&&(I=I.content)}else n.status===404?I=(($=n==null?void 0:n.data)==null?void 0:$.title)||(n==null?void 0:n.data)||"Record not found.":typeof n.data=="string"&&(I=L.message,I===""&&(I=`Error <b>Http ${n.status}</b>.<br/>Please contact the System Administrator.`));return I},b=N=>JSON.parse(JSON.stringify(N)),T=N=>{if(typeof N!="number")return N;var L=new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2});return L.format(N)},M=(N,L,n)=>{const $={value:L,expiry:new Date().getTime()+n};debugger;localStorage.setItem(N,JSON.stringify($))},k=N=>{debugger;const L=localStorage.getItem(N);if(!L)return null;const n=JSON.parse(L);return new Date().getTime()>n.expiry?(localStorage.removeItem(N),null):n.value},H="pageSelectedTabStorageKey";return{getErrorMessageAsHtml:r,clone:b,toCurrency:T,moment:pt,localStorageSetWithExpiry:M,localStorageGetWithExpiry:k,setPageTab:(N,L)=>{var n=localStorage.getItem(H);n?n=JSON.parse(n):n={},n[N]=L,localStorage.setItem(H,JSON.stringify(n))},getPageTab:N=>{var L=localStorage.getItem(H);return L?L=JSON.parse(L):L={},L[N]},createHlsStream:(N,L,n)=>{var I=new Hls({autoStartLoad:n??!0});return I.on(Hls.Events.MEDIA_ATTACHED,function(){}),I.on(Hls.Events.MANIFEST_PARSED,function($,K){console.log("manifest loaded, found "+K.levels.length+" quality level")}),I.on(Hls.Events.ERROR,function($,K){if(K.fatal)switch(K.type){case Hls.ErrorTypes.MEDIA_ERROR:console.log("fatal media error encountered, try to recover"),I.recoverMediaError();break;case Hls.ErrorTypes.NETWORK_ERROR:console.error("fatal network error encountered",K);break;default:I.destroy();break}}),I.loadSource(L),I.attachMedia(N),I},isValidTime:N=>/^(2[0-3]|[01]?[0-9]):([0-5]?[0-9]):([0-5]?[0-9])$/.test(N),generateReturnUrl:()=>{const N=Ze();let L=N.path;return N.query.returnUrl&&(L=N.query.returnUrl),L=`?returnUrl=${encodeURIComponent(L)}`,L},getValidFeedbackCss:N=>N?"is-valid":"is-invalid"}}const It=tt(),ut=JSON.parse(localStorage.getItem("user"))||{},Mt=It.moment.utc(ut.exp*1e3),xt=Mt.isAfter()?ut:null,we=Je({id:"auth",state:()=>({user:xt,returnUrl:null}),actions:{async login(r){try{this.user=r,localStorage.setItem("user",JSON.stringify(r))}catch(b){debugger;alert(b)}},logout(){this.user=null,localStorage.removeItem("user"),at.push("/accounts/login")},logoutWithRedirect(){this.user=null,localStorage.removeItem("user")}}}),Ct="vue-3-pinia-registration-login-example-users";JSON.parse(localStorage.getItem(Ct));const Vt={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_URL:"https://vivafastpoc.azurewebsites.net/",VITE_APP_NAME:"Arcadian-FAST",VITE_AUTH_AUTHORITY_URL:"https://login.microsoftonline.com/c0c53936-9e16-412b-839b-b364ff184d00",VITE_AUTH_CLIENT_ID:"80062e2b-831d-4e1d-8966-1c80a519cd09",VITE_AWS_REGION:"us-west-2",VITE_AWS_USER_POOL_CLIENT_ID:"5bjn58mkaasn71076qm8ladcl0",VITE_AWS_USER_POOL_ID:"us-west-2_Ktunv0FfL",VITE_TENANT_NAME:"VIVA"},We=Vt,Ye=Je("msal",()=>{const r=ge({auth:{clientId:We.VITE_AUTH_CLIENT_ID,authority:We.VITE_AUTH_AUTHORITY_URL,postLogoutUri:We.VITE_AUTH_POST_LOGOUT_URI},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1,secureCookies:!1},system:{loggerOptions:{logLevel:Ne.Verbose,loggerCallback:(M,k,H)=>{if(!H)switch(M){case Ne.Error:console.error(k);return;case Ne.Info:console.info(k);return;case Ne.Verbose:console.debug(k);return;case Ne.Warning:console.warn(k);return}},piiLoggingEnabled:!1}}}),b=ge("");return{msalConfig:r,accessToken:b,setAccessToken:M=>{b.value=M}}}),st={$on:(...r)=>Fe.on(...r),$once:(...r)=>Fe.once(...r),$off:(...r)=>Fe.off(...r),$emit:(...r)=>Fe.emit(...r)};function At(){const r=(H,V,Q,j)=>{st.$emit("toast-message",{title:H,message:V,type:Q,options:j})};return{success:(H,V,Q={})=>{r(H,V,"success",Q)},warning:(H,V,Q={})=>{r(H,V,"warning",Q)},info:(H,V,Q={})=>{r(H,V,"info",Q)},error:(H,V,Q={})=>{r(H,V,"danger",Q)}}}const Oe=(r,b)=>{const T=r.__vccOpts||r;for(const[M,k]of b)T[M]=k;return T},Ot={data(){return{notifications:[],messages:[]}},async created(){const r=this;r.$bus.$on("event:notification-received",()=>{r.getUnreadNotifications()}),r.$bus.$on("event:notification-marked-as-read",b=>{r.notifications.some(M=>M.notificationId===b)&&r.getUnreadNotifications()}),r.$bus.$on("event:notification-removed",b=>{r.notifications.some(M=>M.notificationId===b)&&r.getUnreadNotifications()}),r.$bus.$on("event:chat-marked-as-read",r.onChatMarkedAsRead),r.$bus.$on("event:chat-message-received",r.onChatMessageReceived)},async mounted(){const r=this,b=r.$refs.notifications,T=r.$refs.messages;b&&b.offsetParent,T&&T.offsetParent&&await r.getUnreadChats()},methods:{async logout(){const r=this;try{await r.$util.axios.post("/api/accounts/logout").then(b=>{const T="/";r.$toast.warning("Logout","You have logged out of the system.",{timeOut:5e3,async onClose(){r.$util.href(T)}})})}catch(b){r.$util.handleError(b)}},async onChatMarkedAsRead(r){let b=this,T=b.messages.find(M=>M.chatId===r);if(T){let M=b.messages.indexOf(T);b.messages.splice(M,1)}},async onChatMessageReceived(r){let b=this,T=b.messages.find(k=>k.chatId===r.chatId);if(T)T.lastMessageText=r.content;else{var M={chatId:r.chatId,isRead:!1,lastDateSent:r.dateSent,lastMessageText:r.content,senderFirstLastName:`${r.sender.firstName} ${r.sender.lastName}`,senderInitials:r.sender.initials,senderProfilePicture32:r.sender.profilePicture32,urlPicture:b.$util.getProfilePictureUrl(r.sender.profilePicture32,r.sender.initials)};b.messages.push(M)}},async getUnreadNotifications(){const r=this;try{await r.$util.axios.get("api/accounts/unread-notifications").then(b=>{r.notifications=b.data})}catch(b){r.$util.handleError(b)}},async getUnreadChats(){const r=this;try{await r.$util.axios.get("api/accounts/unread-chats").then(b=>{r.messages=b.data;for(let T in r.messages){let M=r.messages[T];r.$set(M,"urlPicture",r.$util.getProfilePictureUrl(M.senderProfilePicture32,M.senderInitials))}})}catch(b){r.$util.handleError(b)}},viewNotification(r){this.$bus.$emit("event:open-notification",r)},viewChat(r){this.$bus.$emit("event:open-chat",r)},showHiddenElements(){let b=this.$el.getElementsByClassName("initialHidden");for(let T=0;T<b.length;T++)b[T].classList.remove("invisible")}}},Pt={mixins:[Ot],props:{uid:String,appName:{type:String,required:!0,default:"SCH2"},urlProfilePicture:String,menus:Array},components:{},data(){const b=we().user;return{user:b,username:b?b.nameFull:"Guest"}},async mounted(){},methods:{isActive(r){return window.location.href.indexOf(r)>-1},async openModalSearchUser747(r){this.$refs.refModalSearchUser747.open(r)}}},Ut={class:"sticky-top navbar navbar-expand-sm navbar-dark bg-primary bg-gradient shadow-sm py-2","aria-label":"Offcanvas navbar large"},Lt={class:"container-md"},Ht={class:"navbar-collapse collapse",id:"navbarSideCollapse"},Dt={class:"navbar-nav"},Et={class:"nav-item dropdown"},qt={class:"dropdown-menu","aria-labelledby":"dropdown01"},Bt={class:"nav-item dropdown"},Nt={class:"dropdown-menu","aria-labelledby":"dropdown01"},Rt={class:"navbar-nav ms-auto"},Ft={class:"nav-item dropdown"},zt={class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},Gt={class:"d-inline d-sm-none d-md-inline"},jt={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"dropdown01"},Yt={class:"text-capitalize"};function Kt(r,b,T,M,k,H){const V=oe("router-link");return t(),s("nav",Ut,[e("div",Lt,[F(V,{class:"navbar-brand",to:"/member"},{default:R(()=>[Y(c(T.appName),1)]),_:1}),b[14]||(b[14]=e("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSideCollapse","aria-controls":"navbarSideCollapse","aria-expanded":"false","aria-label":"Toggle Navigation"},[e("span",{class:"navbar-toggler-icon"})],-1)),e("div",Ht,[e("ul",Dt,[e("li",Et,[b[3]||(b[3]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",null,[e("span",{class:"fas fa-fw fa-user-group me-1"}),e("span",{class:"d-inline d-sm-none d-md-inline"},"Social")])],-1)),e("ul",qt,[e("li",null,[F(V,{class:"dropdown-item",to:"/member/announcements"},{default:R(()=>b[0]||(b[0]=[e("i",{class:"fas fa-fw fa-bullhorn me-1"},null,-1),Y(" Announcements ")])),_:1})]),e("li",null,[F(V,{class:"dropdown-item",to:"/member/posts"},{default:R(()=>b[1]||(b[1]=[e("i",{class:"fas fa-fw fa-signs-post me-1"},null,-1),Y(" Posts ")])),_:1})]),e("li",null,[F(V,{class:"dropdown-item",to:"/member/yellow-pages"},{default:R(()=>b[2]||(b[2]=[e("i",{class:"fas fa-fw fa-address-book me-1"},null,-1),Y(" Yellow Pages ")])),_:1})])])]),e("li",Bt,[b[5]||(b[5]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",null,[e("span",{class:"fas fa-fw fa-house-chimney-user me-1"}),e("span",{class:"d-inline d-sm-none d-md-inline"},"Home Owners")])],-1)),e("ul",Nt,[e("li",null,[F(V,{class:"dropdown-item",to:"/member/property-monthlydues"},{default:R(()=>b[4]||(b[4]=[Y(" Property Monthly Dues ")])),_:1})])])])]),e("ul",Rt,[e("li",Ft,[e("a",zt,[e("span",null,[b[6]||(b[6]=e("span",{class:"fas fa-fw fa-circle-user me-1"},null,-1)),e("span",Gt,c(k.username),1)])]),e("ul",jt,[b[9]||(b[9]=e("li",null,[e("h6",{class:"dropdown-header"},"Settings")],-1)),b[10]||(b[10]=e("li",null,[e("a",{class:"dropdown-item",href:"/member/account/changetheme"}," Profile ")],-1)),b[11]||(b[11]=e("li",null,[e("a",{class:"dropdown-item",href:"/member/account/changetheme"}," Theme ")],-1)),b[12]||(b[12]=e("li",null,[e("hr",{class:"dropdown-divider"})],-1)),k.user&&k.user.roles.length>1?(t(!0),s(A,{key:0},E(k.user.roles,Q=>(t(),s("li",null,[F(V,{to:`/${Q.toLowerCase()}`,class:"dropdown-item"},{default:R(()=>[e("span",Yt,c(Q),1)]),_:2},1032,["to"])]))),256)):x("",!0),e("li",null,[F(V,{to:"/",class:"dropdown-item"},{default:R(()=>b[7]||(b[7]=[Y(" Main ")])),_:1})]),b[13]||(b[13]=e("li",null,[e("hr",{class:"dropdown-divider"})],-1)),e("li",null,[F(V,{to:"/account/logout",class:"dropdown-item"},{default:R(()=>b[8]||(b[8]=[e("span",{class:"fas fa-fw fa-sign-out me-1"},null,-1),Y("Logout ")])),_:1})])])])])])])])}const Wt=Oe(Pt,[["render",Kt]]),Qt={props:{appName:{type:String,required:!1}},data(){return{busy:!1,enums:{orderStatuses:[{id:1,name:"Requested"},{id:2,name:"Placed"},{id:3,name:"Accepted"},{id:4,name:"Processed"},{id:5,name:"Delivered"},{id:6,name:"Completed"},{id:7,name:"Cancelled"}],promotionType:[{id:1,name:"Discounts"},{id:2,name:"Shipping"}],promotionProductApplicability:[{id:1,name:"All Products"},{id:2,name:"Specific Products"}],promotionOfferType:[{id:1,name:"No Code"},{id:2,name:"Generic Code"}],shipmentType:[{id:1,name:"Pickup"},{id:2,name:"Delivery"}]}}},async created(){},mounted(){this.showHiddenElements()},methods:{scrollIntoView(){const r=document.getElementById("top");r&&r.scrollIntoView({behavior:"smooth"})},showHiddenElements(){let r=this;if(!r.$el.getElementsByClassName)return;let b=r.$el.getElementsByClassName("initialHidden");for(let T=0;T<b.length;T++){let M=b[T];M.classList.remove("invisible"),M.classList.remove("d-none")}},close(){const r=this,b=document.referrer.toLowerCase();b&&b.includes("/account/login")?r.$router.go(-2):r.$router.go(-1)},toggle(r){const b=this;b.toggles[r]=!b.toggles[r],localStorage.setItem(b.togglesKey,JSON.stringify(b.toggles))}}},Jt={mixins:[Qt],props:{uid:String},data(){return{copyright:`2020-${new Date().getFullYear()} HOAMS - UbePages`}},computed:{},async created(){},async mounted(){},methods:{isActive(r){return window.location.href.indexOf(r)>-1}}},Zt={class:"footer sticky-bottom"},Xt={class:"d-none d-sm-block navbar navbar-dark bg-primary bg-gradient py-1"},es={class:"container-md"},ts={class:"navbar-text small p-0"},ss={class:"d-block d-sm-none navbar navbar-expand navbar-dark bg-primary bg-gradient py-1"},os={class:"container-md"},as={class:"navbar-nav nav-fill w-100"},ls={class:"nav-item dropup"},ns={class:"dropdown-menu","aria-labelledby":"dropdown01"},rs={class:"nav-item dropup"},is={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"dropdown01"};function ds(r,b,T,M,k,H){const V=oe("router-link");return t(),s("footer",Zt,[e("div",Xt,[e("div",es,[e("span",ts,"©"+c(k.copyright),1)])]),e("nav",ss,[e("div",os,[e("ul",as,[e("li",ls,[b[3]||(b[3]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",null,[e("span",{class:"fas fa-fw fa-user-group"})])],-1)),e("ul",ns,[e("li",null,[F(V,{class:"dropdown-item",to:"/member/announcements"},{default:R(()=>b[0]||(b[0]=[e("i",{class:"fas fa-fw fa-bullhorn me-1"},null,-1),Y(" Announcements ")])),_:1})]),e("li",null,[F(V,{class:"dropdown-item",to:"/member/posts"},{default:R(()=>b[1]||(b[1]=[e("i",{class:"fas fa-fw fa-signs-post me-1"},null,-1),Y(" Posts ")])),_:1})]),e("li",null,[F(V,{class:"dropdown-item",to:"/member/yellow-pages"},{default:R(()=>b[2]||(b[2]=[e("i",{class:"fas fa-fw fa-address-book me-1"},null,-1),Y(" Yellow Pages ")])),_:1})])])]),e("li",rs,[b[5]||(b[5]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",null,[e("span",{class:"fas fa-fw fa-house-chimney-user"})])],-1)),e("ul",is,[e("li",null,[F(V,{class:"dropdown-item",to:"/member/property-monthlydues"},{default:R(()=>b[4]||(b[4]=[Y(" Property Monthly Dues ")])),_:1})])])])])])])])}const us=Oe(Jt,[["render",ds]]),cs={name:"AdminLayout",components:{TopNav:Wt,BottomNav:us},inject:["$config"],mounted(){const b=this.$config;document.title=`Account - ${b.appName}`}},ms={class:"d-flex flex-column vh-100"};function fs(r,b,T,M,k,H){const V=oe("Toasts"),Q=oe("router-view");return t(),s("div",ms,[F(V),F(Q,{class:"flex-grow-1 mb-2"})])}const ps=Oe(cs,[["render",fs]]),vs={__name:"index",setup(r){return we().user,fe(()=>{}),(T,M)=>(t(),s("div",null,M[0]||(M[0]=[Xe('<div class="mt-2 pb-2 shadow-sm"><div class="container-md"><div class="row align-items-center"><div class="col-md-auto"><h1><i class="fas fa-fw fa-dashboard me-1"></i>Dashboard </h1></div><div class="col-md"></div></div></div></div><div class="mt-2 container-md"> Dashboard contents here </div>',2)])))}},gs={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_URL:"https://vivafastpoc.azurewebsites.net/",VITE_APP_NAME:"Arcadian-FAST",VITE_AUTH_AUTHORITY_URL:"https://login.microsoftonline.com/c0c53936-9e16-412b-839b-b364ff184d00",VITE_AUTH_CLIENT_ID:"80062e2b-831d-4e1d-8966-1c80a519cd09",VITE_AWS_REGION:"us-west-2",VITE_AWS_USER_POOL_CLIENT_ID:"5bjn58mkaasn71076qm8ladcl0",VITE_AWS_USER_POOL_ID:"us-west-2_Ktunv0FfL",VITE_TENANT_NAME:"VIVA"},bs=gs;function ys(){Ce("$config");const r=bs.VITE_API_URL,b=it.create({baseURL:r});return ze.configure({template:'<div class="bar pt-1 bg-warning" role="bar"><div class="peg1"></div></div><div class="spinner" role="spinner"><div class="fas fa-fw fa-circle-notch fa-spin text-warning"></div></div>'}),b.interceptors.request.use(T=>{ze.start();const{user:M}=we();return M&&M.token&&(T.headers?(T.headers.Authorization||(T.headers.Authorization=`Bearer ${M.token}`),T.headers["Access-Control-Allow-Origin"]||(T.headers["Access-Control-Allow-Origin"]="*")):T.headers={Authorization:`Bearer ${M.token}`,"Access-Control-Allow-Origin":"*"}),T}),b.interceptors.response.use(T=>(ze.done(),T),T=>{throw ze.done(),T}),b}function he(r){if(!r.appTitle)throw Error("App Title is required.");if(!r.pageTitle)throw Error("Page Title is required.");const b=Ze(),T=et(),M=ys(),k=tt(),H=At(),Q=we().user,j=()=>Q&&Q.roles&&Q.roles.includes("System"),S=()=>Q&&Q.roles&&Q.roles.includes("administrator"),z=()=>Q&&Q.roles&&Q.roles.includes("employee"),ae=()=>Q&&Q.roles&&Q.roles.includes("Member"),N=async()=>{const W=document.referrer.toLowerCase();W&&W.includes("/accounts/login")?await T.go(-2):await T.go(-1)},L=W=>{var y;const g=b.path,G=(y=b.query)==null?void 0:y.returnUrl;G&&g!==G?T.push(G):T.push(W)},n=r.appTitle,I=r.pageTitle,$=ge(!1),K=ge(new Map),J=ge(""),u=ge(""),p=ge("");return{appTitle:n,pageTitle:I,busy:$,validations:K,infoMessage:J,warningMessage:u,errorMessage:p,router:T,route:b,axios:M,utils:k,toasts:H,close:N,closeWithReturnUrl:L,generateReturnUrl:k.generateReturnUrl,security:{userId:Q?Q.userId:"",isSystem:j(),isAdministrator:S(),isEmployee:z(),isMember:ae()}}}const $s={class:"h-100 d-flex align-items-center justify-content-center"},hs={class:"form-signin w-100 m-auto"},ws={class:"h3 mb-3 fw-normal text-center"},_s={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},ks=["innerHTML"],Ss={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},Ts=["disabled"],Is={class:"d-flex flex-row align-items-center"},Ms={key:0,class:"float-start fas fa-fw fa-circle-notch fa-spin"},xs={__name:"login",props:{urlReturn:{type:String,required:!1}},setup(r){Ce("$config");const b=we(),T=Ye(),M=new je(T.msalConfig),k=ye({username:"",password:""}),H={username:{required:le.withMessage("Username is required.",re),$autoDirty:!0,$lazy:!0},password:{required:le.withMessage("Password is required.",re),$autoDirty:!0,$lazy:!0}},V=Te(H,k),{appTitle:Q,pageTitle:j,busy:S,isDirty:z,validations:ae,infoMessage:N,warningMessage:L,errorMessage:n,router:I,route:$,axios:K,utils:J,toasts:u,close:p,security:W}=he({appTitle:"Arcadian-FAST (VIVA)",pageTitle:"Sign On"}),g={redirectUri:window.location.origin+"/accounts/loginRedirect"};fe(async()=>{S.value=!0,await M.initialize();let m=null;if(await M.handleRedirectPromise().then(i=>{const d=M.getAllAccounts();d.length>0&&(m=d[0])}).catch(i=>{debugger}),!m){S.value=!1;return}try{const i={loginHint:m==null?void 0:m.username,redirectUri:window.location.origin+"/accounts/loginRedirect"},d=await M.ssoSilent(i);if(d){await u.success("SSO","Session created, redirecting to home page.",{onClose:async()=>{await y(d.account)}});return}}catch(i){if(i.errorCode=="login_required")try{const d=await M.loginPopup(g);if(d){await u.success("SSO","Login popup successful, redirecting to home page.",{onClose:async()=>{await y(d.account)}});return}}catch{u.warning("SSO","Login failed. Please enable third-party cookies or remove popup blocker, then retry.")}else u.warning("SSO Active Session Check","There was an issue while checking for active session, please signin.")}S.value=!1});const G=async()=>{var m={account:M.getActiveAccount(),scopes:[]};await M.acquireTokenSilent(m).then(i=>{const l=i.account.idToken,a=vt(l);a.token=i.accessToken,console.log(i),a.roles||(a.roles=[]),a.userId=a.sub,b.login(a);var h=$.query.returnUrl;h?I.push(decodeURIComponent(h)):a.roles.length===1?I.push(`/${a.roles[0].toLowerCase()}`):I.push("/")}).catch(i=>{u.warning("Error while requesting access token",i),console.error(`error during acquireTokenSilent: ${i}`)})},y=async m=>{M.setActiveAccount(m),await G()},f=async()=>{S.value=!0;const m=M.getAllAccounts();if(m.length===0)try{await M.loginRedirect(g);return}catch(d){JSON.stringify(d);debugger}const i=m[0];await y(i)};return(m,i)=>(t(),be($e,null,{default:R(()=>[e("div",$s,[e("main",hs,[e("div",null,[e("h1",ws,c(o(Q)),1),e("div",null,[o(n)?(t(),s("div",_s,[i[1]||(i[1]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Y("Error ")],-1)),e("div",{innerHTML:o(n)},null,8,ks)])):x("",!0),o(V).$error?(t(),s("div",Ss,[i[2]||(i[2]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Y("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(A,null,E(o(V).$errors,d=>(t(),s("li",{key:d.$uid},c(d.$message),1))),128))])])):x("",!0)]),e("button",{onClick:i[0]||(i[0]=d=>f()),disabled:o(S),class:"btn btn-primary w-100 py-2"},[e("div",Is,[o(S)?(t(),s("span",Ms)):x("",!0),i[3]||(i[3]=e("span",{class:"mx-auto"},"Single Sign On",-1))])],8,Ts)])])])]),_:1}))}},Cs=Oe(xs,[["__scopeId","data-v-19879e55"]]),Vs={class:"d-flex flex-column justify-content-center align-items-middle"},As={class:"mx-auto"},Os={class:"alert text-bg-success shadow"},Ps={class:"d-flex flex-row align-items-center"},Us={key:0,class:"float-start fas fa-fw fa-circle-notch fa-spin"},Ls={__name:"loginRedirect",setup(r){we();const b=Ye(),T=new je(b.msalConfig);return fe(async()=>{await T.initialize(),await T.handleRedirectPromise().then(M=>{}).catch(M=>{debugger})}),(M,k)=>(t(),be($e,null,{default:R(()=>[e("div",Vs,[e("div",As,[e("div",Os,[e("div",Ps,[M.busy?(t(),s("span",Us)):x("",!0),k[0]||(k[0]=e("span",null,"SSO successful, redirecting to login page.",-1))])])])])]),_:1}))}},Hs={class:"h-100 d-flex align-items-center justify-content-center"},Ds={__name:"logout",setup(r){const b=we();return b.user,fe(async()=>{b.logoutWithRedirect()}),(T,M)=>(t(),s("div",Hs,M[0]||(M[0]=[e("div",{class:"card"},[e("div",{class:"card-header"}," Sign-Out "),e("div",{class:"card-body"},[Y(" You have logged out from HOA MS."),e("br"),Y(" Click "),e("a",{href:"/",class:"d-inline"},"here"),Y(" to go back to home page. ")])],-1)])))}},Es={class:"h-100 d-flex align-items-center justify-content-center"},qs={class:"card m-3"},Bs={class:"card-header"},Ns={class:"card-body"},Rs={class:"m-2"},Fs={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},zs=["innerHTML"],Gs={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},js={class:"row row-cols-1 row-cols-sm-3"},Ys={class:"col-sm"},Ks={class:"form-group"},Ws={key:0,class:"d-block invalid-feedback"},Qs={class:"col-sm"},Js={class:"form-group"},Zs={key:0,class:"d-block invalid-feedback"},Xs={class:"col-sm"},eo={class:"form-group"},to={key:0,class:"d-block invalid-feedback"},so={class:"row row-cols-1 row-cols-sm-3"},oo={class:"col"},ao={class:"form-group"},lo={key:0,class:"d-block invalid-feedback"},no={class:"col"},ro={class:"form-group"},io={key:0,class:"d-block invalid-feedback"},uo={class:"row row-cols-1 row-cols-sm-3"},co={class:"col-sm"},mo={class:"form-group"},fo={key:0,class:"d-block invalid-feedback"},po={class:"col-sm"},vo={class:"form-group"},go={key:0,class:"d-block invalid-feedback"},bo={class:"mt-2 row row-cols-1 row-cols-sm-3 g-2"},yo={class:"col"},$o=["disabled"],ho={class:"col"},wo={class:"col"},_o={__name:"register",props:{urlReturn:{type:String,required:!1}},setup(r){const b=ye({firstName:"",middleName:"",lastName:"",phoneNumber:"",email:"",password:"",confirmPassword:""}),T=(W,g)=>W===g.password,M={firstName:{required:le.withMessage("First name is required.",re),$autoDirty:!0,$lazy:!0},middleName:{required:le.withMessage("Middle name is required.",re),$autoDirty:!0,$lazy:!0},lastName:{required:le.withMessage("Last name is required.",re),$autoDirty:!0,$lazy:!0},phoneNumber:{required:le.withMessage("Phone number is required.",re),$autoDirty:!0,$lazy:!0},email:{required:le.withMessage("Email is required.",re),$autoDirty:!0,$lazy:!0},password:{required:le.withMessage("Password is required.",re),$autoDirty:!0,$lazy:!0},confirmPassword:{required:le.withMessage("Confirm password is required.",re),confirmSamePassword:le.withMessage("Password and confirm passwrod are different.",T),$autoDirty:!0,$lazy:!0}},k=Te(M,b),{appTitle:H,pageTitle:V,busy:Q,isDirty:j,validations:S,infoMessage:z,warningMessage:ae,errorMessage:N,router:L,axios:n,utils:I,toasts:$,close:K,security:J}=he({appTitle:"HOA MS",pageTitle:"Register User"}),u=Ce("$config");fe(()=>{});const p=async()=>{const W=b;if(Q.value)return;if(!await k.value.$validate()){window.scrollTo(0,0);return}N.value=null;try{Q.value=!0;const G=I.clone(W);G.tenantid=u.tenantId;debugger;await n({method:"post",url:"/api/v1/accounts/register",data:G}).then(y=>{$.success("Register","Registration was successfull.",{onClose:async()=>{await L.push("/accounts/login")}})})}catch(G){N.value=I.getErrorMessageAsHtml(G),window.scrollTo(0,0)}finally{Q.value=!1}};return(W,g)=>{const G=oe("router-link");return t(),be($e,null,{default:R(()=>[e("div",Es,[e("div",qs,[e("h4",Bs,c(o(V)),1),e("div",Ns,[e("div",Rs,[o(N)?(t(),s("div",Fs,[g[8]||(g[8]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Y("Error ")],-1)),e("div",{innerHTML:o(N)},null,8,zs)])):x("",!0),o(k).$error?(t(),s("div",Gs,[g[9]||(g[9]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Y("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(A,null,E(o(k).$errors,y=>(t(),s("li",{key:y.$uid},c(y.$message),1))),128))])])):x("",!0)]),e("div",js,[e("div",Ys,[e("div",Ks,[g[10]||(g[10]=e("label",null,"First Name",-1)),q(e("input",{"onUpdate:modelValue":g[0]||(g[0]=y=>b.firstName=y),type:"text",class:"form-control"},null,512),[[ee,b.firstName]]),o(k).firstName.$error?(t(),s("div",Ws,[(t(!0),s(A,null,E(o(k).firstName.$errors,y=>(t(),s("div",{key:y.$uid},c(y.$message),1))),128))])):x("",!0)])]),e("div",Qs,[e("div",Js,[g[11]||(g[11]=e("label",null,"Middle Name",-1)),q(e("input",{"onUpdate:modelValue":g[1]||(g[1]=y=>b.middleName=y),type:"text",class:"form-control"},null,512),[[ee,b.middleName]]),o(k).middleName.$error?(t(),s("div",Zs,[(t(!0),s(A,null,E(o(k).middleName.$errors,y=>(t(),s("div",{key:y.$uid},c(y.$message),1))),128))])):x("",!0)])]),e("div",Xs,[e("div",eo,[g[12]||(g[12]=e("label",null,"Last Name",-1)),q(e("input",{"onUpdate:modelValue":g[2]||(g[2]=y=>b.lastName=y),type:"text",class:"form-control"},null,512),[[ee,b.lastName]]),o(k).lastName.$error?(t(),s("div",to,[(t(!0),s(A,null,E(o(k).lastName.$errors,y=>(t(),s("div",{key:y.$uid},c(y.$message),1))),128))])):x("",!0)])])]),e("div",so,[e("div",oo,[e("div",ao,[g[13]||(g[13]=e("label",null,"Phone Number",-1)),q(e("input",{"onUpdate:modelValue":g[3]||(g[3]=y=>b.phoneNumber=y),type:"tel",class:"form-control"},null,512),[[ee,b.phoneNumber]]),o(k).phoneNumber.$error?(t(),s("div",lo,[(t(!0),s(A,null,E(o(k).phoneNumber.$errors,y=>(t(),s("div",{key:y.$uid},c(y.$message),1))),128))])):x("",!0)])]),e("div",no,[e("div",ro,[g[14]||(g[14]=e("label",null,"Email",-1)),q(e("input",{"onUpdate:modelValue":g[4]||(g[4]=y=>b.email=y),type:"email",class:"form-control"},null,512),[[ee,b.email]]),o(k).email.$error?(t(),s("div",io,[(t(!0),s(A,null,E(o(k).email.$errors,y=>(t(),s("div",{key:y.$uid},c(y.$message),1))),128))])):x("",!0)])])]),e("div",uo,[e("div",co,[e("div",mo,[g[15]||(g[15]=e("label",null,"Password",-1)),q(e("input",{"onUpdate:modelValue":g[5]||(g[5]=y=>b.password=y),type:"password",class:"form-control"},null,512),[[ee,b.password]]),o(k).password.$error?(t(),s("div",fo,[(t(!0),s(A,null,E(o(k).password.$errors,y=>(t(),s("div",{key:y.$uid},c(y.$message),1))),128))])):x("",!0)])]),e("div",po,[e("div",vo,[g[16]||(g[16]=e("label",null,"Confirm Password",-1)),q(e("input",{"onUpdate:modelValue":g[6]||(g[6]=y=>b.confirmPassword=y),type:"password",class:"form-control"},null,512),[[ee,b.confirmPassword]]),o(k).confirmPassword.$error?(t(),s("div",go,[(t(!0),s(A,null,E(o(k).confirmPassword.$errors,y=>(t(),s("div",{key:y.$uid},c(y.$message),1))),128))])):x("",!0)])])]),e("div",bo,[e("div",yo,[e("button",{disabled:o(k).$dirty&&o(k).$invalid,onClick:g[7]||(g[7]=y=>p()),class:"btn btn-primary w-100"},g[17]||(g[17]=[e("span",{class:"fas fa-fw fa-save me-1"},null,-1),Y("Register ")]),8,$o)]),e("div",ho,[F(G,{to:"/",class:"btn btn-outline-primary w-100"},{default:R(()=>g[18]||(g[18]=[Y("Home")])),_:1})]),e("div",wo,[F(G,{to:"/accounts/login",class:"btn btn-outline-primary w-100"},{default:R(()=>g[19]||(g[19]=[Y("Login")])),_:1})])])])])])]),_:1})}}},ko={path:"/accounts",component:ps,props:!1,meta:{},children:[{path:"",component:vs},{path:"login",component:Cs},{path:"loginRedirect",component:Ls},{path:"logout",component:Ds},{path:"register",component:_o}]};function ot(){const r=et(),b=j=>window.location.href.indexOf(j)>-1,T=j=>localStorage.getItem("data-bs-theme")||j,M=j=>{document.documentElement.setAttribute("data-bs-theme",j),localStorage.setItem("data-bs-theme",j)},k=async()=>await it.get("https://bootswatch.com/api/5.json").then(j=>j.data),H=j=>{const S=document.querySelector("link[href*='https://cdn.jsdelivr.net/npm/bootswatch']");S&&j?(S.setAttribute("href",j),localStorage.setItem("bootswatch-theme",j)):alert("cannot query css link")},V=j=>{Q(),r.push(j)},Q=()=>{if(screen.width<576){const S=document.getElementById("navbarCollapse");if(S){const z=Qe.getInstance(S);z&&z.hide()}}};return{isActive:b,getCurrentBsTheme:T,changeBsTheme:M,getBootswatch:k,changeTheme:H,navigate:V,collapseNavbar:Q}}const So={class:"sticky-top navbar navbar-expand-sm bg-primary","data-bs-theme":"dark"},To={class:"container-md"},Io={class:"navbar-collapse collapse",id:"navbarCollapse"},Mo={class:"navbar-nav"},xo={class:"nav-item"},Co={class:"nav-item dropdown"},Vo={class:"dropdown-menu","aria-labelledby":"dropdown01"},Ao={class:"nav-item"},Oo={class:"nav-item dropdown"},Po={class:"dropdown-menu","aria-labelledby":"dropdown01"},Uo={class:"navbar-nav ms-auto"},Lo={class:"nav-item dropdown"},Ho={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"dropdown01"},Do=["onClick"],Eo={class:"nav-item dropdown"},qo={class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},Bo={class:"d-sm-none d-xl-inline"},No={key:0},Ro={key:1},Fo={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"dropdown01"},zo={key:0},Go={key:1},jo={__name:"topNav",props:{appName:{type:String,default:"Arcadian-FAST"}},setup(r){const b=Ye(),{isActive:T,getCurrentBsTheme:M,changeBsTheme:k,getBootswatch:H,changeTheme:V,navigate:Q,collapseNavbar:j}=ot(),S=we(),z=S.user,ae=ye({user:z,username:z?z.nameFull:"Guest",bsTheme:"dark",currentTheme:"",bootswatch:{}});fe(async()=>{const I=ae;I.bootswatch=await H();const $=M(I.bsTheme);debugger;$&&(I.bsTheme=$,k(I.bsTheme));const K=localStorage.getItem("bootswatch-theme");K&&(I.currentTheme=K,V(K))});const N=I=>{V(I),ae.currentTheme=I,j()},L=I=>{k(I),ae.bsTheme=I,j()},n=async()=>{S.logoutWithRedirect();const I=new je(b.msalConfig);await I.initialize();const $={mainWindowRedirectUri:"/"};await I.logoutPopup($)};return(I,$)=>{const K=oe("router-link");return t(),be($e,null,{default:R(()=>[e("nav",So,[e("div",To,[F(K,{class:"navbar-brand",to:"/administrator"},{default:R(()=>[Y(c(r.appName),1)]),_:1}),$[18]||($[18]=e("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarCollapse","aria-controls":"navbarSideCollapse","aria-expanded":"false","aria-label":"Toggle Navigation"},[e("span",{class:"navbar-toggler-icon"})],-1)),e("div",Io,[e("ul",Mo,[e("li",xo,[F(K,{to:"/videos",onClick:o(j),class:"nav-link"},{default:R(()=>$[3]||($[3]=[e("span",{class:"fas fa-fw fa-video me-1"},null,-1),e("span",{class:"d-sm-none d-xl-inline"}," Videos ",-1)])),_:1},8,["onClick"])]),e("li",Co,[$[6]||($[6]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",{class:"fas fa-fw fa-warehouse me-1"}),e("span",{class:"d-sm-none d-xl-inline"}," Sources ")],-1)),e("ul",Vo,[e("li",null,[F(K,{to:"/source-groups",onClick:o(j),class:"dropdown-item"},{default:R(()=>$[4]||($[4]=[Y(" Groups ")])),_:1},8,["onClick"])]),e("li",null,[F(K,{to:"/source-locations",onClick:o(j),class:"dropdown-item"},{default:R(()=>$[5]||($[5]=[Y(" Locations ")])),_:1},8,["onClick"])])])]),e("li",Ao,[F(K,{to:"/vod-sources",onClick:o(j),class:"nav-link"},{default:R(()=>$[7]||($[7]=[e("span",{class:"fas fa-fw fa-tags me-1"},null,-1),e("span",{class:"d-sm-none d-xl-inline"}," Video on Demand (VOD) ",-1)])),_:1},8,["onClick"])]),e("li",Oo,[$[10]||($[10]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",{class:"fas fa-fw fa-microphone-lines me-1"}),e("span",{class:"d-sm-none d-xl-inline"}," Channel Assembly ")],-1)),e("ul",Po,[e("li",null,[F(K,{to:"/program-templates",onClick:o(j),class:"dropdown-item"},{default:R(()=>$[8]||($[8]=[Y(" Program Templates ")])),_:1},8,["onClick"])]),e("li",null,[F(K,{to:"/channels",onClick:o(j),class:"dropdown-item"},{default:R(()=>$[9]||($[9]=[Y(" Channels ")])),_:1},8,["onClick"])])])])]),e("ul",Uo,[e("li",Lo,[$[14]||($[14]=e("a",{class:"nav-link dropdown-toggle",href:"#",id:"dropdown01","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",{class:"fas fa-fw fa-wand-sparkles me-1"}),e("span",{class:"d-sm-none d-xl-inline"},"Themes")],-1)),e("ul",Ho,[e("li",null,[ae.bsTheme==="dark"?(t(),s("button",{key:0,onClick:$[0]||($[0]=J=>L("light")),class:"dropdown-item"},$[11]||($[11]=[e("span",{class:"fas fa-fw fa-lightbulb me-1"},null,-1),Y("Dark Mode ")]))):(t(),s("button",{key:1,onClick:$[1]||($[1]=J=>L("dark")),class:"dropdown-item"},$[12]||($[12]=[e("span",{class:"fas fa-fw fa-lightbulb me-1"},null,-1),Y("Light Mode ")])))]),$[13]||($[13]=e("li",null,[e("hr",{class:"dropdown-divider"})],-1)),(t(!0),s(A,null,E(ae.bootswatch.themes,J=>(t(),s("li",null,[e("button",{onClick:u=>N(J.cssCdn),class:te(["dropdown-item",{active:ae.currentTheme===J.cssCdn}])},c(J.name),11,Do)]))),256))])]),e("li",Eo,[e("a",qo,[e("span",null,[$[15]||($[15]=e("span",{class:"fas fa-fw fa-circle-user me-1"},null,-1)),e("span",Bo,[o(z)?(t(),s("span",No,c(o(z).name),1)):(t(),s("span",Ro," Guest "))])])]),e("ul",Fo,[o(z)?(t(),s("li",zo,[e("button",{onClick:$[2]||($[2]=J=>n()),class:"dropdown-item"},$[16]||($[16]=[e("span",{class:"fas fa-fw fa-sign-out me-1"},null,-1),Y("Logout ")]))])):(t(),s("li",Go,[F(K,{to:"/accounts/login",class:"dropdown-item"},{default:R(()=>$[17]||($[17]=[e("span",{class:"fas fa-fw fa-sign-in me-1"},null,-1),Y("Login ")])),_:1})]))])])])])])])]),_:1})}}},Yo={id:"sideNav",class:"collapse collapse-horizontal show"},Ko={class:"d-flex flex-column bg-dark min-vh-100 overflow-y-auto"},Wo={class:"navbar bg-primary bg-gradient","data-bs-theme":"dark"},Qo={class:"navbar-brand me-0 mb-1 px-2"},Jo={class:"d-none d-md-inline"},Zo={class:"nav nav-pills flex-column px-1 mt-2",role:"tablist"},Xo={class:"nav-item"},ea={id:"sources",class:"list-group"},ta={class:"nav-item"},sa={id:"assets",class:"list-group"},oa={class:"nav-item"},aa={id:"assembly",class:"list-group"},la={class:"nav nav-pills flex-column mt-auto px-1 mb-5",role:"tablist"},na={class:"nav-item d-none"},ra={id:"themes",class:"list-group collapse"},ia={class:"list-group-item border-bottom"},da=["onClick"],ua={class:"nav-item"},ca={href:"#",class:"nav-link dropdown-toggle collapsed","data-bs-toggle":"collapse","data-bs-target":"#user","aria-expanded":"false","aria-controls":"user"},ma={class:"d-none d-md-inline ms-1"},fa={id:"user",class:"list-group collapse"},pa={class:"list-group-item border-bottom"},va={key:0,class:"fas fa-fw fa-angle-double-left"},ga={key:1,class:"fas fa-fw fa-angle-double-right"},ba={__name:"sideNav",props:{appName:{type:String,default:"Arcadian-FAST (VIVA)"}},setup(r){const b=Ye(),T=Ze(),M=et(),k=we(),H=k.user,{isActive:V,getCurrentBsTheme:Q,changeBsTheme:j,getBootswatch:S,changeTheme:z,navigate:ae,collapseNavbar:N}=ot(),L=ye({user:H,username:H?H.nameFull:"Guest",bsTheme:"dark",currentTheme:"darkly",bootswatch:{}});fe(async()=>{J();const y=document.getElementById("sideNav");y&&(K.value?y.classList.add("show"):y.classList.remove("show"))});const n=y=>{z(y),L.currentTheme=y,G("themes")},I=y=>{j(y),L.bsTheme=y,G("themes")},$=async()=>{k.logoutWithRedirect();const y=new je(b.msalConfig);await y.initialize();const f={mainWindowRedirectUri:window.location.origin};try{await y.logoutRedirect(f)}catch(m){JSON.parse(JSON.stringify(m));debugger}},K=ge(!0),J=()=>{const y=localStorage.getItem("show-sideNav")||"true";K.value=y==="true"},u=()=>{localStorage.setItem("show-sideNav",K.value),Qe.getInstance("#sideNav").toggle()},p=()=>{K.value=!K.value,u()},W=(y,f)=>{var m=Array.isArray(y);const i=T;if(m){var d=y.find(a=>i.path.startsWith(a));return d?f||"active":""}var l=T.path.startsWith(y);return l?f||"active":""},g=async(y,f)=>{G(f),await M.push(y)},G=y=>{const f=Qe.getInstance(`#${y}`);f&&f.hide()};return(y,f)=>{const m=oe("router-link");return t(),s("div",null,[e("div",Yo,[e("div",Ko,[e("nav",Wo,[F(m,{to:"/",class:"text-decoration-none w-100 text-center"},{default:R(()=>[e("h1",Qo,[f[9]||(f[9]=e("span",{class:"fas fa-fw fa-home d-inline d-md-none"},null,-1)),e("span",Jo,c(r.appName),1)])]),_:1})]),e("ul",Zo,[e("li",Xo,[f[12]||(f[12]=e("a",{href:"#",class:"nav-link","data-bs-target":"#sources","aria-expanded":"false","aria-controls":"sources"},[e("span",{class:"fas fa-fw fa-boxes-packing"}),e("span",{class:"d-none d-md-inline ms-1"},"Sources")],-1)),e("ul",ea,[e("li",{class:te([W("/source-groups"),"list-group-item"])},[e("button",{onClick:f[0]||(f[0]=i=>g("/source-groups","sources")),class:"dropdown-item ps-3 ms-4",role:"button"},f[10]||(f[10]=[e("span",{class:"fas fa-fw fa-warehouse"},null,-1),e("span",{class:"d-none d-md-inline ms-1"},"Groups",-1)]))],2),e("li",{class:te([W("/source-locations"),"list-group-item"])},[e("button",{onClick:f[1]||(f[1]=i=>g("/source-locations","sources")),class:"dropdown-item ps-3 ms-4",role:"button"},f[11]||(f[11]=[e("span",{class:"fas fa-fw fa-building"},null,-1),e("span",{class:"d-none d-md-inline ms-1"},"Locations",-1)]))],2)])]),e("li",ta,[f[15]||(f[15]=e("a",{href:"#",class:"nav-link","data-bs-target":"#assets","aria-expanded":"false","aria-controls":"sources"},[e("span",{class:"fas fa-fw fa-photo-video"}),e("span",{class:"d-none d-md-inline ms-1"},"Assets")],-1)),e("ul",sa,[e("li",{class:te([W("/videos"),"list-group-item"])},[e("button",{onClick:f[2]||(f[2]=i=>g("/videos","assets")),class:"dropdown-item ps-3 ms-4",role:"button"},f[13]||(f[13]=[e("span",{class:"fas fa-fw fa-video"},null,-1),e("span",{class:"d-none d-md-inline ms-1"},"Videos",-1)]))],2),e("li",{class:te([W("/vod-sources"),"list-group-item"])},[e("button",{onClick:f[3]||(f[3]=i=>g("/vod-sources","assets")),class:"dropdown-item ps-3 ms-4",role:"button"},f[14]||(f[14]=[e("span",{class:"fas fa-fw fa-tags"},null,-1),e("span",{class:"d-none d-md-inline ms-1"},"VOD",-1)]))],2)])]),e("li",oa,[f[18]||(f[18]=e("a",{href:"#",class:"nav-link","data-bs-target":"#assembly","aria-expanded":"false","aria-controls":"sources"},[e("span",{class:"fas fa-fw fa-industry"}),e("span",{class:"d-none d-md-inline ms-1"},"Assembly")],-1)),e("ul",aa,[e("li",{class:te([W("/program-templates"),"list-group-item"])},[e("button",{onClick:f[4]||(f[4]=i=>g("/program-templates","assembly")),class:"dropdown-item ps-3 ms-4",role:"button"},f[16]||(f[16]=[e("span",{class:"fas fa-fw fa-file-video"},null,-1),e("span",{class:"d-none d-md-inline ms-1"},"Program Templates",-1)]))],2),e("li",{class:te([W("/channels"),"list-group-item"])},[e("button",{onClick:f[5]||(f[5]=i=>g("/channels","assembly")),class:"dropdown-item ps-3 ms-4",role:"button"},f[17]||(f[17]=[e("span",{class:"fas fa-fw fa-tv"},null,-1),e("span",{class:"d-none d-md-inline ms-1"},"Channels",-1)]))],2)])])]),e("ul",la,[e("li",na,[f[21]||(f[21]=e("a",{href:"#",class:"nav-link dropdown-toggle collapsed","data-bs-toggle":"collapse","data-bs-target":"#themes","aria-expanded":"false","aria-controls":"themes"},[e("span",{class:"fas fa-fw fa-wand-sparkles"}),e("span",{class:"d-none d-md-inline ms-1"},"Themes")],-1)),e("ul",ra,[e("li",ia,[L.bsTheme==="dark"?(t(),s("button",{key:0,onClick:f[6]||(f[6]=i=>I("light")),class:"dropdown-item ps-3"},f[19]||(f[19]=[e("span",{class:"fas fa-fw fa-lightbulb me-1"},null,-1),Y("Dark Mode ")]))):(t(),s("button",{key:1,onClick:f[7]||(f[7]=i=>I("dark")),class:"dropdown-item ps-3"},f[20]||(f[20]=[e("span",{class:"fas fa-fw fa-lightbulb me-1"},null,-1),Y("Light Mode ")])))]),(t(!0),s(A,null,E(L.bootswatch.themes,i=>(t(),s("li",{class:te([{active:L.currentTheme===i.cssCdn},"list-group-item"])},[e("button",{onClick:d=>n(i.cssCdn),class:"dropdown-item ps-3"},c(i.name),9,da)],2))),256))])]),e("li",ua,[e("a",ca,[f[22]||(f[22]=e("span",{class:"fas fa-fw fa-user-cog"},null,-1)),e("span",ma,c(o(H).name),1)]),e("ul",fa,[e("li",pa,[e("button",{onClick:f[8]||(f[8]=i=>$()),class:"dropdown-item"},f[23]||(f[23]=[e("span",{class:"fas fa-fw fa-sign-out me-1"},null,-1),Y("Logout ")]))])])])])])]),e("button",{id:"sideNavToggler",onClick:p,"data-bs-target":"#sideNav","data-bs-toggle":"collapse",class:te([[K.value?"btn-primary":"btn-outline-primary"],"btn btn-sm fixed-bottom z-3 p-0 ms-1 mb-1"]),style:{width:"2rem",height:"2rem"}},[K.value?(t(),s("span",va)):(t(),s("span",ga))],2)])}}},ya={class:"footer sticky-bottom"},$a={class:"d-sm-block navbar navbar-dark bg-dark bg-gradient1 py-1"},ha={class:"container-md"},wa={class:"navbar-text small p-0"},_a={__name:"bottomNav",props:{appName:{type:String,default:"SCH2"}},setup(r){ot();const b=Ce("$config"),M=we().user;let H=new Date().getFullYear();const V=ye({user:M,username:M?M.nameFull:"Guest",copyright:`2020-${H} ${b.appName}`});return fe(async()=>{}),(Q,j)=>(t(),s("footer",ya,[e("div",$a,[e("div",ha,[e("span",wa,"©"+c(V.copyright),1)])])]))}},ka={props:{showProgress:{type:Boolean,default:!0},rtl:{type:Boolean,default:!1},maxMessages:{type:Number,default:5},timeOut:{type:Number,default:3e3},closeable:{type:Boolean,default:!0}},data(){return{messages:[],count:0}},created(){st.$on("toast-message",this.handleMessageEvent)},methods:{handleMessageEvent(r){r.message&&this.addMessage(r.title,r.message,r.type,r.options)},async addMessage(r,b,T,M={}){var k={id:this.count++,title:r,message:b,type:T,showProgress:this.showProgress,timeOut:this.timeOut,closeable:this.closeable,rtl:this.rtl,progress:0,paused:!1,animationFrame:null};k=Object.assign({},k,M),this.messages.unshift(k),this.messages.length>this.maxMessages&&this.messages.splice(this.maxMessages),k.timeOut>0&&await this.startTimeout(k)},async startTimeout(r,b=0){const T=this,M=performance.now(),k=async()=>{r.animationFrame=requestAnimationFrame(async H=>{const V=H+b-M;if(!T.exists(r)||r.paused){cancelAnimationFrame(r.animationFrame);return}else if(V<r.timeOut){const Q=V/r.timeOut;r.progress=Q,await k()}else{r.progress=1,cancelAnimationFrame(r.animationFrame),T.remove(r);return}})};await k()},pauseProgress(r){r.timeOut<=0||(r.paused=!0)},async resumeProgress(r){r.timeOut<=0||(r.paused=!1,await this.startTimeout(r,r.timeOut*r.progress))},getCurrentProgress(r){return Math.round(r.progress*100)===100?100:r.progress*100},getIconClass(r){const b=r.type;let T="";switch(b){case"success":T="fas fa-fw fa-circle-check";break;case"info":T="fas fa-fw fa-circle-info";break;case"warning":T="fas fa-fw fa-circle-exclamation";break;case"danger":T="fas fa-fw fa-triangle-exclamation";break}let M=T;return r.rtl?"icon-right "+M:"icon-left "+M},async remove(r){const b=this.messages.findIndex(T=>T.id===r.id);this.messages.splice(b,1),typeof r.onClose=="function"&&await r.onClose()},exists(r){return this.messages.findIndex(T=>T.id===r.id)!==-1}}},Sa={"aria-live":"polite","aria-atomic":"true",class:"position-static"},Ta=["onMouseover","onMouseout"],Ia={class:"me-auto text-white"},Ma=["onClick"],xa={class:"toast-body"},Ca=["innerHTML"],Va={key:0,class:"progress m-1",style:{height:"4px"}};function Aa(r,b,T,M,k,H){return t(),be($e,null,{default:R(()=>[e("div",Sa,[F(Se,{class:"toast-container top-0 end-0 p-3",name:"toast",tag:"div",appear:""},{default:R(()=>[(t(!0),s(A,null,E(k.messages,V=>(t(),s("div",{key:V.id,class:te(["toast show mb-2 ms-auto",`border-${V.type}`]),role:"alert","aria-live":"assertive","aria-atomic":"true",onMouseover:Q=>H.pauseProgress(V),onMouseout:Q=>H.resumeProgress(V)},[e("div",{class:te(["toast-header",`bg-${V.type}`])},[e("strong",Ia,[e("i",{class:te([H.getIconClass(V),"me-1"])},null,2),Y(c(V.title),1)]),V.closeable?(t(),s("button",{key:0,type:"button",class:"mr-2 mb-1 btn-close","data-dismiss":"toast","aria-label":"Close",onClick:Q=>H.remove(V)},b[0]||(b[0]=[e("span",{"aria-hidden":"true"},null,-1)]),8,Ma)):x("",!0)],2),e("div",xa,[e("div",{innerHTML:V.message},null,8,Ca)]),V.timeOut>0&&V.showProgress?(t(),s("div",Va,[e("div",{class:te(`bg-${V.type}`),style:dt({width:H.getCurrentProgress(V)+"%"})},null,6)])):x("",!0)],42,Ta))),128))]),_:1})])]),_:1})}const Oa=Oe(ka,[["render",Aa],["__scopeId","data-v-5272bd9a"]]),Pa={name:"AdminLayout",components:{TopNav:jo,SideNav:ba,BottomNav:_a},inject:["$config"],mounted(){this.$config,document.title="Administrator"}},Ua={class:"d-flex flex-row flex-nowrap vh-100"};function La(r,b,T,M,k,H){const V=oe("Toasts"),Q=oe("SideNav"),j=oe("router-view"),S=oe("DialogsWrapper");return t(),s("div",Ua,[F(V),F(Q),F(j,{class:"d-flex flex-column w-100 h-100"}),F(S)])}const Ha=Oe(Pa,[["render",La]]),Da={class:"mt-2 container overflow-y-auto"},Ea={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},qa=["innerHTML"],Ba={class:"row gx-xxl-0 mb-2"},Na={class:"col-xxl-5"},Ra={class:""},Fa=["id"],za={key:1,class:"card card-header bg-warning-subtle mb-2"},Ga={class:"col-xxl-7 overflow-x-auto mt-xxl-0"},ja={class:"p-2"},Ya={class:"d-flex flex-row justify-content-between"},Ka=["src"],Wa={class:"badge bg-info"},Qa={class:"overflow-x-auto"},Ja={class:"d-flex flex-row"},Za={class:"me-2 px-2 border-end border-secondary",style:{width:"10rem"}},Xa={class:"text-center"},el=["src"],tl=["data-bs-title"],sl={class:"border-bottom text-end mt-1"},ol={class:"text-nowrap"},al={key:0,class:"badge bg-warning mb-1"},ll={class:""},nl={class:"badge bg-info me-1"},rl={__name:"Index",props:{urlViewChannel:{type:String,default:"/channels/view"}},setup(r){const{appTitle:b,pageTitle:T,busy:M,isDirty:k,validations:H,infoMessage:V,warningMessage:Q,errorMessage:j,router:S,axios:z,utils:ae,toasts:N,close:L,generateReturnUrl:n,security:I}=he({appTitle:"ARC AIO",pageTitle:"Dashboard"});Ce("$config"),we().user;const K=ye({item:null});ge("805630ed-f288-4f2f-83a4-6c71312f6970"),ge(),fe(async()=>{await p(),[...document.querySelectorAll('[data-bs-toggle="tooltip"]')].map(y=>new gt(y))}),Le(()=>{K.item.forEach(G=>{G.hls&&(G.hls.stopLoad(),G.hls.destroy())})});const J=async()=>{const G=K;if(!M.value)try{M.value=!0;const y="/api/v1/epg/";G.item=[],await z.get(y).then(f=>{G.item=f.data}),G.item.forEach(f=>{W(f)})}catch(y){j.value=ae.getErrorMessageAsHtml(y),window.scrollTo(0,0)}finally{M.value=!1}},u=async()=>{if(confirm("Are you sure you want to Reset All Data?"))try{await z.get("/api/v1/channels/reset/").then(f=>{N.success("Reset All Data","Reset data was successful.")})}catch(y){j.value=ae.getErrorMessageAsHtml(y),window.scrollTo(0,0)}finally{M.value=!1}},p=async()=>{await J()},W=G=>{if(G.manifestUrl&&Hls.isSupported()){g(G);var y=document.getElementById(`video-${G.id}`);if(!y)return;G.hls&&(G.hsl.stopLoad(),G.hls.destroy());let f=G.manifestUrl;G.hls=ae.createHlsStream(y,f);return}},g=G=>{G.outputs&&G.outputs.forEach(f=>{if(f.hls){debugger;f.hls.detachMedia(),f.hls.destroy(),delete f.hls}f.playbackConfigurations.forEach(m=>{if(m.hls){debugger;m.hls.detachMedia(),m.hls.destroy(),delete m.hls}})})};return(G,y)=>{const f=oe("PageHeader"),m=oe("router-link");return t(),be($e,null,{default:R(()=>[e("div",null,[F(f,{"page-icon":"fas fa-fw fa-dashboard",pageTitle:o(T)},{default:R(()=>[e("div",null,[e("button",{onClick:y[0]||(y[0]=i=>u()),class:"ms-2 btn btn-danger"},y[2]||(y[2]=[e("span",{class:"fas fa-fw fa-recycle me-1"},null,-1),Y("Reset All Data ")])),e("button",{onClick:y[1]||(y[1]=i=>p()),class:"ms-2 btn btn-secondary"},y[3]||(y[3]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)]))])]),_:1},8,["pageTitle"]),e("div",Da,[o(j)?(t(),s("div",Ea,[y[4]||(y[4]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Y("Error ")],-1)),e("div",{innerHTML:JSON.stringify(o(j))},null,8,qa)])):x("",!0),(t(!0),s(A,null,E(K.item,i=>(t(),s("div",null,[e("div",Ba,[e("div",Na,[e("div",Ra,[i.manifestUrl?(t(),s("video",{key:0,id:`video-${i.id}`,controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-scale align-middle"},null,8,Fa)):(t(),s("div",za," Channel not yet published "))])]),e("div",Ga,[e("div",ja,[e("div",Ya,[e("div",null,[e("h4",null,[e("img",{src:i.logo,class:"img-fluid me-2",style:{height:"3rem"}},null,8,Ka),F(m,{to:`${r.urlViewChannel}/${i.id}/${o(n)()}`},{default:R(()=>[Y(c(i.title),1)]),_:2},1032,["to"])])]),e("div",null,[e("span",Wa,c(i.playbackMode),1)])]),e("div",Qa,[e("div",Ja,[(t(!0),s(A,null,E(i.programs,d=>(t(),s("div",Za,[e("div",Xa,[e("img",{src:d.image,class:"img-fluid border",style:{height:"64px"}},null,8,el)]),e("div",{class:"text-truncate border-bottom","data-bs-toggle":"tooltip","data-bs-placement":"bottom","data-bs-title":d.title},c(d.title),9,tl),i.playbackMode==="LINEAR"?(t(),s(A,{key:0},[e("div",sl,[e("div",null,[e("small",ol,c(o(ae).moment(d.since).format("lll")),1)]),e("div",null,[e("small",null,c(o(ae).moment(d.till).format("lll")),1)])]),o(ae).moment().isAfter(d.since)&&o(ae).moment().isBefore(d.till)?(t(),s("span",al,"Now Playing")):x("",!0)],64)):x("",!0),e("div",ll,[(t(!0),s(A,null,E(d.genres,l=>(t(),s("span",nl,c(l),1))),256))])]))),256))])])])])])]))),256))])])]),_:1})}}};function De(r){if(!r.cacheKey)throw Error("Cache Key required.");if(!r.baseUrl)throw Error("Base Url required.");const{appTitle:b,pageTitle:T,busy:M,infoMessage:k,warningMessage:H,errorMessage:V,router:Q,axios:j,utils:S,toasts:z,close:ae,closeWithReturnUrl:N,generateReturnUrl:L,security:n}=he({appTitle:r.appTitle,pageTitle:r.pageTitle}),I=JSON.parse(JSON.stringify(r.filter));I.pageIndex=I.pageIndex||1,I.pageSize=I.pageSize||5,I.sortField=I.sortField||"",I.sortOrder=I.sortOrder||1,I.updateUrl=I.updateUrl||!1,I.items=I.items||[],I.query=I.query||{},I.query.criteria=I.query.criteria||"";const $=ge(I),K=()=>{var i;if(M.value){console.log("Paginated search is currently busy.");return}const y=JSON.parse(localStorage.getItem(r.cacheKey))||{},f=new URLSearchParams(window.location.search),m=$.value;m.query.criteria=f.get("c")||y.criteria||m.query.criteria||"",m.pageIndex=parseInt(f.get("p"),10)||y.pageIndex||m.pageIndex||1,m.pageSize=parseInt(f.get("s"),10)||y.pageSize||m.pageSize||5,m.sortField=f.get("sf")||y.sortField||m.sortField||"",m.sortOrder=parseInt(f.get("so"),10)||y.sortOrder||m.sortOrder||1,m.visible=y.visible||m.visible,(i=r.initializeFilter)==null||i.call(r,$,r.cacheKey)},J=()=>{if(r.getQuery)return r.getQuery($.value);{const y=$.value;return["?c=",encodeURIComponent(y.query.criteria),"&p=",y.pageIndex,"&s=",y.pageSize,"&sf=",y.sortField,"&so=",y.sortOrder].join("")}},u=()=>{if(r.saveQuery)r.saveQuery($.value,r.cacheKey);else{const y=$.value;localStorage.setItem(r.cacheKey,JSON.stringify({criteria:y.query.criteria,pageIndex:y.pageIndex,pageSize:y.pageSize,sortField:y.sortField,sortOrder:y.sortOrder,visible:y.visible}))}};return{appTitle:b,pageTitle:T,busy:M,infoMessage:k,warningMessage:H,errorMessage:V,router:Q,axios:j,utils:S,toasts:z,close:ae,closeWithReturnUrl:N,generateReturnUrl:L,security:n,filter:$,initializeFilter:K,getQuery:J,saveQuery:u,search:async y=>{var m;let f=$.value;if(M.value){console.log("Paginated search is currently busy.");return}y>0&&(f.pageIndex=y);try{M.value=!0,V.value="";const i=J();f.selected=null,await j(`${r.baseUrl}/${i}`).then(async d=>{var a;Array.isArray(d.data)?f.items=d.data:f=Object.assign(f,d.data);let l=location.pathname;l.endsWith("/")?l+=i:l+="/"+i,f.updateUrl&&window.history.replaceState(i,`${b}-search`,l),f.items.forEach(h=>{h.expand=!1}),u(),(a=r.successAction)==null||a.call(r,$.value)})}catch(i){if(localStorage.removeItem(r.cacheKey),r.failAction)r.failAction(i);else{const d=S.getErrorMessageAsHtml(i);V.value=d,z.error("Error Occured",d)}}finally{M.value=!1,(m=r.finalAction)==null||m.call(r)}},getRowNumber:y=>{const f=$.value;return(f.pageIndex-1)*f.pageSize+(y+1)},setSelected:y=>{const f=$.value;f.selected&&y&&f.selected===y?f.selected=null:(f.selected&&(f.selected.expand=!1),f.selected=y,f.selected.expand=!0)},isSelected:y=>{const f=$.value;return y===null||f.selected===null?!1:y===f.selected}}}const il=["disabled"],dl={class:"row row-cols-1 row-cols-sm-3"},ul={class:"col"},cl={class:"form-floating mb-2"},ml={key:0,class:"d-block invalid-feedback"},fl={class:"col"},pl={class:"form-floating"},vl={class:"col"},gl={class:"form-floating"},bl={class:"col"},yl={class:"form-floating mb-2"},$l={class:"row row-cols-1 row-cols-sm-2"},hl={class:"col-sm-8"},wl={class:"ps-2"},_l={class:"row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 border"},kl={class:"col"},Sl={class:"form-check"},Tl=["onUpdate:modelValue","id"],Il=["for"],Ml={class:"col-sm-4"},xl={class:"border p-2"},Cl={class:"form-check"},Vl=["onUpdate:modelValue","id"],Al=["for"],Ol={class:"table-responsive mt-2"},Pl={class:"text-end"},Ul={class:"table table-sm mb-0 mt-2"},Ll={class:"align-middle"},Hl={class:"text-center"},Dl=["onUpdate:modelValue"],El=["value"],ql=["onUpdate:modelValue"],Bl=["value"],Nl=["onUpdate:modelValue"],Rl={class:"text-start"},Fl=["onClick"],zl={__name:"add",props:{urlView:{type:String,default:"/videos/view"},urlMain:{type:String,default:"/videos"}},setup(r){const{appTitle:b,pageTitle:T,busy:M,infoMessage:k,warningMessage:H,errorMessage:V,router:Q,axios:j,utils:S,toasts:z,close:ae,security:N}=he({appTitle:"Arcadian-FAST",pageTitle:"Add Video"}),L=r,n=ye({lookups:{genres:[],sourceLocations:[],categories:[{id:1,name:"Ad Break"},{id:2,name:"Filler Slate"},{id:3,name:"Program Content"}],formats:[]},durationTime:"00:00:00",item:{title:null,description:null,durationInMillis:12e4,dateReleased:S.moment().format("YYYY-MM-DD"),formats:[]}}),I={item:{title:{title:le.withMessage("Title is required.",re),$autoDirty:!0,$lazy:!0},durationInMillis:{title:le.withMessage("Duration is required.",re),$autoDirty:!0,$lazy:!0},dateReleased:{title:le.withMessage("Date Released is required.",re),$autoDirty:!0,$lazy:!0}}},$=Te(I,n),K=xe(()=>{const y=S.moment;if(n.durationTime&&n.durationTime!=="00:00:00"&&S.isValidTime(n.durationTime)){const f=y().startOf("day"),m=f.format("YYYY-MM-DD ")+n.durationTime,d=y(m).subtract(f);return n.item.durationInMillis=d.valueOf(),n.item.durationInMillis}return 0});fe(async()=>{await u(),await p(),await W()});const J=async()=>{const y=n;if(M.value)return;if(!await $.value.$validate()){window.scrollTo(0,0);return}try{M.value=!0,V.value="";const m=S.clone(y.item);m.durationInMillis=K.value;const i=S.moment(y.item.dateReleased).utc(!0).format();m.dateReleased=i;const d=n.lookups.genres.filter(a=>a.selected).map(a=>a.id);if(m.genres=d,d.length<=0){alert("At least one genre is required.");return}const l=n.lookups.categories.filter(a=>a.selected).map(a=>a.id);if(m.categories=l,l.length<=0){alert("At least one category is required.");return}if(m.formats<=0){alert("At least one format is required.");return}await j.post("/api/v1/videos/",m).then(a=>{z.success("Add Video","Video added",{onClose:async()=>{const h=`${L.urlView}/${a.data}`;await Q.push(h)}})})}catch(m){V.value=S.getErrorMessageAsHtml(m),window.scrollTo(0,0)}finally{M.value=!1}},u=async()=>{try{await j.get("/api/v1/lookups/video-genres/").then(y=>{const m=y.data.filter(i=>i.id!==0);n.lookups.genres=m})}catch(y){V.value=S.getErrorMessageAsHtml(y),window.scrollTo(0,0)}finally{}},p=async()=>{try{await j.get("/api/v1/lookups/video-formats/").then(y=>{const m=y.data.filter(i=>i.id!==0);n.lookups.formats=m})}catch(y){V.value=S.getErrorMessageAsHtml(y),window.scrollTo(0,0)}finally{}},W=async()=>{try{await j.get("/api/v1/sourcelocations/lookup/").then(y=>{n.lookups.sourceLocations=y.data})}catch(y){V.value=S.getErrorMessageAsHtml(y),window.scrollTo(0,0)}finally{}},g=()=>{const y={format:"HLS",serverUrl:"https://media-tailor-output.s3.us-west-2.amazonaws.com",path:"/ads/10seconds/10seconds.m3u8"};n.item.formats.push(y)},G=y=>{n.item.formats.splice(y,1)};return(y,f)=>{const m=oe("router-link"),i=oe("PageHeader"),d=oe("PageBody");return t(),be($e,null,{default:R(()=>[e("div",null,[F(i,{"page-icon":"fas fa-fw fa-video",pageTitle:o(T)},{default:R(()=>[e("button",{disabled:o($).$dirty&&o($).$invalid,onClick:f[0]||(f[0]=l=>J()),class:"btn btn-primary"},f[6]||(f[6]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,il),F(m,{to:L.urlMain,class:"btn btn-secondary ms-2"},{default:R(()=>f[7]||(f[7]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),F(d,{errorMessage:o(V),vuelidate:o($)},{default:R(()=>[e("div",null,[e("div",dl,[e("div",ul,[e("div",cl,[q(e("input",{"onUpdate:modelValue":f[1]||(f[1]=l=>n.item.title=l),id:"name",class:te([o(S).getValidFeedbackCss(n.item.title),"form-control"]),placeholder:"Title"},null,2),[[ee,n.item.title]]),f[8]||(f[8]=e("label",{for:"title",class:""},"Title",-1)),o($).item.title.$error?(t(),s("div",ml,[(t(!0),s(A,null,E(o($).item.title.$errors,l=>(t(),s("div",{key:l.$uid},c(l.$message),1))),128))])):x("",!0)])]),e("div",fl,[e("div",pl,[q(e("input",{"onUpdate:modelValue":f[2]||(f[2]=l=>n.item.dateReleased=l),type:"date",step:"1",id:"dateReleased",class:te([o(S).getValidFeedbackCss(n.item.dateReleased),"form-control"])},null,2),[[ee,n.item.dateReleased]]),f[9]||(f[9]=e("label",{for:"dateReleased",class:""},"Date Released",-1))])]),e("div",vl,[e("div",gl,[q(e("input",{"onUpdate:modelValue":f[3]||(f[3]=l=>n.durationTime=l),type:"time",step:"1",id:"durationTime",class:te([o(S).getValidFeedbackCss(n.durationTime),"form-control"])},null,2),[[ee,n.durationTime]]),f[10]||(f[10]=e("label",{for:"durationTime",class:""},"Duration Time",-1))])])]),e("div",bl,[e("div",yl,[q(e("textarea",{"onUpdate:modelValue":f[4]||(f[4]=l=>n.item.description=l),id:"name",class:te([o(S).getValidFeedbackCss(n.item.description),"form-control"]),placeholder:"Description",style:{height:"5rem"}},null,2),[[ee,n.item.description]]),f[11]||(f[11]=e("label",{for:"description",class:""},"Description",-1))])]),e("div",$l,[e("div",hl,[f[12]||(f[12]=e("b",null,"Genres",-1)),e("div",wl,[e("div",_l,[(t(!0),s(A,null,E(n.lookups.genres,l=>(t(),s("div",kl,[e("div",Sl,[q(e("input",{"onUpdate:modelValue":a=>l.selected=a,class:"form-check-input",type:"checkbox",id:l.name},null,8,Tl),[[qe,l.selected]]),e("label",{class:"form-check-label",for:l.name},c(l.name),9,Il)])]))),256))])])]),e("div",Ml,[f[13]||(f[13]=e("b",null,"Categories",-1)),e("div",xl,[(t(!0),s(A,null,E(n.lookups.categories,l=>(t(),s("div",Cl,[q(e("input",{"onUpdate:modelValue":a=>l.selected=a,class:"form-check-input",type:"checkbox",id:l.name},null,8,Vl),[[qe,l.selected]]),e("label",{class:"form-check-label",for:l.name},c(l.name),9,Al)]))),256))])])]),e("div",Ol,[e("div",Pl,[e("button",{onClick:f[5]||(f[5]=l=>g()),class:"btn btn-outline-primary btn-sm"},f[14]||(f[14]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))]),e("table",Ul,[f[16]||(f[16]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Format"),e("th",null,"Server"),e("th",null,"Path"),e("th")])],-1)),e("tbody",null,[(t(!0),s(A,null,E(n.item.formats,(l,a)=>(t(),s("tr",Ll,[e("td",Hl,c(a+1),1),e("td",null,[q(e("select",{"onUpdate:modelValue":h=>l.format=h,class:"form-control"},[(t(!0),s(A,null,E(n.lookups.formats,h=>(t(),s("option",{value:h.id},c(h.name),9,El))),256))],8,Dl),[[pe,l.format]])]),e("td",null,[q(e("select",{"onUpdate:modelValue":h=>l.serverUrl=h,class:"form-select",id:"serverUrl"},[(t(!0),s(A,null,E(n.lookups.sourceLocations,h=>(t(),s("option",{value:h.baseUrl},c(h.name)+" - ["+c(h.baseUrl)+"] ",9,Bl))),256))],8,ql),[[pe,l.serverUrl]])]),e("td",null,[q(e("input",{"onUpdate:modelValue":h=>l.path=h,type:"text",class:"form-control"},null,8,Nl),[[ee,l.path]])]),e("td",Rl,[e("button",{onClick:h=>G(a),class:"btn btn-outline-warning btn-sm"},f[15]||(f[15]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,Fl)])]))),256))])])])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},Gl=["disabled"],jl={class:"row row-cols-1 row-cols-sm-3"},Yl={class:"col"},Kl={class:"form-floating mb-2"},Wl={key:0,class:"d-block invalid-feedback"},Ql={class:"col"},Jl={class:"form-floating"},Zl={class:"col"},Xl={class:"form-floating"},en={class:"col"},tn={class:"form-floating mb-2"},sn={class:"row row-cols-1 row-cols-sm-2"},on={class:"col-sm-8"},an={class:"ps-2"},ln={class:"row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 border"},nn={class:"col"},rn={class:"form-check"},dn=["onUpdate:modelValue","id"],un=["for"],cn={class:"col-sm-4"},mn={class:"border p-2"},fn={class:"form-check"},pn=["onUpdate:modelValue","id"],vn=["for"],gn={class:"table-responsive mt-2"},bn={class:"text-end"},yn={class:"table table-sm mb-0 mt-2 border1"},$n={class:"align-middle"},hn={class:"text-center"},wn=["onUpdate:modelValue"],_n=["value"],kn=["onUpdate:modelValue"],Sn=["value"],Tn=["onUpdate:modelValue"],In={class:"text-end"},Mn=["onClick"],xn={__name:"edit",props:{id:{type:String,required:!0},urlView:{type:String,default:"/videos/view"},urlMain:{type:String,default:"/videos"}},setup(r){const{appTitle:b,pageTitle:T,busy:M,infoMessage:k,warningMessage:H,errorMessage:V,router:Q,axios:j,utils:S,toasts:z,close:ae,security:N}=he({appTitle:"Arcadian-FAST",pageTitle:"Edit Video"}),L=r,n=ye({lookups:{genres:[],sourceLocations:[],categories:[{id:1,name:"Ad Break"},{id:2,name:"Filler Slate"},{id:3,name:"Program Content"}],formats:[]},durationTime:"00:00:00",item:{title:null,description:null,rawBaseUrl:null,rawPath:null,hlsBaseUrl:null,hlsPath:null,durationInMillis:null,formats:[]}}),I={item:{title:{title:le.withMessage("title is required.",re),$autoDirty:!0,$lazy:!0},durationInMillis:{title:le.withMessage("durationInMillis is required.",re),$autoDirty:!0,$lazy:!0},dateReleased:{title:le.withMessage("Date Released is required.",re),$autoDirty:!0,$lazy:!0}}},$=Te(I,n),K=xe(()=>{const f=S.moment;if(n.durationTime&&n.durationTime!=="00:00:00"&&S.isValidTime(n.durationTime)){const m=f().startOf("day"),i=m.format("YYYY-MM-DD ")+n.durationTime,l=f(i).subtract(m);return n.item.durationInMillis=l.valueOf(),n.item.durationInMillis}return 0});fe(async()=>{await u(),await p(),await W(),await J()});const J=async()=>{try{await j.get(`/api/v1/videos/${L.id}/`).then(f=>{n.item=f.data;const m=S.moment(n.item.dateReleased).format("YYYY-MM-DD");n.item.dateReleased=m;const i=n.lookups.genres,d=n.item.genres.map(h=>h.genre);i.forEach(h=>{h.selected=d.includes(h.id)});const l=n.lookups.categories,a=n.item.categories.map(h=>h.category);l.forEach(h=>{h.selected=a.includes(h.id)}),n.durationTime=S.moment.utc(n.item.durationInMillis).format("HH:mm:ss")})}catch(f){V.value=S.getErrorMessageAsHtml(f),window.scrollTo(0,0)}finally{}},u=async()=>{try{await j.get("/api/v1/lookups/video-genres/").then(f=>{const i=f.data.filter(d=>d.id!==0);n.lookups.genres=i})}catch(f){V.value=S.getErrorMessageAsHtml(f),window.scrollTo(0,0)}finally{}},p=async()=>{try{await j.get("/api/v1/lookups/video-formats/").then(f=>{const i=f.data.filter(d=>d.id!==0);n.lookups.formats=i})}catch(f){V.value=S.getErrorMessageAsHtml(f),window.scrollTo(0,0)}finally{}},W=async()=>{try{await j.get("/api/v1/sourcelocations/lookup/").then(f=>{n.lookups.sourceLocations=f.data})}catch(f){V.value=S.getErrorMessageAsHtml(f),window.scrollTo(0,0)}finally{}},g=async()=>{const f=n;if(M.value)return;if(!await $.value.$validate()){window.scrollTo(0,0);return}try{M.value=!0,V.value="";const i=S.clone(f.item);i.durationInMillis=K.value;const d=S.moment(f.item.dateReleased).utc(!0).format();i.dateReleased=d;const l=n.lookups.genres.filter(h=>h.selected).map(h=>h.id);i.genres=l;const a=n.lookups.categories.filter(h=>h.selected).map(h=>h.id);i.categories=a;debugger;await j.put("/api/v1/videos/",i).then(h=>{z.success("Edit Video","Video edited.",{onClose:async()=>{const _=`${L.urlView}/${L.id}`;await Q.push(_)}})})}catch(i){V.value=S.getErrorMessageAsHtml(i),window.scrollTo(0,0)}finally{M.value=!1}},G=()=>{const f={format:"HLS",serverUrl:"https://media-tailor-input.s3.us-west-2.amazonaws.com",path:"/sony-poc/vod-1/bbb_2mins.m3u8"};n.item.formats.push(f)},y=f=>{n.item.formats.splice(f,1)};return(f,m)=>{const i=oe("router-link"),d=oe("PageHeader"),l=oe("PageBody");return t(),be($e,null,{default:R(()=>[e("div",null,[F(d,{"page-icon":"fas fa-fw fa-video",pageTitle:o(T)},{default:R(()=>[e("button",{disabled:o($).$dirty&&o($).$invalid,onClick:m[0]||(m[0]=a=>g()),class:"btn btn-primary"},m[6]||(m[6]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Gl),e("button",{onClick:J,class:"btn btn-secondary ms-2"},m[7]||(m[7]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),F(i,{to:`${r.urlView}/${r.id}`,class:"btn btn-secondary ms-2"},{default:R(()=>m[8]||(m[8]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),F(l,{errorMessage:o(V),vuelidate:o($)},{default:R(()=>[e("div",null,[e("div",jl,[e("div",Yl,[e("div",Kl,[q(e("input",{"onUpdate:modelValue":m[1]||(m[1]=a=>n.item.title=a),id:"name",class:te([o(S).getValidFeedbackCss(n.item.title),"form-control"]),placeholder:"Title"},null,2),[[ee,n.item.title]]),m[9]||(m[9]=e("label",{for:"title",class:""},"Title",-1)),o($).item.title.$error?(t(),s("div",Wl,[(t(!0),s(A,null,E(o($).item.title.$errors,a=>(t(),s("div",{key:a.$uid},c(a.$message),1))),128))])):x("",!0)])]),e("div",Ql,[e("div",Jl,[q(e("input",{"onUpdate:modelValue":m[2]||(m[2]=a=>n.item.dateReleased=a),type:"date",step:"1",id:"dateReleased",class:te([o(S).getValidFeedbackCss(n.item.dateReleased),"form-control"])},null,2),[[ee,n.item.dateReleased]]),m[10]||(m[10]=e("label",{for:"dateReleased",class:""},"Duration Time",-1))])]),e("div",Zl,[e("div",Xl,[q(e("input",{"onUpdate:modelValue":m[3]||(m[3]=a=>n.durationTime=a),type:"time",step:"1",id:"durationTime",class:te([o(S).getValidFeedbackCss(n.durationTime),"form-control"])},null,2),[[ee,n.durationTime]]),m[11]||(m[11]=e("label",{for:"durationTime",class:""},"Duration Time",-1))])])]),e("div",en,[e("div",tn,[q(e("textarea",{"onUpdate:modelValue":m[4]||(m[4]=a=>n.item.description=a),id:"name",class:"form-control is-valid",placeholder:"Description",style:{height:"5rem"}},null,512),[[ee,n.item.description]]),m[12]||(m[12]=e("label",{for:"description",class:""},"Description",-1))])]),e("div",sn,[e("div",on,[m[13]||(m[13]=e("b",null,"Genres",-1)),e("div",an,[e("div",ln,[(t(!0),s(A,null,E(n.lookups.genres,a=>(t(),s("div",nn,[e("div",rn,[q(e("input",{"onUpdate:modelValue":h=>a.selected=h,class:"form-check-input",type:"checkbox",id:a.name},null,8,dn),[[qe,a.selected]]),e("label",{class:"form-check-label",for:a.name},c(a.name),9,un)])]))),256))])])]),e("div",cn,[m[14]||(m[14]=e("b",null,"Categories",-1)),e("div",mn,[(t(!0),s(A,null,E(n.lookups.categories,a=>(t(),s("div",fn,[q(e("input",{"onUpdate:modelValue":h=>a.selected=h,class:"form-check-input",type:"checkbox",id:a.name},null,8,pn),[[qe,a.selected]]),e("label",{class:"form-check-label",for:a.name},c(a.name),9,vn)]))),256))])])]),e("div",gn,[e("div",bn,[e("button",{onClick:m[5]||(m[5]=a=>G()),class:"btn btn-outline-primary btn-sm"},m[15]||(m[15]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))]),e("table",yn,[m[17]||(m[17]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Format"),e("th",null,"Server"),e("th",null,"Path"),e("th")])],-1)),e("tbody",null,[(t(!0),s(A,null,E(n.item.formats,(a,h)=>(t(),s("tr",$n,[e("td",hn,c(h+1),1),e("td",null,[q(e("select",{"onUpdate:modelValue":_=>a.format=_,class:"form-control"},[(t(!0),s(A,null,E(n.lookups.formats,_=>(t(),s("option",{value:_.id},c(_.name),9,_n))),256))],8,wn),[[pe,a.format]])]),e("td",null,[q(e("select",{"onUpdate:modelValue":_=>a.serverUrl=_,class:"form-select",id:"serverUrl"},[(t(!0),s(A,null,E(n.lookups.sourceLocations,_=>(t(),s("option",{value:_.baseUrl},c(_.name)+" - ["+c(_.baseUrl)+"] ",9,Sn))),256))],8,kn),[[pe,a.serverUrl]])]),e("td",null,[q(e("input",{"onUpdate:modelValue":_=>a.path=_,type:"text",class:"form-control"},null,8,Tn),[[ee,a.path]])]),e("td",In,[e("button",{onClick:_=>y(h),class:"btn btn-outline-warning btn-sm"},m[16]||(m[16]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,Mn)])]))),256))])])])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},Cn={class:"ms-2"},Vn={class:"input-group"},An=["value"],On={class:"ms-1"},Pn={class:"input-group"},Un={class:"ms-1"},Ln={class:"input-group"},Hn={class:"table-responsive border shadow-sm"},Dn={class:"table table-hover mb-0"},En=["textContent"],qn={class:"d-flex flex-column flex-md-row justify-content-start"},Bn={class:"mt-1"},Nn=["src"],Rn={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},Fn={class:"ms-md-2"},zn={key:0},Gn={class:"badge bg-primary me-1"},jn={key:1},Yn={class:"badge bg-info me-1"},Kn={class:"text-center"},Wn={class:"text-end"},Qn=["onClick"],Jn={key:0,class:"fas fa-fw fa-chevron-circle-up"},Zn={key:1,class:"fas fa-fw fa-chevron-circle-down"},Xn={key:0},er={colspan:"999"},tr={class:""},sr={class:"d-flex flex-column flex-md-row justify-content-start"},or={class:"col mb-2"},ar={class:"col col-lg-auto mx-lg-5 px-lg-5 mb-2"},lr={class:"col col-lg-auto mb-2"},nr={key:0},rr={class:"badge bg-secondary me-1"},ir="/api/v1/videos/search",dr={__name:"index",props:{urlAdd:{type:String,default:"/videos/add"},urlView:{type:String,default:"/videos/view"}},setup(r){Ce("$config");const T=we().user,{appTitle:M,pageTitle:k,busy:H,infoMessage:V,warningMessage:Q,errorMessage:j,router:S,axios:z,utils:ae,toasts:N,close:L,security:n,filter:I,initializeFilter:$,getQuery:K,saveQuery:J,search:u,getRowNumber:p,setSelected:W,isSelected:g}=De({appTitle:"Arcadian-FAST",pageTitle:"Videos",cacheKey:`${T==null?void 0:T.userId}/videos/search`,baseUrl:ir,filter:{updateUrl:!0,lookups:{genres:[]},query:{genre:0,category:0}},initializeFilter:(y,f)=>{const m=y.value,i=new URLSearchParams(window.location.search),d=JSON.parse(localStorage.getItem(f))||{};m.query.genre=i.get("genre")||d.genre||m.query.genre||0,m.query.category=i.get("category")||d.category||m.query.category||0},getQuery:y=>["?c=",encodeURIComponent(y.query.criteria),"&p=",y.pageIndex,"&s=",y.pageSize,"&sf=",y.sortField,"&so=",y.sortOrder,"&genre=",y.query.genre,"&category=",y.query.category].join(""),saveQuery:(y,f)=>{localStorage.setItem(f,JSON.stringify({criteria:y.query.criteria,pageIndex:y.pageIndex,pageSize:y.pageSize,sortField:y.sortField,sortOrder:y.sortOrder,visible:y.visible,genre:y.query.genre,category:y.query.category}))}});fe(async()=>{$(),await G(),await u()});const G=async()=>{try{await z.get("/api/v1/lookups/video-genres/").then(y=>{const f=y.data;I.value.lookups.genres=f})}catch(y){j.value=ae.getErrorMessageAsHtml(y),window.scrollTo(0,0)}finally{}};return(y,f)=>{const m=oe("router-link"),i=oe("PageHeader"),d=oe("m-pagination"),l=oe("PageBody");return t(),be($e,null,{default:R(()=>[e("div",null,[F(i,{"page-icon":"fas fa-fw fa-video",pageTitle:o(k)},{default:R(()=>[F(m,{to:r.urlAdd,class:"btn btn-primary"},{default:R(()=>f[5]||(f[5]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",Cn,[e("div",Vn,[f[6]||(f[6]=e("span",{class:"input-group-text fw-bold"},"Genre",-1)),q(e("select",{"onUpdate:modelValue":f[0]||(f[0]=a=>o(I).query.genre=a),class:"form-select"},[(t(!0),s(A,null,E(o(I).lookups.genres,a=>(t(),s("option",{value:a.id},c(a.name),9,An))),256))],512),[[pe,o(I).query.genre]])])]),e("div",On,[e("div",Pn,[f[8]||(f[8]=e("span",{class:"input-group-text fw-bold"},"Category",-1)),q(e("select",{"onUpdate:modelValue":f[1]||(f[1]=a=>o(I).query.category=a),class:"form-select"},f[7]||(f[7]=[e("option",{value:"0"},"All",-1),e("option",{value:"1"},"Ad Break",-1),e("option",{value:"2"},"Filler Slate",-1),e("option",{value:"3"},"Program Content",-1)]),512),[[pe,o(I).query.category]])])]),e("div",Un,[e("div",Ln,[q(e("input",{"onUpdate:modelValue":f[2]||(f[2]=a=>o(I).query.criteria=a),onKeyup:f[3]||(f[3]=He(a=>o(u)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria...","aria-label":"Enter criteria...","aria-describedby":"button-addon2"},null,544),[[ee,o(I).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:f[4]||(f[4]=a=>o(u)(1))},f[9]||(f[9]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),F(l,{errorMessage:o(j)},{default:R(()=>[e("div",Hn,[e("table",Dn,[f[14]||(f[14]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Title"),e("th",{class:"text-center"},"Duration"),e("th")])],-1)),q(F(Se,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(A,null,E(o(I).items,(a,h)=>(t(),s(A,{key:a.videoId},[e("tr",null,[e("td",{textContent:c(o(p)(h)),class:"text-center"},null,8,En),e("td",null,[e("div",qn,[e("div",null,[a.thumbnails.length>0?(t(!0),s(A,{key:0},E(a.thumbnails,_=>(t(),s("div",Bn,[e("img",{src:_.url,class:"img-fuild border",width:"128"},null,8,Nn)]))),256)):(t(),s("img",Rn))]),e("div",Fn,[F(m,{to:`${r.urlView}/${a.videoId}`,class:"d-inline-block text-wrap link-offset-2"},{default:R(()=>[Y(c(a.title),1)]),_:2},1032,["to"]),e("div",null,[a.categories.length>0?(t(),s("div",zn,[(t(!0),s(A,null,E(a.categories,_=>(t(),s("span",Gn,c(_.categoryName),1))),256))])):x("",!0),a.genres.length>0?(t(),s("div",jn,[(t(!0),s(A,null,E(a.genres,_=>(t(),s("span",Yn,c(_.genreName),1))),256))])):x("",!0)])])])]),e("td",Kn,c(o(ae).moment.utc(a.durationInMillis).format("HH:mm:ss")),1),e("td",Wn,[e("button",{onClick:_=>a.expand=!a.expand,class:te([[a.expand?"btn-primary":"btn-outline-primary"],"btn btn-sm"])},[a.expand?(t(),s("span",Jn)):(t(),s("span",Zn))],10,Qn)])]),a.expand?(t(),s("tr",Xn,[f[13]||(f[13]=e("td",null,null,-1)),e("td",er,[e("div",tr,[e("div",sr,[e("div",or,[f[10]||(f[10]=e("label",{class:"form-label"},"Description",-1)),e("div",null,c(a.description),1)]),e("div",ar,[f[11]||(f[11]=e("label",{class:"form-label"},"Date Released",-1)),e("div",null,c(o(bt).utc(a.dateReleased).format("l")),1)]),e("div",lr,[f[12]||(f[12]=e("label",{class:"form-label"},"Formats",-1)),a.formats.length>0?(t(),s("div",nr,[(t(!0),s(A,null,E(a.formats,_=>(t(),s("span",rr,c(_.formatName),1))),256))])):x("",!0)])])])])])):x("",!0)],64))),128))]),_:1},512),[[ke,o(I).items.length>0]])])]),F(d,{filter:o(I),search:o(u),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},ur={key:0},cr={class:"nav nav-tabs",id:"myTab",role:"tablist"},mr={class:"nav-item",role:"presentation"},fr={class:"nav-item",role:"presentation"},pr={class:"nav-item",role:"presentation"},vr={class:"nav-item",role:"presentation"},gr={class:"tab-content",id:"myTabContent"},br={class:""},yr={class:"row row-cols-1 row-cols-sm-2"},$r={class:"col"},hr=["id"],wr={class:"col"},_r={class:"col"},kr={class:"form-floating mb-2"},Sr={class:"row row-cols-1 row-cols-sm-2"},Tr={class:"col"},Ir={class:"form-floating mb-2"},Mr={class:"col"},xr={class:"form-floating mb-2"},Cr={class:"col"},Vr={class:"form-floating mb-2"},Ar={class:"mt-1"},Or={class:"badge bg-info me-1"},Pr={class:"badge bg-primary me-1"},Ur={class:""},Lr={class:"table-responsive border"},Hr={class:"table table-hover mb-0"},Dr={class:"table-group-divider"},Er={class:"align-middle"},qr={class:"text-center"},Br={class:""},Nr={class:"text-end"},Rr={class:"table-responsive border mt-2"},Fr={class:"table table-hover mb-0 caption-top"},zr={class:""},Gr={class:"table-responsive"},jr={class:"table table-hover mb-0 caption-top"},Yr={__name:"view",props:{id:{type:String,required:!0},urlMain:{type:String,default:"/videos"},urlEdit:{type:String,default:"/videos/edit"},urlAddVodSource:{type:String,default:"/vod-sources/add"},urlViewVodSource:{type:String,default:"/vod-sources/view"}},setup(r){const b=r,{appTitle:T,pageTitle:M,busy:k,isDirty:H,validations:V,infoMessage:Q,warningMessage:j,errorMessage:S,router:z,axios:ae,utils:N,toasts:L,close:n,closeWithReturnUrl:I,generateReturnUrl:$,security:K}=he({appTitle:"Arcadian-FAST",pageTitle:"View Video"});Ce("$config");const J=we();J.user;const u=ye({user:J.user,item:null,hls:null}),p=ge();fe(async()=>{await y(),p.value=N.getPageTab("video")||"information-tab"}),Le(()=>{u.hls&&(u.hls.stopLoad(),u.hls.destroy())});const W=d=>{N.setPageTab("video",d),p.value=d},g=d=>d!==p.value?"":"active",G=d=>d!==p.value?"":"show active",y=async()=>{const d=u;if(!k.value)try{k.value=!0,S.value="",u.item=null;const l=`/api/v1/videos/${b.id}/`;await ae.get(l).then(a=>{d.item=a.data,d.item.duration=N.moment.utc(d.item.durationInMillis).format("HH:mm:ss"),d.item.dateReleased=N.moment.utc(d.item.dateReleased).format("ll")}),m()}catch(l){S.value=N.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{k.value=!1}},f=async()=>{await y()},m=()=>{if(Hls.isSupported()&&console.log("Hello HLS.js!"),Hls.isMSESupported()&&Hls.getMediaSource().isTypeSupported('video/mp4;codecs="av01.0.01M.08"')){console.log("Hello AV1 playback! AVC who?"),u.hls&&u.hls.destroy();const l=`video-${u.item.videoId}`;var d=document.getElementById(l);const a=u.item.formats.find(_=>_.formatName==="HLS");if(!a)return;const h=a.serverUrl+a.path;u.hls=N.createHlsStream(d,h,!1),u.hls.startLoad(-1)}},i=async()=>{if(!k.value)try{k.value=!0,S.value="";const d=`/api/v1/videos/${b.id}/get-blank-frames/`;await ae.post(d).then(l=>{}),k.value=!1,await f()}catch(d){S.value=N.getErrorMessageAsHtml(d),window.scrollTo(0,0)}finally{k.value=!1}};return(d,l)=>{const a=oe("router-link"),h=oe("PageHeader"),_=oe("PageBody");return t(),be($e,null,{default:R(()=>[e("div",null,[F(h,{"page-icon":"fas fa-fw fa-video",pageTitle:o(M)},{default:R(()=>[F(a,{to:`${r.urlEdit}/${r.id}`,class:"btn btn-primary ms-1"},{default:R(()=>l[11]||(l[11]=[e("span",{class:"fas fa-fw fa-edit"},null,-1)])),_:1},8,["to"]),e("button",{onClick:l[0]||(l[0]=v=>f()),class:"ms-2 btn btn-secondary"},l[12]||(l[12]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:l[1]||(l[1]=v=>o(I)(b.urlMain)),class:"btn btn-secondary ms-1"},l[13]||(l[13]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),F(_,{errorMessage:o(S)},{default:R(()=>[u.item?(t(),s("div",ur,[e("div",null,[e("ul",cr,[e("li",mr,[e("button",{onClick:l[2]||(l[2]=v=>W("information-tab")),class:te([g("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"}," Information ",2)]),e("li",fr,[e("button",{onClick:l[3]||(l[3]=v=>W("formats-tab")),class:te([g("formats-tab"),"nav-link"]),id:"formats-tab","data-bs-toggle":"tab","data-bs-target":"#formats",type:"button",role:"tab","aria-controls":"formats","aria-selected":"false"}," Formats ",2)]),e("li",pr,[e("button",{onClick:l[4]||(l[4]=v=>W("blankFrames-tab")),class:te([g("blankFrames-tab"),"nav-link"]),id:"blankFrames-tab","data-bs-toggle":"tab","data-bs-target":"#blankFrames",type:"button",role:"tab","aria-controls":"blankFrames","aria-selected":"false"}," Blank Frames ",2)]),e("li",vr,[e("button",{onClick:l[5]||(l[5]=v=>W("vodSources-tab")),class:te([g("vodSources-tab"),"nav-link"]),id:"vodSources-tab","data-bs-toggle":"tab","data-bs-target":"#vodSources",type:"button",role:"tab","aria-controls":"vodSources","aria-selected":"false"}," VOD Sources ",2)])]),e("div",gr,[e("div",{class:te([G("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",br,[e("div",yr,[e("div",$r,[e("video",{id:`video-${u.item.videoId}`,controls:"",muted:"",class:"card-img-top object-fit-contain border"},null,8,hr)]),e("div",wr,[e("div",_r,[e("div",kr,[q(e("input",{"onUpdate:modelValue":l[6]||(l[6]=v=>u.item.title=v),type:"text",class:"form-control-plaintext card",id:"title",placeholder:"Title"},null,512),[[ee,u.item.title]]),l[14]||(l[14]=e("label",{for:"title"},"Title",-1))])]),e("div",Sr,[e("div",Tr,[e("div",Ir,[q(e("input",{"onUpdate:modelValue":l[7]||(l[7]=v=>u.item.dateReleased=v),type:"text",class:"form-control-plaintext card",id:"dateReleased",placeholder:"Date Released"},null,512),[[ee,u.item.dateReleased]]),l[15]||(l[15]=e("label",{for:"dateReleased"},"Date Released",-1))])]),e("div",Mr,[e("div",xr,[q(e("input",{"onUpdate:modelValue":l[8]||(l[8]=v=>u.item.duration=v),type:"text",class:"form-control-plaintext card",id:"duration",placeholder:"Duration"},null,512),[[ee,u.item.duration]]),l[16]||(l[16]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",Cr,[e("div",Vr,[q(e("textarea",{"onUpdate:modelValue":l[9]||(l[9]=v=>u.item.description=v),type:"text",class:"form-control-plaintext card",id:"description",placeholder:"Description",readonly:"",style:{height:"7rem"}},null,512),[[ee,u.item.description]]),l[17]||(l[17]=e("label",{for:"description"},"Description",-1))])]),e("div",Ar,[(t(!0),s(A,null,E(u.item.genres,v=>(t(),s("span",Or,c(v.genreName),1))),256)),(t(!0),s(A,null,E(u.item.categories,v=>(t(),s("span",Pr,c(v.categoryName),1))),256))])])])])],2),e("div",{class:te([G("formats-tab"),"tab-pane fade"]),id:"formats",role:"tabpanel","aria-labelledby":"formats-tab"},[e("div",Ur,[e("div",Lr,[e("table",Hr,[l[18]||(l[18]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Type"),e("th",null,"Server"),e("th",null,"Path")])],-1)),e("tbody",Dr,[(t(!0),s(A,null,E(u.item.formats,(v,B)=>(t(),s("tr",Er,[e("td",qr,c(B+1),1),e("td",null,c(v.formatName),1),e("td",null,c(v.serverUrl),1),e("td",null,c(v.path),1)]))),256))])])])])],2),e("div",{class:te([G("blankFrames-tab"),"tab-pane fade"]),id:"blankFrames",role:"tabpanel","aria-labelledby":"blankFrames-tab"},[e("div",Br,[e("div",null,[e("div",Nr,[e("button",{onClick:l[10]||(l[10]=v=>i()),class:"btn btn-outline-primary btn-sm"},l[19]||(l[19]=[e("span",{class:"fas fa-fw fa-gear me-1"},null,-1),Y("Process ")]))]),e("div",Rr,[e("table",Fr,[l[20]||(l[20]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Start"),e("th",null,"End"),e("th",null,"Duration")])],-1)),q(F(Se,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(A,null,E(u.item.blankFrames,(v,B)=>(t(),s("tr",{key:v.videoBlankFrameId},[e("td",null,c(B+1),1),e("td",null,c(o(N).moment.utc(v.startInMillis).format("HH:mm:ss")),1),e("td",null,c(o(N).moment.utc(v.endInMillis).format("HH:mm:ss")),1),e("td",null,c(o(N).moment.utc(v.durationInMillis).format("HH:mm:ss")),1)]))),128))]),_:1},512),[[ke,u.item.blankFrames.length>0]])])])])])],2),e("div",{class:te([G("vodSources-tab"),"tab-pane fade"]),id:"vodSources",role:"tabpanel","aria-labelledby":"vodSources-tab"},[e("div",zr,[e("div",Gr,[e("table",jr,[l[21]||(l[21]=e("caption",null,"VOD Sources",-1)),l[22]||(l[22]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Name")])],-1)),q(F(Se,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(A,null,E(u.item.vodSources,(v,B)=>(t(),s("tr",{key:v.vodSourceId},[e("td",null,c(B+1),1),e("td",null,[F(a,{to:`${b.urlViewVodSource}/${encodeURIComponent(v.vodSourceId)}/${o($)()}`,class:"link-offset-2"},{default:R(()=>[Y(c(v.name),1)]),_:2},1032,["to"])])]))),128))]),_:1},512),[[ke,u.item.vodSources.length>0]])])])])],2)])])])):x("",!0)]),_:1},8,["errorMessage"])])]),_:1})}}},Kr=["disabled"],Wr={class:"form-floating mb-2"},Qr={key:0,class:"d-block invalid-feedback"},Jr={__name:"add",props:{urlView:{type:String,default:"/source-groups/view"},urlMain:{type:String,default:"/source-groups"}},setup(r){const{appTitle:b,pageTitle:T,busy:M,infoMessage:k,warningMessage:H,errorMessage:V,router:Q,axios:j,utils:S,toasts:z,close:ae,security:N}=he({appTitle:"Arcadian-FAST",pageTitle:"Add Source Group"}),L=r,n=ye({lookups:{},item:{name:null}}),I={item:{name:{required:le.withMessage("name is required.",re),$autoDirty:!0,$lazy:!0}}},$=Te(I,n);fe(async()=>{});const K=async()=>{const J=n;if(M.value)return;if(!await $.value.$validate()){window.scrollTo(0,0);return}try{M.value=!0,V.value="";const p=S.clone(J.item);await j.post("/api/v1/sourcegroups/",p).then(W=>{z.success("Add Source Group","Source group added.",{onClose:async()=>{const g=`${L.urlView}/${W.data}`;await Q.push(g)}})})}catch(p){V.value=S.getErrorMessageAsHtml(p),window.scrollTo(0,0)}finally{M.value=!1}};return(J,u)=>{const p=oe("router-link"),W=oe("PageHeader"),g=oe("PageBody");return t(),be($e,null,{default:R(()=>[e("div",null,[F(W,{"page-icon":"fas fa-fw fa-warehouse",pageTitle:o(T)},{default:R(()=>[e("button",{disabled:o($).$dirty&&o($).$invalid,onClick:u[0]||(u[0]=G=>K()),class:"btn btn-primary"},u[2]||(u[2]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Kr),F(p,{to:L.urlMain,class:"btn btn-secondary ms-2"},{default:R(()=>u[3]||(u[3]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),F(g,{errorMessage:o(V),vuelidate:o($)},{default:R(()=>[e("div",null,[e("div",Wr,[q(e("input",{"onUpdate:modelValue":u[1]||(u[1]=G=>n.item.name=G),type:"text",class:te([o(S).getValidFeedbackCss(n.item.name),"form-control"]),id:"name",placeholder:"Name"},null,2),[[ee,n.item.name]]),u[4]||(u[4]=e("label",{for:"name"},"Name",-1)),o($).item.name.$error?(t(),s("div",Qr,[(t(!0),s(A,null,E(o($).item.name.$errors,G=>(t(),s("div",{key:G.$uid},c(G.$message),1))),128))])):x("",!0)])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},Zr={key:0,class:"d-flex justify-content-end"},Xr=["disabled"],ei={key:0},ti={class:"row row-cols-1 row-cols-sm-2"},si={class:"col"},oi={class:"form-floating mb-2"},ai={key:0,class:"d-block invalid-feedback"},li={class:"col"},ni={class:"form-floating mb-2"},ri={key:0,class:"d-block invalid-feedback"},ii={class:"row row-cols-sm-2"},di={class:"col"},ui={class:"form-floating mb-2"},ci={class:"form-floating mb-2"},mi={key:0,class:"d-block invalid-feedback"},fi={class:"form-floating mb-2"},pi={key:0,class:"d-block invalid-feedback"},vi={class:"col"},gi={class:"form-floating mb-2"},ct={__name:"edit",props:{id:{type:String,required:!0},urlView:{type:String,required:!0}},setup(r){const{appTitle:b,pageTitle:T,busy:M,infoMessage:k,warningMessage:H,errorMessage:V,router:Q,axios:j,utils:S,toasts:z,close:ae,security:N}=he({appTitle:"ARC CMS",pageTitle:"Edit Movie"}),L=r,n=ye({editorElementId:"editor",htmlContent:"",item:null}),I={item:{title:{required:le.withMessage("Title is required.",re),$autoDirty:!0,$lazy:!0},eidr:{required:le.withMessage("eidr is required.",re),$autoDirty:!0,$lazy:!0},eidrPrefix:{required:le.withMessage("eidrPrefix is required.",re),$autoDirty:!0,$lazy:!0}},htmlContent:{required:le.withMessage("Content is required.",re),$autoDirty:!0,$lazy:!0}},$=Te(I,n);fe(async()=>{await u()});const K=()=>{const W=n;var g=document.getElementById(W.editorElementId);g.innerHTML=W.htmlContent},J=W=>{const g=n;g.htmlContent=W.target.innerHTML;var G=document.getElementById(g.editorElementId);G.value=g.htmlContent},u=async()=>{const W=n;if(!M.value)try{M.value=!0,n.item=null,await j.get(`/api/v1/movies/${L.id}`).then(g=>{W.item=g.data,W.htmlContent=W.item.description}),K()}catch(g){V.value=S.getErrorMessageAsHtml(g)}finally{M.value=!1}},p=async()=>{const W=n;if(M.value)return;if(!await $.value.$validate()){window.scrollTo(0,0);return}try{M.value=!0,V.value="";const G=S.clone(W.item);G.description=W.htmlContent,await j.put("/api/v1/movies",G).then(y=>{z.success("Edit Movie","Movie edited",{onClose:async()=>{const f=`${L.urlView}/${L.id}`;await Q.push(f)}})})}catch(G){V.value=S.getErrorMessageAsHtml(G),window.scrollTo(0,0)}finally{M.value=!1}};return(W,g)=>{const G=oe("router-link"),y=oe("PageHeader"),f=oe("PageBody");return t(),s("div",null,[F(y,{"page-icon":"fas fa-fw fa-film",pageTitle:o(T),"header-break":"row row-cols-2 row-cols-sm-2"},{default:R(()=>[n.item?(t(),s("div",Zr,[e("button",{disabled:o($).$dirty&&o($).$invalid,onClick:g[0]||(g[0]=m=>p()),class:"btn btn-primary"},g[7]||(g[7]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Xr),e("button",{onClick:u,class:"ms-2 btn btn-secondary"},g[8]||(g[8]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),F(G,{to:`${L.urlView}/${L.id}`,class:"ms-1 btn btn-secondary"},{default:R(()=>g[9]||(g[9]=[e("i",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])])):x("",!0)]),_:1},8,["pageTitle"]),F(f,{errorMessage:o(V),vuelidate:o($)},{default:R(()=>[n.item?(t(),s("div",ei,[e("div",ti,[e("div",si,[e("div",oi,[q(e("input",{"onUpdate:modelValue":g[1]||(g[1]=m=>n.item.eidrPrefix=m),type:"text",class:"form-control",id:"eidrPrefix",placeholder:"Eidr Prefix"},null,512),[[ee,n.item.eidrPrefix]]),g[10]||(g[10]=e("label",{for:"title"},"Eidr Prefix",-1)),o($).item.eidrPrefix.$error?(t(),s("div",ai,[(t(!0),s(A,null,E(o($).item.eidrPrefix.$errors,m=>(t(),s("div",{key:m.$uid},c(m.$message),1))),128))])):x("",!0)])]),e("div",li,[e("div",ni,[q(e("input",{"onUpdate:modelValue":g[2]||(g[2]=m=>n.item.eidr=m),type:"text",class:"form-control",id:"eidr",placeholder:"Eidr"},null,512),[[ee,n.item.eidr]]),g[11]||(g[11]=e("label",{for:"title"},"Eidr",-1)),o($).item.eidr.$error?(t(),s("div",ri,[(t(!0),s(A,null,E(o($).item.eidr.$errors,m=>(t(),s("div",{key:m.$uid},c(m.$message),1))),128))])):x("",!0)])])]),e("div",ii,[e("div",di,[e("div",ui,[q(e("input",{"onUpdate:modelValue":g[3]||(g[3]=m=>n.item.releaseYear=m),type:"number",class:"form-control",id:"releaseYear",placeholder:"Release Year"},null,512),[[ee,n.item.releaseYear]]),g[12]||(g[12]=e("label",{for:"title"},"Release Year",-1))])]),e("div",null,[e("div",ci,[q(e("input",{"onUpdate:modelValue":g[4]||(g[4]=m=>n.item.title=m),type:"text",class:"form-control",id:"title",placeholder:"Title"},null,512),[[ee,n.item.title]]),g[13]||(g[13]=e("label",{for:"title"},"Title",-1)),o($).item.title.$error?(t(),s("div",mi,[(t(!0),s(A,null,E(o($).item.title.$errors,m=>(t(),s("div",{key:m.$uid},c(m.$message),1))),128))])):x("",!0)])])]),e("div",null,[e("div",fi,[e("div",{id:"editor",name:"editor",contenteditable:"true",role:"textbox",class:"form-control",spellcheck:"true",style:{"min-height":"100px",height:"auto",overflow:"auto","user-select":"text","white-space":"pre-wrap","word-break":"break-word"},onInput:g[5]||(g[5]=m=>J(m))},null,32),g[14]||(g[14]=e("label",{for:"editor"},"Content",-1)),o($).htmlContent.$error?(t(),s("div",pi,[(t(!0),s(A,null,E(o($).htmlContent.$errors,m=>(t(),s("div",{key:m.$uid},c(m.$message),1))),128))])):x("",!0)])]),e("div",vi,[e("div",gi,[q(e("textarea",{"onUpdate:modelValue":g[6]||(g[6]=m=>n.item.metadata=m),rows:"4",class:"form-control",id:"metadata",placeholder:"Metadata",style:{height:"125px"}},null,512),[[ee,n.item.metadata]]),g[15]||(g[15]=e("label",{for:"title"},"Metadata",-1))])])])):x("",!0)]),_:1},8,["errorMessage","vuelidate"])])}}},bi={components:{Page:ct},props:{id:{type:String,required:!0},urlView:{type:String,default:"/movieAlphas/view"}}};function yi(r,b,T,M,k,H){const V=oe("Page");return t(),be(V,{id:T.id,urlView:T.urlView},null,8,["id","urlView"])}const $i=Oe(bi,[["render",yi]]),hi={class:"ms-2"},wi={class:"input-group"},_i={class:"table-responsive border shadow-sm"},ki={class:"table table-hover mb-0"},Si=["textContent"],Ti={key:0,class:"fas fa-fw fa-check-circle text-success"},Ii={class:"text-center"},Mi={class:"text-center"},xi="/api/v1/sourcegroups/search",Ci={__name:"index",props:{urlAdd:{type:String,default:"/source-groups/add"},urlView:{type:String,default:"/source-groups/view"}},setup(r){Ce("$config");const T=we().user,{appTitle:M,pageTitle:k,busy:H,infoMessage:V,warningMessage:Q,errorMessage:j,router:S,axios:z,utils:ae,toasts:N,close:L,security:n,filter:I,initializeFilter:$,getQuery:K,saveQuery:J,search:u,getRowNumber:p,setSelected:W,isSelected:g}=De({appTitle:"Arcadian-FAST",pageTitle:"Source Groups",cacheKey:`${T==null?void 0:T.userId}/source-groups/search`,baseUrl:xi,filter:{updateUrl:!0}});return fe(async()=>{$(),await u()}),(G,y)=>{const f=oe("router-link"),m=oe("PageHeader"),i=oe("m-pagination"),d=oe("PageBody");return t(),be($e,null,{default:R(()=>[e("div",null,[F(m,{"page-icon":"fas fa-fw fa-warehouse",pageTitle:o(k)},{default:R(()=>[F(f,{to:r.urlAdd,class:"btn btn-primary"},{default:R(()=>y[3]||(y[3]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",hi,[e("div",wi,[q(e("input",{"onUpdate:modelValue":y[0]||(y[0]=l=>o(I).query.criteria=l),onKeyup:y[1]||(y[1]=He(l=>o(u)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria..."},null,544),[[ee,o(I).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:y[2]||(y[2]=l=>o(u)(1))},y[4]||(y[4]=[e("span",{class:"fas fa-fw fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),F(d,{errorMessage:o(j)},{default:R(()=>[e("div",_i,[e("table",ki,[y[5]||(y[5]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Name"),e("th",{class:"text-center"},"# of Channel Outputs"),e("th",{class:"text-center"},"# of Package Configurations")])],-1)),q(F(Se,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(A,null,E(o(I).items,(l,a)=>(t(),s("tr",{key:l.sourceGroupId},[e("td",{textContent:c(o(p)(a)),class:"text-center"},null,8,Si),e("td",null,[F(f,{to:`${r.urlView}/${l.sourceGroupId}`,class:"d-inline-block text-truncate link-offset-2"},{default:R(()=>[l.arn?(t(),s("span",Ti)):x("",!0),Y(" "+c(l.name),1)]),_:2},1032,["to"])]),e("td",Ii,c(l.channelOutputs),1),e("td",Mi,c(l.packageConfigurations),1)]))),128))]),_:1},512),[[ke,o(I).items.length>0]])])]),F(i,{filter:o(I),search:o(u),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},Vi={key:0},Ai={class:"nav nav-tabs",id:"myTab",role:"tablist"},Oi={class:"nav-item",role:"presentation"},Pi={class:"nav-item",role:"presentation"},Ui={class:"nav-item",role:"presentation"},Li={class:"tab-content",id:"myTabContent"},Hi={class:""},Di={class:"form-floating"},Ei={class:""},qi={class:"table-responsive border"},Bi={class:"table table-hover mb-0"},Ni={class:""},Ri={class:"table-responsive border"},Fi={class:"table table-hover mb-0"},zi={__name:"view",props:{id:{type:String,required:!0},urlMain:{type:String,default:"/source-groups"},urlEdit:{type:String,required:!0},urlAddTrailer:{type:String,required:!0},urlViewVodSource:{type:String,default:"/vod-sources/view"},urlViewVideo:{type:String,default:"/videos/view"},urlViewChannel:{type:String,default:"/channels/view"}},setup(r){const b=r,{appTitle:T,pageTitle:M,busy:k,isDirty:H,validations:V,infoMessage:Q,warningMessage:j,errorMessage:S,router:z,axios:ae,utils:N,toasts:L,close:n,closeWithReturnUrl:I,generateReturnUrl:$,security:K}=he({appTitle:"Arcadian-FAST",pageTitle:"View Source Group"});Ce("$config");const J=we();J.user;const u=ye({user:J.user,item:null}),p=ge();fe(async()=>{await y(),p.value=N.getPageTab("sourceGroup")||"information-tab"});const W=i=>{N.setPageTab("sourceGroup",i),p.value=i},g=i=>i!==p.value?"":"active",G=i=>i!==p.value?"":"show active",y=async()=>{const i=u;if(!k.value)try{k.value=!0,S.value="",u.item=null;const d=`/api/v1/sourcegroups/${b.id}/`;await ae.get(d).then(l=>{i.item=l.data})}catch(d){S.value=N.getErrorMessageAsHtml(d),window.scrollTo(0,0)}finally{k.value=!1}},f=async()=>{if(!k.value)try{k.value=!0,S.value="";const i=`/api/v1/sourcegroups/${b.id}/`;await ae.delete(i).then(d=>{L.success("Delete Source Group","Source group was deleted.",{onClose:async()=>{const l=`${b.urlMain}/`;await z.push(l)}})})}catch(i){S.value=N.getErrorMessageAsHtml(i),window.scrollTo(0,0)}finally{k.value=!1}},m=async()=>{await y()};return(i,d)=>{const l=oe("PageHeader"),a=oe("router-link"),h=oe("PageBody");return t(),be($e,null,{default:R(()=>[e("div",null,[F(l,{"page-icon":"fas fa-fw fa-warehouse",pageTitle:o(M)},{default:R(()=>[e("button",{onClick:d[0]||(d[0]=_=>f()),class:"ms-1 btn btn-warning"},d[7]||(d[7]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)])),e("button",{onClick:d[1]||(d[1]=_=>m()),class:"ms-2 btn btn-secondary"},d[8]||(d[8]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:d[2]||(d[2]=_=>o(I)(b.urlMain)),class:"btn btn-secondary ms-1"},d[9]||(d[9]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),F(h,{errorMessage:o(S)},{default:R(()=>[u.item?(t(),s("div",Vi,[e("div",null,[e("ul",Ai,[e("li",Oi,[e("button",{onClick:d[3]||(d[3]=_=>W("information-tab")),class:te([g("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"}," Information ",2)]),e("li",Pi,[e("button",{onClick:d[4]||(d[4]=_=>W("channelOutputs-tab")),class:te([g("channelOutputs-tab"),"nav-link"]),id:"channelOutputs-tab","data-bs-toggle":"tab","data-bs-target":"#channelOutputs",type:"button",role:"tab","aria-controls":"channelOutputs","aria-selected":"false"}," Channel Outputs ",2)]),e("li",Ui,[e("button",{onClick:d[5]||(d[5]=_=>W("packageConfigurations-tab")),class:te([g("packageConfigurations-tab"),"nav-link"]),id:"packageConfigurations-tab","data-bs-toggle":"tab","data-bs-target":"#packageConfigurations",type:"button",role:"tab","aria-controls":"packageConfigurations","aria-selected":"false"}," Package Configurations ",2)])]),e("div",Li,[e("div",{class:te([G("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",Hi,[e("div",Di,[q(e("input",{"onUpdate:modelValue":d[6]||(d[6]=_=>u.item.name=_),type:"text",class:"form-control-plaintext card",id:"name",readonly:""},null,512),[[ee,u.item.name]]),d[10]||(d[10]=e("label",{for:"name"},"Name",-1))])])],2),e("div",{class:te([G("channelOutputs-tab"),"tab-pane fade"]),id:"channelOutputs",role:"tabpanel","aria-labelledby":"channelOutputs-tab"},[e("div",Ei,[e("div",qi,[e("table",Bi,[d[11]||(d[11]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Name"),e("th",null,"Output Type")])],-1)),q(F(Se,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(A,null,E(u.item.channelOutputs,(_,v)=>(t(),s("tr",{key:_.channelOutputId},[e("td",null,c(v+1),1),e("td",null,[F(a,{to:`${r.urlViewChannel}/${_.channelId}/${o($)()}`,class:"link-offset-2"},{default:R(()=>[Y(c(_.manifestName),1)]),_:2},1032,["to"])]),e("td",null,c(_.outputType),1)]))),128))]),_:1},512),[[ke,u.item.channelOutputs.length>0]])])])])],2),e("div",{class:te([G("packageConfigurations-tab"),"tab-pane fade"]),id:"packageConfigurations",role:"tabpanel","aria-labelledby":"packageConfigurations-tab"},[e("div",Ni,[e("div",Ri,[e("table",Fi,[d[12]||(d[12]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"VOD Source"),e("th",null,"Path"),e("th",null,"Type")])],-1)),q(F(Se,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(A,null,E(u.item.packageConfigurations,(_,v)=>(t(),s("tr",{key:_.packageConfigurationId},[e("td",null,c(v+1),1),e("td",null,[F(a,{to:`${r.urlViewVodSource}/${_.vodSourceId}/${o($)()}`,class:"link-offset-2"},{default:R(()=>[Y(c(_.vodSource.name),1)]),_:2},1032,["to"])]),e("td",null,c(_.path),1),e("td",null,c(_.type),1)]))),128))]),_:1},512),[[ke,u.item.packageConfigurations.length>0]])])])])],2)])])])):x("",!0)]),_:1},8,["errorMessage"])])]),_:1})}}},Gi=["disabled"],ji={class:"form-floating mb-2"},Yi={key:0,class:"d-block invalid-feedback"},Ki={class:"form-floating mb-2"},Wi={key:0,class:"d-block invalid-feedback"},Qi={class:"form-floating mb-2"},Ji=["value","disabled"],Zi={class:"form-floating mb-2"},Xi={__name:"add",props:{urlView:{type:String,default:"/source-locations/view"},urlMain:{type:String,default:"/source-locations"}},setup(r){const{appTitle:b,pageTitle:T,busy:M,infoMessage:k,warningMessage:H,errorMessage:V,router:Q,axios:j,utils:S,toasts:z,close:ae,security:N}=he({appTitle:"Arcadian-FAST",pageTitle:"Add Source Location"}),L=r,n=ye({lookups:{accessTypes:[{id:"",name:"NONE",enable:!0},{id:"AUTODETECT_SIGV4",name:"AUTODETECT_SIGV4",enable:!0},{id:"S3_SIGV4",name:"S3_SIGV4",enable:!0},{id:"SECRETS_MANAGER_ACCESS_TOKEN",name:"SECRETS_MANAGER_ACCESS_TOKEN",enable:!1}]},item:{name:null,httpConfigurationBaseUrl:null,defaultSegmentBaseUrl:null,accessType:"S3_SIGV4"}}),I={item:{name:{required:le.withMessage("Name is required.",re),$autoDirty:!0,$lazy:!0},httpConfigurationBaseUrl:{required:le.withMessage("HTTP Configuration Base Url is required.",re),$autoDirty:!0,$lazy:!0}}},$=Te(I,n);fe(async()=>{});const K=async()=>{const J=n;if(M.value)return;if(!await $.value.$validate()){window.scrollTo(0,0);return}try{M.value=!0,V.value="";const p=S.clone(J.item);await j.post("/api/v1/sourcelocations/",p).then(W=>{z.success("Add Source Location","Source location added.",{onClose:async()=>{const g=`${L.urlView}/${W.data}`;await Q.push(g)}})})}catch(p){V.value=S.getErrorMessageAsHtml(p),window.scrollTo(0,0)}finally{M.value=!1}};return(J,u)=>{const p=oe("router-link"),W=oe("PageHeader"),g=oe("PageBody");return t(),be($e,null,{default:R(()=>[e("div",null,[F(W,{"page-icon":"fas fa-fw fa-building",pageTitle:o(T)},{default:R(()=>[e("button",{disabled:o($).$dirty&&o($).$invalid,onClick:u[0]||(u[0]=G=>K()),class:"btn btn-primary"},u[5]||(u[5]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Gi),F(p,{to:L.urlMain,class:"btn btn-secondary ms-2"},{default:R(()=>u[6]||(u[6]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),F(g,{errorMessage:o(V),vuelidate:o($)},{default:R(()=>[e("div",null,[e("div",ji,[q(e("input",{"onUpdate:modelValue":u[1]||(u[1]=G=>n.item.name=G),type:"text",class:te([o(S).getValidFeedbackCss(n.item.name),"form-control"]),id:"name",placeholder:"Name"},null,2),[[ee,n.item.name]]),u[7]||(u[7]=e("label",{for:"name"},"Name",-1)),o($).item.name.$error?(t(),s("div",Yi,[(t(!0),s(A,null,E(o($).item.name.$errors,G=>(t(),s("div",{key:G.$uid},c(G.$message),1))),128))])):x("",!0)]),e("div",Ki,[q(e("textarea",{"onUpdate:modelValue":u[2]||(u[2]=G=>n.item.httpConfigurationBaseUrl=G),type:"text",class:te([o(S).getValidFeedbackCss(n.item.httpConfigurationBaseUrl),"form-control"]),id:"httpConfigurationBaseUrl",placeholder:"HTTP Configuration Base Url",style:{height:"8rem"}},null,2),[[ee,n.item.httpConfigurationBaseUrl]]),u[8]||(u[8]=e("label",{for:"httpConfigurationBaseUrl"},"HTTP Configuration Base Url",-1)),o($).item.httpConfigurationBaseUrl.$error?(t(),s("div",Wi,[(t(!0),s(A,null,E(o($).item.httpConfigurationBaseUrl.$errors,G=>(t(),s("div",{key:G.$uid},c(G.$message),1))),128))])):x("",!0)]),e("div",Qi,[q(e("select",{"onUpdate:modelValue":u[3]||(u[3]=G=>n.item.accessType=G),class:"form-select",id:"accessType"},[(t(!0),s(A,null,E(n.lookups.accessTypes,G=>(t(),s("option",{value:G.id,disabled:!G.enable},c(G.name),9,Ji))),256))],512),[[pe,n.item.accessType]]),u[9]||(u[9]=e("label",{for:"accessType",class:""},"Access Type",-1))]),e("div",Zi,[q(e("textarea",{"onUpdate:modelValue":u[4]||(u[4]=G=>n.item.defaultSegmentBaseUrl=G),type:"text",class:"form-control",id:"defaultSegmentBaseUrl",placeholder:"Default Segment Base Url",style:{height:"8rem"}},null,512),[[ee,n.item.defaultSegmentBaseUrl]]),u[10]||(u[10]=e("label",{for:"defaultSegmentBaseUrl"},"Default Segment Base Url",-1))])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},ed=["disabled"],td={key:0},sd={class:"form-floating mb-2"},od={key:0,class:"d-block invalid-feedback"},ad={class:"form-floating mb-2"},ld={key:0,class:"d-block invalid-feedback"},nd={class:"form-floating mb-2"},rd=["value","disabled"],id={class:"form-floating mb-2"},dd={__name:"edit",props:{id:{type:String,required:!0},urlView:{type:String,default:"/source-locations/view"},urlMain:{type:String,default:"/source-locations"}},setup(r){const{appTitle:b,pageTitle:T,busy:M,infoMessage:k,warningMessage:H,errorMessage:V,router:Q,axios:j,utils:S,toasts:z,close:ae,security:N}=he({appTitle:"Arcadian-FAST",pageTitle:"Edit Source Location"}),L=r,n=ye({lookups:{accessTypes:[{id:"",name:"NONE",enable:!0},{id:"AUTODETECT_SIGV4",name:"AUTODETECT_SIGV4",enable:!0},{id:"S3_SIGV4",name:"S3_SIGV4",enable:!0},{id:"SECRETS_MANAGER_ACCESS_TOKEN",name:"SECRETS_MANAGER_ACCESS_TOKEN",enable:!1}]},item:null}),I={item:{name:{required:le.withMessage("Name is required.",re),$autoDirty:!0,$lazy:!0},httpConfigurationBaseUrl:{required:le.withMessage("HTTP Configuration Base Url is required.",re),$autoDirty:!0,$lazy:!0}}},$=Te(I,n);fe(async()=>{await K()});const K=async()=>{const u=n;if(!M.value)try{M.value=!0,V.value="";const p=S.clone(u.item);await j.get(`/api/v1/sourcelocations/${L.id}`).then(W=>{n.item=W.data})}catch(p){V.value=S.getErrorMessageAsHtml(p),window.scrollTo(0,0)}finally{M.value=!1}},J=async()=>{const u=n;if(M.value)return;if(!await $.value.$validate()){window.scrollTo(0,0);return}try{M.value=!0,V.value="";const W=S.clone(u.item);debugger;await j.put("/api/v1/sourcelocations/",W).then(g=>{z.success("Edit Source Location","Source location edited.",{onClose:async()=>{const G=`${L.urlView}/${L.id}`;await Q.push(G)}})})}catch(W){V.value=S.getErrorMessageAsHtml(W),window.scrollTo(0,0)}finally{M.value=!1}};return(u,p)=>{const W=oe("router-link"),g=oe("PageHeader"),G=oe("PageBody");return t(),be($e,null,{default:R(()=>[e("div",null,[F(g,{"page-icon":"fas fa-fw fa-building",pageTitle:o(T)},{default:R(()=>[e("button",{disabled:o($).$dirty&&o($).$invalid,onClick:p[0]||(p[0]=y=>J()),class:"btn btn-primary"},p[5]||(p[5]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,ed),F(W,{to:L.urlMain,class:"btn btn-secondary ms-2"},{default:R(()=>p[6]||(p[6]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),F(G,{errorMessage:o(V),vuelidate:o($)},{default:R(()=>[n.item?(t(),s("div",td,[e("div",sd,[q(e("input",{"onUpdate:modelValue":p[1]||(p[1]=y=>n.item.name=y),type:"text",class:te([o(S).getValidFeedbackCss(n.item.name),"form-control"]),id:"name",placeholder:"Name"},null,2),[[ee,n.item.name]]),p[7]||(p[7]=e("label",{for:"name"},"Name",-1)),o($).item.name.$error?(t(),s("div",od,[(t(!0),s(A,null,E(o($).item.name.$errors,y=>(t(),s("div",{key:y.$uid},c(y.$message),1))),128))])):x("",!0)]),e("div",ad,[q(e("textarea",{"onUpdate:modelValue":p[2]||(p[2]=y=>n.item.httpConfigurationBaseUrl=y),type:"text",class:te([o(S).getValidFeedbackCss(n.item.httpConfigurationBaseUrl),"form-control"]),id:"httpConfigurationBaseUrl",placeholder:"HTTP Configuration Base Url",style:{height:"8rem"}},null,2),[[ee,n.item.httpConfigurationBaseUrl]]),p[8]||(p[8]=e("label",{for:"httpConfigurationBaseUrl"},"HTTP Configuration Base Url",-1)),o($).item.httpConfigurationBaseUrl.$error?(t(),s("div",ld,[(t(!0),s(A,null,E(o($).item.httpConfigurationBaseUrl.$errors,y=>(t(),s("div",{key:y.$uid},c(y.$message),1))),128))])):x("",!0)]),e("div",nd,[q(e("select",{"onUpdate:modelValue":p[3]||(p[3]=y=>n.item.accessType=y),class:"form-select",id:"accessType"},[(t(!0),s(A,null,E(n.lookups.accessTypes,y=>(t(),s("option",{value:y.id,disabled:!y.enable},c(y.name),9,rd))),256))],512),[[pe,n.item.accessType]]),p[9]||(p[9]=e("label",{for:"accessType",class:""},"Access Type",-1))]),e("div",id,[q(e("textarea",{"onUpdate:modelValue":p[4]||(p[4]=y=>n.item.defaultSegmentBaseUrl=y),type:"text",class:"form-control",id:"defaultSegmentBaseUrl",placeholder:"Default Segment Base Url",style:{height:"8rem"}},null,512),[[ee,n.item.defaultSegmentBaseUrl]]),p[10]||(p[10]=e("label",{for:"defaultSegmentBaseUrl"},"Default Segment Base Url",-1))])])):x("",!0)]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},ud={class:"ms-1"},cd={class:"input-group"},md={class:"table-responsive border shadow-sm"},fd={class:"table table-hover mb-0"},pd={class:"text-center"},vd=["textContent"],gd={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},bd={class:"text-center"},yd=["onUpdate:modelValue"],$d="/api/v1/sourcelocations/search",hd={__name:"index",props:{urlAdd:{type:String,default:"/source-locations/add"},urlView:{type:String,default:"/source-locations/view"}},setup(r){Ce("$config");const T=we().user,{appTitle:M,pageTitle:k,busy:H,infoMessage:V,warningMessage:Q,errorMessage:j,router:S,axios:z,utils:ae,toasts:N,close:L,security:n,filter:I,initializeFilter:$,getQuery:K,saveQuery:J,search:u,getRowNumber:p,setSelected:W,isSelected:g}=De({appTitle:"Arcadian-FAST",pageTitle:"Source Locations",cacheKey:`${T==null?void 0:T.userId}/source-locations/search`,baseUrl:$d,filter:{updateUrl:!0}}),G=xe(()=>{const m=I.value;return m&&m.items?m.items.filter(l=>l.selected):null});fe(async()=>{$(),await u()});const y=async()=>{if(!(G.length<=0||!confirm("The selected Source Location(s) will be submitted to AWS MediaTailer. Are you sure you want to publish the selected Source Location(s)?"))&&!H.value){j.value=null;try{H.value=!0;const d={sourceLocationIds:G.value.map(l=>l.sourceLocationId)};await z.post("/api/v1/sourceLocations/publish/",d).then(l=>{N.success("Publish Source Location(s)","Source Location(s) was published.",{async onClose(){}})}),H.value=!1,await u()}catch(i){j.value=ae.getErrorMessageAsHtml(i),window.scrollTo(0,0)}finally{H.value=!1}}},f=async()=>{if(!(G.length<=0||!confirm("The selected Source Location(s) will be removed frpm AWS MediaTailer. Are you sure you want to unpublish the selected Source Location(s)?"))&&!H.value){j.value=null;try{H.value=!0;const d={sourceLocationIds:G.value.map(l=>l.sourceLocationId)};await z.post("/api/v1/sourceLocations/unpublish/",d).then(l=>{N.success("Unpublish Source Location(s)","Source Location(s) was inpublished.",{async onClose(){}})}),H.value=!1,await u()}catch(i){j.value=ae.getErrorMessageAsHtml(i),window.scrollTo(0,0)}finally{H.value=!1}}};return(m,i)=>{const d=oe("router-link"),l=oe("PageHeader"),a=oe("m-pagination"),h=oe("PageBody");return t(),be($e,null,{default:R(()=>[e("div",null,[F(l,{"page-icon":"fas fa-fw fa-building",pageTitle:o(k)},{default:R(()=>[F(d,{to:r.urlAdd,class:"btn btn-primary ms-2"},{default:R(()=>i[3]||(i[3]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",ud,[e("div",cd,[q(e("input",{"onUpdate:modelValue":i[0]||(i[0]=_=>o(I).query.criteria=_),onKeyup:i[1]||(i[1]=He(_=>o(u)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria...","aria-label":"Enter criteria...","aria-describedby":"button-addon2"},null,544),[[ee,o(I).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:i[2]||(i[2]=_=>o(u)(1))},i[4]||(i[4]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),F(h,{errorMessage:o(j)},{default:R(()=>[e("div",md,[e("table",fd,[e("thead",null,[e("tr",null,[i[7]||(i[7]=e("td",{class:"text-center"},"#",-1)),i[8]||(i[8]=e("th",null,"Name",-1)),i[9]||(i[9]=e("th",null,"HTTP Configuration Base Url",-1)),i[10]||(i[10]=e("th",null,"Default Segment Base Url",-1)),i[11]||(i[11]=e("th",null,"Access Type",-1)),e("td",pd,[G.value.length?(t(),s(A,{key:0},[e("button",{onClick:y,class:"btn btn-primary btn-sm"},i[5]||(i[5]=[e("span",{class:"fas fa-fw fa-link"},null,-1)])),e("button",{onClick:f,class:"btn btn-warning btn-sm ms-1"},i[6]||(i[6]=[e("span",{class:"fas fa-fw fa-unlink"},null,-1)]))],64)):x("",!0)])])]),q(F(Se,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(A,null,E(o(I).items,(_,v)=>(t(),s("tr",{key:_.sourceLocationId},[e("td",{textContent:c(o(p)(v)),class:"text-center"},null,8,vd),e("td",null,[F(d,{to:`${r.urlView}/${_.sourceLocationId}`,class:"d-inline-block text-truncate link-offset-2"},{default:R(()=>[_.arn?(t(),s("i",gd)):x("",!0),e("span",null,c(_.name),1)]),_:2},1032,["to"])]),e("td",null,c(_.httpConfigurationBaseUrl),1),e("td",null,c(_.defaultSegmentBaseUrl),1),e("td",null,c(_.accessType),1),e("td",bd,[q(e("input",{"onUpdate:modelValue":B=>_.selected=B,type:"checkbox",class:"form-check-input"},null,8,yd),[[qe,_.selected]])])]))),128))]),_:1},512),[[ke,o(I).items.length>0]])])]),F(a,{filter:o(I),search:o(u),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},wd={key:0},_d={class:"nav nav-tabs",id:"myTab",role:"tablist"},kd={class:"nav-item",role:"presentation"},Sd={class:"nav-item",role:"presentation"},Td={class:"nav-item",role:"presentation"},Id={class:"tab-content",id:"myTabContent"},Md={class:""},xd={class:"col"},Cd={class:"form-floating"},Vd={class:"row row-cols-1 row-cols-sm-2"},Ad={class:"col"},Od={class:"form-floating mt-2"},Pd={class:"col"},Ud={class:"form-floating mt-2"},Ld={class:"col"},Hd={class:"form-floating mt-2"},Dd={class:""},Ed={class:"table-responsive border"},qd={class:"table table-hover mb-0"},Bd={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},Nd={class:""},Rd={class:"table-responsive border"},Fd={class:"table table-hover mb-0"},zd={key:0,class:"fas fa-fw fa-check-circle text-success"},Gd={class:"badge bg-info"},jd={__name:"view",props:{id:{type:String,required:!0},urlMain:{type:String,default:"/source-locations"},urlEdit:{type:String,default:"/source-locations/edit"},urlAddTrailer:{type:String,required:!0},urlViewVodSource:{type:String,default:"/vod-sources/view"},urlViewVideo:{type:String,default:"/videos/view"},urlViewChannel:{type:String,default:"/channels/view"}},setup(r){const b=r,{appTitle:T,pageTitle:M,busy:k,isDirty:H,validations:V,infoMessage:Q,warningMessage:j,errorMessage:S,router:z,axios:ae,utils:N,toasts:L,close:n,closeWithReturnUrl:I,generateReturnUrl:$,security:K}=he({appTitle:"Arcadian-FAST",pageTitle:"View Source Location"});Ce("$config");const J=we();J.user;const u=ye({user:J.user,item:null}),p=ge();fe(async()=>{await y(),p.value=N.getPageTab("sourceLocation")||"information-tab"});const W=d=>{N.setPageTab("sourceLocation",d),p.value=d},g=d=>d!==p.value?"":"active",G=d=>d!==p.value?"":"show active",y=async()=>{const d=u;if(!k.value)try{k.value=!0,S.value="",u.item=null;const l=`/api/v1/sourcelocations/${b.id}/`;await ae.get(l).then(a=>{d.item=a.data})}catch(l){S.value=N.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{k.value=!1}},f=async()=>{await y()},m=async()=>{if(confirm("Source Location will be submitted to AWS MediaTailer. Are you sure you want to publish the Source Location?")&&!k.value){S.value=null;try{k.value=!0;const l={sourceLocationIds:[b.id]};await ae.post("/api/v1/sourcelocations/publish/",l).then(a=>{L.success("Publish Source Location","Source Location was published.",{async onClose(){}})}),k.value=!1,await f()}catch(l){S.value=N.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{k.value=!1}}},i=async()=>{if(confirm("Source Location will be removed to AWS MediaTailer. Are you sure you want to remove the Source Location?")&&!k.value){S.value=null;try{k.value=!0;const l={sourceLocationIds:[b.id]};await ae.post("/api/v1/sourcelocations/unpublish/",l).then(a=>{L.warning("Remove Source Location","Source Location was removed.",{async onClose(){}})}),k.value=!1,await f()}catch(l){S.value=N.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{k.value=!1}}};return(d,l)=>{const a=oe("router-link"),h=oe("PageHeader"),_=oe("PageBody");return t(),be($e,null,{default:R(()=>[e("div",null,[F(h,{"page-icon":"fas fa-fw fa-building",pageTitle:o(M)},{default:R(()=>[u.item?(t(),s(A,{key:0},[u.item.arn?(t(),s("button",{key:0,onClick:l[0]||(l[0]=v=>i()),class:"ms-1 btn btn-warning"},l[11]||(l[11]=[e("span",{class:"fas fa-fw fa-unlink"},null,-1)]))):(t(),s("button",{key:1,onClick:l[1]||(l[1]=v=>m()),class:"ms-1 btn btn-primary"},l[12]||(l[12]=[e("span",{class:"fas fa-fw fa-link"},null,-1)]))),u.item.arn?x("",!0):(t(),be(a,{key:2,to:`${r.urlEdit}/${r.id}`,class:"ms-1 btn btn-primary"},{default:R(()=>l[13]||(l[13]=[e("span",{class:"fas fa-fw fa-edit"},null,-1)])),_:1},8,["to"]))],64)):x("",!0),e("button",{onClick:l[2]||(l[2]=v=>f()),class:"ms-2 btn btn-secondary"},l[14]||(l[14]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:l[3]||(l[3]=v=>o(I)(b.urlMain)),class:"btn btn-secondary ms-1"},l[15]||(l[15]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),F(_,{errorMessage:o(S)},{default:R(()=>[u.item?(t(),s("div",wd,[e("div",null,[e("ul",_d,[e("li",kd,[e("button",{onClick:l[4]||(l[4]=v=>W("information-tab")),class:te([g("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"}," Information ",2)]),e("li",Sd,[e("button",{onClick:l[5]||(l[5]=v=>W("vodSources-tab")),class:te([g("vodSources-tab"),"nav-link"]),id:"vodSources-tab","data-bs-toggle":"tab","data-bs-target":"#vodSources",type:"button",role:"tab","aria-controls":"vodSources","aria-selected":"false"}," VOD Sources ",2)]),e("li",Td,[e("button",{onClick:l[6]||(l[6]=v=>W("programs-tab")),class:te([g("programs-tab"),"nav-link"]),id:"programs-tab","data-bs-toggle":"tab","data-bs-target":"#programs",type:"button",role:"tab","aria-controls":"programs","aria-selected":"false"}," Programs ",2)])]),e("div",Id,[e("div",{class:te([G("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",Md,[e("div",xd,[e("div",Cd,[q(e("input",{"onUpdate:modelValue":l[7]||(l[7]=v=>u.item.name=v),type:"text",class:"form-control-plaintext card",id:"name",readonly:""},null,512),[[ee,u.item.name]]),l[16]||(l[16]=e("label",{for:"name"},"Name",-1))])]),e("div",Vd,[e("div",Ad,[e("div",Od,[q(e("input",{"onUpdate:modelValue":l[8]||(l[8]=v=>u.item.httpConfigurationBaseUrl=v),type:"text",class:"form-control-plaintext card",id:"httpConfigurationBaseUrl",readonly:""},null,512),[[ee,u.item.httpConfigurationBaseUrl]]),l[17]||(l[17]=e("label",{for:"httpConfigurationBaseUrl"},"HTTP Configuration Base Url",-1))])]),e("div",Pd,[e("div",Ud,[q(e("input",{"onUpdate:modelValue":l[9]||(l[9]=v=>u.item.accessType=v),type:"text",class:"form-control-plaintext card",id:"accessType",readonly:""},null,512),[[ee,u.item.accessType]]),l[18]||(l[18]=e("label",{for:"accessType"},"Access Type",-1))])])]),e("div",Ld,[e("div",Hd,[q(e("input",{"onUpdate:modelValue":l[10]||(l[10]=v=>u.item.defaultSegmentBaseUrl=v),type:"text",class:"form-control-plaintext card",id:"defaultSegmentBaseUrl",readonly:""},null,512),[[ee,u.item.defaultSegmentBaseUrl]]),l[19]||(l[19]=e("label",{for:"defaultSegmentBaseUrl"},"Default Segment Base Url",-1))])])])],2),e("div",{class:te([G("vodSources-tab"),"tab-pane fade"]),id:"vodSources",role:"tabpanel","aria-labelledby":"vodSources-tab"},[e("div",Dd,[e("div",Ed,[e("table",qd,[l[20]||(l[20]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Name"),e("th",null,"Video")])],-1)),q(F(Se,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(A,null,E(u.item.vodSources,(v,B)=>(t(),s("tr",{key:v.vodSourceId},[e("td",null,c(B+1),1),e("td",null,[v.arn?(t(),s("span",Bd)):x("",!0),F(a,{to:`${b.urlViewVodSource}/${encodeURIComponent(v.vodSourceId)}/${o($)()}`,class:"link-offset-2"},{default:R(()=>[Y(c(v.name),1)]),_:2},1032,["to"])]),e("td",null,[F(a,{to:`${b.urlViewVideo}/${encodeURIComponent(v.video.videoId)}/${o($)()}`,class:"link-offset-2"},{default:R(()=>[Y(c(v.video.title),1)]),_:2},1032,["to"]),e("div",null,[e("span",null,c(o(N).moment.utc(v.video.durationInMillis).format("HH:mm:ss")),1)])])]))),128))]),_:1},512),[[ke,u.item.vodSources.length>0]])])])])],2),e("div",{class:te([G("programs-tab"),"tab-pane fade"]),id:"programs",role:"tabpanel","aria-labelledby":"programs-tab"},[e("div",Nd,[e("div",Rd,[e("table",Fd,[l[22]||(l[22]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Channel"),e("th",null,"Name"),e("th",null,"Date Scheduled Start")])],-1)),q(F(Se,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(A,null,E(u.item.programs,(v,B)=>(t(),s("tr",{key:v.programId},[e("td",null,c(B+1),1),e("td",null,[F(a,{to:`${b.urlViewChannel}/${encodeURIComponent(v.channel.channelId)}/${o($)()}`,class:"link-offset-2"},{default:R(()=>[Y(c(v.channel.name),1)]),_:2},1032,["to"])]),e("td",null,[v.arn?(t(),s("span",zd)):x("",!0),Y(" "+c(v.name)+" ",1),e("div",null," Start: "+c(o(N).moment.utc(v.startOffsetMillis).format("HH:mm:ss")),1),e("div",null," End: "+c(o(N).moment.utc(v.endOffsetMillis).format("HH:mm:ss")),1)]),e("td",null,[Y(c(o(N).moment(v.dateScheduledStart).calendar())+" ",1),e("div",null,[e("span",Gd,c(o(N).moment(v.dateScheduledStart).fromNow()),1)])]),l[21]||(l[21]=e("td",null,null,-1))]))),128))]),_:1},512),[[ke,u.item.programs.length>0]])])])])],2)])])])):x("",!0)]),_:1},8,["errorMessage"])])]),_:1})}}},Yd=["id"],Kd={class:"modal-dialog modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},Wd={class:"modal-content"},Qd={class:"modal-header py-2"},Jd={class:"modal-title"},Zd={class:"modal-body p-0"},Xd={class:"row row-cols-1 row-cols-sm-3 g-2 g-md-3"},eu={class:"col"},tu={class:"form-floating mb-2"},su=["value"],ou={class:"col"},au={class:"form-floating mb-2"},lu=["value"],nu={class:"col"},ru={class:"input-group mb-2"},iu={class:"form-floating"},du={class:"row g-2 g-md-3"},uu={class:"col-md-4"},cu={class:"card h-100"},mu={key:0,class:"mt-2"},fu={class:"col"},pu={class:"form-floating mb-2"},vu={class:"col ms-2 my-2"},gu={class:"badge bg-info me-1"},bu={class:"badge bg-primary me-1"},yu={class:"row row-cols-1 row-cols-sm-2"},$u={class:"col"},hu={class:"form-floating mb-2"},wu={class:"form-control-plaintext",id:"dateReleased",placeholder:"Date Released",readonly:""},_u={class:"col"},ku={class:"form-floating mb-2"},Su={class:"form-control-plaintext",id:"duration",placeholder:"Duration",readonly:""},Tu={class:"col"},Iu={class:"form-floating mb-2"},Mu={class:"form-control-plaintext",id:"description",placeholder:"Description"},xu={class:"table-responsive card shadow-sm"},Cu={class:"table table-sm table-hover mb-0 overflow-auto"},Vu=["textContent"],Au={class:"d-flex flex-row justify-content-start"},Ou=["src"],Pu={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},Uu={class:"ms-2"},Lu=["onClick"],Hu={key:0,class:"fas fa-fw fa-check-circle text-primary"},Du={class:"badge text-bg-info"},Eu={class:"modal-footer py-2"},qu=["disabled"],Bu="/api/v1/videos/search",mt={__name:"_selectVideo",props:{sourceLocationId:{type:String,required:!0}},emits:["confirm","cancel"],setup(r,{expose:b,emit:T}){const k=we().user,{appTitle:H,pageTitle:V,busy:Q,infoMessage:j,warningMessage:S,errorMessage:z,router:ae,axios:N,utils:L,toasts:n,security:I,filter:$,initializeFilter:K,getQuery:J,saveQuery:u,search:p,getRowNumber:W,setSelected:g,isSelected:G}=De({appTitle:"Arcadian-FAST",pageTitle:"Select Video",cacheKey:`${k==null?void 0:k.userId}/videos/select`,baseUrl:Bu,filter:{updateUrl:!0,lookups:{genres:[]},query:{genreId:0,categoryId:0,sourceLocationId:null}},initializeFilter:(P,w)=>{const D=P.value,X=new URLSearchParams(window.location.search),U=JSON.parse(localStorage.getItem(w))||{};D.query.genreId=X.get("genre")||U.genreId||D.query.genreId||0,D.query.categoryId=X.get("category")||U.categoryId||D.query.categoryId||0},getQuery:P=>["?c=",encodeURIComponent(P.query.criteria),"&p=",P.pageIndex,"&s=",P.pageSize,"&sf=",P.sortField,"&so=",P.sortOrder,"&genre=",P.query.genreId,"&category=",P.query.categoryId,"&sourceLocationId=",P.query.sourceLocationId].join(""),saveQuery:(P,w)=>{localStorage.setItem(w,JSON.stringify({criteria:P.query.criteria,pageIndex:P.pageIndex,pageSize:P.pageSize,sortField:P.sortField,sortOrder:P.sortOrder,visible:P.visible,genreId:P.query.genreId,category:P.query.categoryId}))},successAction:P=>{P.items.length===1&&v(P.items[0])}}),y=T,f=r,m=ge("modalSelectVideo"),i=ye({video:null,hls:null});fe(async()=>{K(),await d(),await l(),await p(1)}),Le(()=>{i.hls&&(i.hls.stopLoad(),i.hls.destroy())});const d=async()=>{await h(),await _()},l=async()=>{$.value.query.sourceLocationId=f.sourceLocationId,z.value="";var P=document.getElementById(m.value),w=_e.getOrCreateInstance(P);w.show()},a=async P=>{var w=document.getElementById(m.value),D=_e.getOrCreateInstance(w);D.hide(),i.hls&&(i.hls.stopLoad(),i.hls.destroy()),y(P?"confirm":"cancel",P?i.video:null)},h=async P=>{try{const D=await N.get("/api/v1/lookups/video-categories/").then(X=>X.data);$.value.lookups.categories=D}catch(w){z.value=L.getErrorMessageAsHtml(w),window.scrollTo(0,0)}finally{}},_=async P=>{try{const D=await N.get("/api/v1/lookups/video-genres/").then(X=>X.data);$.value.lookups.genres=D}catch(w){z.value=L.getErrorMessageAsHtml(w),window.scrollTo(0,0)}finally{}},v=P=>{i.video=P,B()},B=()=>{if(Hls.isSupported()){i.hls&&(i.hls.stopLoad(),i.hls.destroy());var P=document.getElementById("video-select-preview");const D=i.video.formats.find(U=>U.formatName==="HLS"),X=D.serverUrl+D.path;i.hls=L.createHlsStream(P,X)}};return b({open:l,close:a}),(P,w)=>{const D=oe("m-pagination"),X=oe("PageBody");return t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:m.value,tabindex:"-1","aria-hidden":"true"},[e("div",Kd,[e("div",Wd,[e("div",Qd,[e("h5",Jd,[w[9]||(w[9]=e("span",{class:"fas fa-fw fa-filter me-1"},null,-1)),Y(c(o(V)),1)]),e("button",{type:"button",class:"btn-close",onClick:w[0]||(w[0]=U=>a(!1)),"aria-label":"Close"})]),e("div",Zd,[F(X,{errorMessage:o(z)},{default:R(()=>[e("div",Xd,[e("div",eu,[e("div",tu,[q(e("select",{"onUpdate:modelValue":w[1]||(w[1]=U=>o($).query.categoryId=U),class:"form-select",id:"category"},[(t(!0),s(A,null,E(o($).lookups.categories,U=>(t(),s("option",{value:U.id},c(U.name),9,su))),256))],512),[[pe,o($).query.categoryId]]),w[10]||(w[10]=e("label",{for:"category",class:""},"Category",-1))])]),e("div",ou,[e("div",au,[q(e("select",{"onUpdate:modelValue":w[2]||(w[2]=U=>o($).query.genreId=U),class:"form-select",id:"genre"},[(t(!0),s(A,null,E(o($).lookups.genres,U=>(t(),s("option",{value:U.id},c(U.name),9,lu))),256))],512),[[pe,o($).query.genreId]]),w[11]||(w[11]=e("label",{for:"genre",class:""},"Genre",-1))])]),e("div",nu,[e("div",ru,[e("div",iu,[q(e("input",{"onUpdate:modelValue":w[3]||(w[3]=U=>o($).query.criteria=U),onKeyup:w[4]||(w[4]=He(U=>o(p)(1),["enter"])),id:"criteria",type:"text",class:"form-control"},null,544),[[ee,o($).query.criteria]]),w[12]||(w[12]=e("label",{for:"criteria",class:""},"Criteria",-1))]),e("button",{class:"btn btn-primary",type:"button",onClick:w[5]||(w[5]=U=>o(p)(1))},w[13]||(w[13]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),e("div",du,[q(e("div",uu,[e("div",cu,[w[18]||(w[18]=e("video",{id:"video-select-preview",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain border"},null,-1)),i.video?(t(),s("div",mu,[e("div",fu,[e("div",pu,[q(e("input",{"onUpdate:modelValue":w[6]||(w[6]=U=>i.video.title=U),type:"text",class:"form-control-plaintext",id:"title",placeholder:"Title",readonly:""},null,512),[[ee,i.video.title]]),w[14]||(w[14]=e("label",{for:"title"},"Title",-1))])]),e("div",vu,[e("div",null,[(t(!0),s(A,null,E(i.video.genres,U=>(t(),s("span",gu,c(U.genreName),1))),256)),(t(!0),s(A,null,E(i.video.categories,U=>(t(),s("span",bu,c(U.categoryName),1))),256))])]),e("div",yu,[e("div",$u,[e("div",hu,[e("div",wu,c(o(L).moment(i.video.dateReleased).calendar()),1),w[15]||(w[15]=e("label",{for:"dateReleased"},"Date Released",-1))])]),e("div",_u,[e("div",ku,[e("div",Su,c(o(L).moment.utc(i.video.durationInMillis).format("HH:mm:ss")),1),w[16]||(w[16]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",Tu,[e("div",Iu,[e("div",Mu,c(i.video.description),1),w[17]||(w[17]=e("label",{for:"description"},"Description",-1))])])])):x("",!0)])],512),[[ke,i.video]]),e("div",{class:te([[i.video?"col-md-8":"col-md-12"],""])},[e("div",xu,[e("table",Cu,[w[19]||(w[19]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Title")])],-1)),q(F(Se,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(A,null,E(o($).items,(U,ne)=>(t(),s("tr",{key:U.videoId},[e("td",{textContent:c(o(W)(ne)),class:"text-center"},null,8,Vu),e("td",null,[e("div",Au,[e("div",null,[U.thumbnails.length>0?(t(!0),s(A,{key:0},E(U.thumbnails,(Z,se)=>(t(),s("div",{class:te([se>0?"mt-1":""])},[e("img",{src:Z.url,class:"img-fuild border",width:"128"},null,8,Ou)],2))),256)):(t(),s("img",Pu))]),e("div",Uu,[e("a",{onClick:Z=>v(U),class:"text-wrap link-offset-2",role:"button"},[i.video===U?(t(),s("span",Hu)):x("",!0),Y(c(U.title),1)],8,Lu),e("div",null,[e("span",Du,c(o(L).moment.utc(U.durationInMillis).format("HH:mm:ss")),1)])])])])]))),128))]),_:1},512),[[ke,o($).items.length>0]])])]),F(D,{filter:o($),search:o(p),showPerPage:!0},null,8,["filter","search"])],2)])]),_:1},8,["errorMessage"])]),e("div",Eu,[e("button",{onClick:w[7]||(w[7]=U=>a(!0)),class:"btn btn-primary btn-sm",type:"button",disabled:!i.video},w[20]||(w[20]=[e("span",{class:"fas fa-fw fa-circle-check"},null,-1)]),8,qu),e("button",{onClick:w[8]||(w[8]=U=>a(!1)),class:"btn btn-secondary btn-sm ms-1"},w[21]||(w[21]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])])],8,Yd)}}},Nu=["disabled"],Ru={class:"col"},Fu={class:"form-floating mb-2"},zu={key:0,class:"d-block invalid-feedback"},Gu={class:"row row-cols-1 row-cols-sm-2"},ju={class:"col"},Yu={class:"form-floating mb-2"},Ku=["value"],Wu={key:0,class:"d-block invalid-feedback"},Qu={class:"col"},Ju={class:"input-group mb-2"},Zu={class:"form-floating"},Xu={key:0},ec={class:"d-flex flex-row justify-content-start align-items-center"},tc={key:0,class:"d-inline invalid-feedback"},sc={class:"table-responsive border mt-1"},oc={class:"table table-sm mb-0 caption-top"},ac={class:"align-middle"},lc=["onUpdate:modelValue"],nc=["value"],rc=["onUpdate:modelValue"],ic=["value"],dc=["onClick"],uc={__name:"add",props:{videoId:{type:String},urlView:{type:String,default:"/vod-sources/view"},urlMain:{type:String,default:"/vod-sources"}},setup(r){const{appTitle:b,pageTitle:T,busy:M,infoMessage:k,warningMessage:H,errorMessage:V,router:Q,route:j,axios:S,utils:z,toasts:ae,close:N,closeWithReturnUrl:L,security:n}=he({appTitle:"Arcadian-FAST",pageTitle:"Add VOD Source"}),I=r,$=ye({lookups:{sourceLocations:[],sourceGroups:[]},selected:{sourceLocation:null,video:null},item:{name:null,videoId:null,video:null,sourceLocationId:null,sourceLocation:null,packageConfigurations:[]}}),K=(l,a,h)=>l.length>0,J={item:{name:{required:le.withMessage("Name is required.",re),$autoDirty:!0,$lazy:!0},videoId:{required:le.withMessage("Video is required.",re),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:le.withMessage("Source Locaton is required.",re),$autoDirty:!0,$lazy:!0},packageConfigurations:{packageConfigurationRequired:le.withMessage("PackageConfigurations is required.",K),$each:le.forEach({path:{required:le.withMessage("Path is required.",re)},sourceGroupId:{required:le.withMessage("Source Group is required.",re)}}),$autoDirty:!0,$lazy:!0}}},u=Te(J,$);fe(async()=>{if(await p(),await W(),j.query.videoId)debugger});const p=async()=>{try{await S.get("/api/v1/sourcegroups/lookup/").then(a=>{$.lookups.sourceGroups=a.data})}catch(l){V.value=z.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{}},W=async()=>{try{if(await S.get("/api/v1/sourcelocations/lookup/").then(a=>{$.lookups.sourceLocations=a.data}),$.lookups.sourceLocations.length===1){const a=$.lookups.sourceLocations[0];$.selected.sourceLocation=a,await g()}}catch(l){V.value=z.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{}},g=async()=>{const l=$.selected.sourceLocation;$.item.sourceLocationId=l.id},G=async()=>{$.item.videoId=$.selected.video.videoId,await y($.item.videoId)},y=async l=>{try{const a=`/api/v1/videos/${l}/formats`;await S.get(a).then(h=>{$.selected.video.formats=h.data})}catch(a){V.value=z.getErrorMessageAsHtml(a),window.scrollTo(0,0)}finally{}},f=async()=>{const l=$;if(M.value)return;if(!await u.value.$validate()){window.scrollTo(0,0);return}try{M.value=!0,V.value="";const h=z.clone(l.item),_=l.item.packageConfigurations.filter(v=>v.selectedFormat&&v.sourceGroupId);_.forEach(v=>{const B=v.selectedFormat;v.path=B.path,v.format=B.format,delete v.selectedFormat}),h.packageConfigurations=_,delete h.video,await S.post("/api/v1/vodSources/",h).then(v=>{debugger;ae.success("Add VOD Source","VOD source added",{onClose:async()=>{const B=`${I.urlView}/${v.data}`;await Q.push(B)}})})}catch(h){V.value=z.getErrorMessageAsHtml(h),window.scrollTo(0,0)}finally{M.value=!1}},m=()=>{const l={sourceGroupId:null,selectedFormat:null},a=$.selected.video;if(a){const h=a.formats.find(_=>_.formatName==="HLS");l.path=`${h.serverUrl}${h.path}`}$.item.packageConfigurations.push(l)},i=l=>{$.item.packageConfigurations.splice(l,1)},d=async()=>{const l=Ae(mt,{sourceLocationId:$.selected.sourceLocation.id},{chore:!0,keepInitial:!1}),{data:a,isCanceled:h}=await l.reveal();l.closeAll(),!h&&a&&($.selected.video=a,await G())};return(l,a)=>{const h=oe("PageHeader"),_=oe("PageBody");return t(),be($e,null,{default:R(()=>[e("div",null,[F(h,{"page-icon":"fas fa-fw fa-tag",pageTitle:o(T)},{default:R(()=>[e("button",{disabled:o(u).$dirty&&o(u).$invalid,onClick:a[0]||(a[0]=v=>f()),class:"btn btn-primary"},a[6]||(a[6]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Nu),e("button",{onClick:a[1]||(a[1]=v=>o(L)(I.urlMain)),class:"btn btn-secondary ms-1"},a[7]||(a[7]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),F(_,{errorMessage:o(V),vuelidate:o(u)},{default:R(()=>[e("div",null,[e("div",Ru,[e("div",Fu,[q(e("input",{"onUpdate:modelValue":a[2]||(a[2]=v=>$.item.name=v),id:"name",class:te([o(z).getValidFeedbackCss($.item.name),"form-control"]),placeholder:"Name"},null,2),[[ee,$.item.name]]),a[8]||(a[8]=e("label",{for:"name",class:""},"Name",-1)),o(u).item.name.$error?(t(),s("div",zu,[(t(!0),s(A,null,E(o(u).item.name.$errors,v=>(t(),s("div",{key:v.$uid},c(v.$message),1))),128))])):x("",!0)])]),e("div",Gu,[e("div",ju,[e("div",Yu,[q(e("select",{"onUpdate:modelValue":a[3]||(a[3]=v=>$.selected.sourceLocation=v),onChange:a[4]||(a[4]=v=>g()),class:te([o(z).getValidFeedbackCss($.selected.sourceLocation),"form-select"]),id:"sourceLocationId"},[(t(!0),s(A,null,E($.lookups.sourceLocations,v=>(t(),s("option",{value:v},c(v.name),9,Ku))),256))],34),[[pe,$.selected.sourceLocation]]),a[9]||(a[9]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o(u).item.sourceLocationId.$error?(t(),s("div",Wu,[(t(!0),s(A,null,E(o(u).item.sourceLocationId.$errors,v=>(t(),s("div",{key:v.$uid},c(v.$message),1))),128))])):x("",!0)])]),e("div",Qu,[e("div",Ju,[e("div",Zu,[e("div",{id:"video",class:te([o(z).getValidFeedbackCss($.selected.video),"form-control"]),placeholder:"Title"},[$.selected.video?(t(),s(A,{key:0},[Y(c(o(z).moment.utc($.selected.video.durationInMillis).format("HH:mm:ss"))+" - "+c($.selected.video.title),1)],64)):x("",!0)],2),a[10]||(a[10]=e("label",{for:"video",class:""},"Video",-1))]),$.selected.sourceLocation?(t(),s("button",{key:0,onClick:a[5]||(a[5]=v=>d()),class:"btn btn-primary",type:"button"},a[11]||(a[11]=[e("i",{class:"fa-solid fa-filter"},null,-1)]))):x("",!0)])])]),$.item.videoId?(t(),s("div",Xu,[e("div",ec,[e("fieldset",null,[e("legend",null,[a[13]||(a[13]=Y(" Package Configurations ")),o(u).item.packageConfigurations.$error?(t(),s("span",tc,a[12]||(a[12]=[e("span",{class:"fas fa-fw fa-exclamation-triangle text-warning"},null,-1)]))):x("",!0)])]),e("div",{class:"ms-2"},[e("button",{onClick:m,class:"btn btn-outline-primary btn-sm"},a[14]||(a[14]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))])]),e("div",sc,[e("table",oc,[a[16]||(a[16]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Path"),e("th",null,"Type"),e("th",null,"Source Group"),e("th")])],-1)),e("tbody",ac,[(t(!0),s(A,null,E($.item.packageConfigurations,(v,B)=>(t(),s("tr",null,[e("td",null,c(B+1),1),e("td",null,[q(e("select",{"onUpdate:modelValue":P=>v.selectedFormat=P,class:te([o(z).getValidFeedbackCss(v.selectedFormat),"form-select"]),id:"videoId"},[(t(!0),s(A,null,E($.selected.video.formats,P=>(t(),s("option",{value:P},c(P.path),9,nc))),256))],10,lc),[[pe,v.selectedFormat]]),o(u).item.packageConfigurations.$each.$response?(t(!0),s(A,{key:0},E(o(u).item.packageConfigurations.$each.$response.$errors[B].path,P=>(t(),s("div",{key:P,class:"d-block invalid-feedback"},c(P.$message),1))),128)):x("",!0)]),e("td",null,[v.selectedFormat?(t(),s(A,{key:0},[Y(c(v.selectedFormat.formatName),1)],64)):x("",!0)]),e("td",null,[e("div",null,[q(e("select",{"onUpdate:modelValue":P=>v.sourceGroupId=P,class:te([o(z).getValidFeedbackCss(v.sourceGroupId),"form-select"]),id:"sourceGroupId"},[(t(!0),s(A,null,E($.lookups.sourceGroups,P=>(t(),s("option",{value:P.id},c(P.name),9,ic))),256))],10,rc),[[pe,v.sourceGroupId]]),o(u).item.packageConfigurations.$each.$response?(t(!0),s(A,{key:0},E(o(u).item.packageConfigurations.$each.$response.$errors[B].path,P=>(t(),s("div",{key:P,class:"d-block invalid-feedback"},c(P.$message),1))),128)):x("",!0)])]),e("td",null,[e("button",{onClick:P=>i(B),class:"btn btn-outline-warning btn-sm"},a[15]||(a[15]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,dc)])]))),256))])])])])):x("",!0)])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},cc=["disabled"],mc={key:0},fc={class:"col"},pc={class:"form-floating mb-2"},vc={key:0,class:"d-block invalid-feedback"},gc={class:"row row-cols-1 row-cols-sm-2"},bc={class:"col"},yc={class:"form-floating mb-2"},$c=["value"],hc={key:0,class:"d-block invalid-feedback"},wc={class:"col"},_c={class:"col"},kc=["disabled"],Sc={class:"form-floating"},Tc={id:"video",class:"form-control",placeholder:"Title"},Ic={key:0},Mc={class:"d-flex flex-row justify-content-between mt-3"},xc={key:0,class:"d-inline invalid-feedback"},Cc={class:"table-responsive border mt-1"},Vc={class:"table table-sm mb-0"},Ac={class:"align-middle"},Oc=["onUpdate:modelValue"],Pc=["value"],Uc=["onUpdate:modelValue"],Lc=["value"],Hc={class:"text-end"},Dc=["onClick"],Ec={__name:"edit",props:{id:{type:String,required:!0},urlView:{type:String,default:"/vod-sources/view"},urlMain:{type:String,default:"/vod-sources"}},setup(r){const{appTitle:b,pageTitle:T,busy:M,infoMessage:k,warningMessage:H,errorMessage:V,router:Q,axios:j,utils:S,toasts:z,close:ae,security:N}=he({appTitle:"Arcadian-FAST",pageTitle:"Edit VOD Source"}),L=r,n=ye({lookups:{sourceLocations:[],sourceGroups:[]},selected:{sourceLocation:null,video:null},item:{name:null,videoId:null,video:null,sourceLocationId:null,sourceLocation:null,packageConfigurations:[]}}),I=(l,a,h)=>l.length>0,$={item:{name:{required:le.withMessage("Name is required.",re),$autoDirty:!0,$lazy:!0},videoId:{required:le.withMessage("Video is required.",re),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:le.withMessage("Source Locaton is required.",re),$autoDirty:!0,$lazy:!0},packageConfigurations:{packageConfigurationRequired:le.withMessage("PackageConfigurations is required.",I),$each:le.forEach({path:{required:le.withMessage("Path is required.",re)},sourceGroupId:{required:le.withMessage("Source Group is required.",re)}})}}},K=Te($,n);fe(async()=>{await J(),await W(),await g()});const J=async()=>{await u(),await p()},u=async()=>{const l=n;if(!M.value)try{M.value=!0,V.value="",n.item=null;const a=`/api/v1/vodsources/${L.id}/`;await j.get(a).then(h=>{l.item=h.data;const _=l.item,v=S.moment.utc(l.item.video.durationInMillis).format("HH:mm:ss");_.video.duration=v})}catch(a){V.value=S.getErrorMessageAsHtml(a),window.scrollTo(0,0)}finally{M.value=!1}},p=async()=>{const l=n;if(!M.value)try{M.value=!0,V.value="";const a=`/api/v1/videos/${l.item.videoId}/`;await j.get(a).then(h=>{l.selected.video=h.data})}catch(a){V.value=S.getErrorMessageAsHtml(a),window.scrollTo(0,0)}finally{M.value=!1}},W=async()=>{try{await j.get("/api/v1/sourcegroups/lookup/").then(a=>{n.lookups.sourceGroups=a.data})}catch(l){V.value=S.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{}},g=async()=>{try{if(await j.get("/api/v1/sourcelocations/lookup/").then(a=>{n.lookups.sourceLocations=a.data}),n.lookups.sourceLocations.length>0){const a=n.lookups.sourceLocations.find(h=>h.id===n.item.sourceLocationId);n.selected.sourceLocation=a}}catch(l){V.value=S.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{}},G=async()=>{n.item.videoId=n.selected.video.videoId,n.item.packageConfigurations=[],await y(n.item.videoId)},y=async l=>{try{const a=`/api/v1/videos/${l}/formats`;await j.get(a).then(h=>{n.selected.video.formats=h.data;debugger})}catch(a){V.value=S.getErrorMessageAsHtml(a),window.scrollTo(0,0)}finally{}},f=async()=>{const l=n;if(M.value)return;if(!await K.value.$validate()){window.scrollTo(0,0);return}try{M.value=!0,V.value="";const h=S.clone(l.item);delete h.video,delete h.programs,delete h.sourceLocation,await j.put("/api/v1/vodsources/",h).then(_=>{z.success("Edit VOD Source","VOD source edited.",{onClose:async()=>{const v=`${L.urlView}/${L.id}`;await Q.push(v)}})})}catch(h){V.value=S.getErrorMessageAsHtml(h),window.scrollTo(0,0)}finally{M.value=!1}},m=()=>{debugger;const l={path:"",sourceGroupId:null,type:"HLS"},a=n.selected.video;if(a){const h=a.formats.find(_=>_.formatName==="HLS");l.path=`${h.path}`}n.item.packageConfigurations.push(l)},i=l=>{n.item.packageConfigurations.splice(l,1)},d=async()=>{const l=Ae(mt,{sourceLocationId:n.selected.sourceLocation.id},{chore:!0,keepInitial:!1}),{data:a,isCanceled:h}=await l.reveal();l.close(),!h&&a&&(n.selected.video=a,await G())};return(l,a)=>{const h=oe("router-link"),_=oe("PageHeader"),v=oe("PageBody");return t(),be($e,null,{default:R(()=>[e("div",null,[F(_,{"page-icon":"fas fa-fw fa-tag",pageTitle:o(T)},{default:R(()=>[e("button",{disabled:o(K).$dirty&&o(K).$invalid,onClick:a[0]||(a[0]=B=>f()),class:"btn btn-primary"},a[5]||(a[5]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,cc),e("button",{onClick:a[1]||(a[1]=B=>J()),class:"btn btn-secondary ms-2"},a[6]||(a[6]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),F(h,{to:`${r.urlView}/${r.id}`,class:"btn btn-secondary ms-1"},{default:R(()=>a[7]||(a[7]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),F(v,{errorMessage:o(V),vuelidate:o(K)},{default:R(()=>[n.item?(t(),s("div",mc,[e("div",fc,[e("div",pc,[q(e("input",{"onUpdate:modelValue":a[2]||(a[2]=B=>n.item.name=B),id:"name",class:"form-control",placeholder:"Name"},null,512),[[ee,n.item.name]]),a[8]||(a[8]=e("label",{for:"name",class:""},"Name",-1)),o(K).item.name.$error?(t(),s("div",vc,[(t(!0),s(A,null,E(o(K).item.name.$errors,B=>(t(),s("div",{key:B.$uid},c(B.$message),1))),128))])):x("",!0)])]),e("div",gc,[e("div",bc,[e("div",yc,[q(e("select",{"onUpdate:modelValue":a[3]||(a[3]=B=>n.selected.sourceLocation=B),class:"form-select",id:"sourceLocationId"},[(t(!0),s(A,null,E(n.lookups.sourceLocations,B=>(t(),s("option",{value:B},c(B.name),9,$c))),256))],512),[[pe,n.selected.sourceLocation]]),a[9]||(a[9]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o(K).item.sourceLocationId.$error?(t(),s("div",hc,[(t(!0),s(A,null,E(o(K).item.sourceLocationId.$errors,B=>(t(),s("div",{key:B.$uid},c(B.$message),1))),128))])):x("",!0)])]),e("div",wc,[e("div",_c,[e("div",{class:"input-group mb-2",disabled:n.item.packageConfigurations.length>0},[e("div",Sc,[e("div",Tc,[n.selected.video?(t(),s(A,{key:0},[Y(c(n.selected.video.title),1)],64)):x("",!0)]),a[10]||(a[10]=e("label",{for:"video",class:""},"Video",-1))]),e("button",{onClick:a[4]||(a[4]=B=>d()),class:"btn btn-primary",type:"button"},a[11]||(a[11]=[e("i",{class:"fa-solid fa-filter"},null,-1)]))],8,kc)])])]),n.item.videoId?(t(),s("div",Ic,[e("div",Mc,[e("div",null,[e("h5",null,[a[13]||(a[13]=Y(" Package Configurations ")),o(K).item.packageConfigurations.$error?(t(),s("span",xc,a[12]||(a[12]=[e("span",{class:"fas fa-fw fa-exclamation-triangle text-warning"},null,-1)]))):x("",!0)])]),e("button",{onClick:m,class:"btn btn-outline-primary btn-sm"},a[14]||(a[14]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))]),e("div",Cc,[e("table",Vc,[a[16]||(a[16]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Path"),e("th",null,"Source Group"),e("th",null,"Type"),e("th")])],-1)),e("tbody",Ac,[(t(!0),s(A,null,E(n.item.packageConfigurations,(B,P)=>(t(),s("tr",null,[e("td",null,c(P+1),1),e("td",null,[q(e("select",{"onUpdate:modelValue":w=>B.selectedFormat=w,class:te([o(S).getValidFeedbackCss(B.selectedFormat),"form-select"]),id:"videoId"},[(t(!0),s(A,null,E(n.selected.video.formats,w=>(t(),s("option",{value:w},c(w.path),9,Pc))),256))],10,Oc),[[pe,B.selectedFormat]]),o(K).item.packageConfigurations.$each.$response?(t(!0),s(A,{key:0},E(o(K).item.packageConfigurations.$each.$response.$errors[P].path,w=>(t(),s("div",{key:w,class:"d-block invalid-feedback"},c(w.$message),1))),128)):x("",!0)]),e("td",null,[e("div",null,[q(e("select",{"onUpdate:modelValue":w=>B.sourceGroupId=w,class:"form-select",id:"sourceGroupId"},[(t(!0),s(A,null,E(n.lookups.sourceGroups,w=>(t(),s("option",{value:w.id},c(w.name),9,Lc))),256))],8,Uc),[[pe,B.sourceGroupId]]),o(K).item.packageConfigurations.$each.$response?(t(!0),s(A,{key:0},E(o(K).item.packageConfigurations.$each.$response.$errors[P].path,w=>(t(),s("div",{key:w,class:"d-block invalid-feedback"},c(w.$message),1))),128)):x("",!0)])]),e("td",null,[B.selectedFormat?(t(),s(A,{key:0},[Y(c(B.selectedFormat.formatName),1)],64)):x("",!0)]),e("td",Hc,[e("button",{onClick:w=>i(P),class:"btn btn-outline-warning btn-sm"},a[15]||(a[15]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,Dc)])]))),256))])])])])):x("",!0)])):x("",!0)]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},qc={class:"ms-2"},Bc={class:"input-group"},Nc=["value"],Rc={class:"ms-1"},Fc={class:"input-group"},zc=["value"],Gc={class:"ms-1"},jc={class:"input-group"},Yc={class:"ms-1"},Kc={class:"input-group"},Wc={class:"table-responsive border shadow-sm"},Qc={class:"table table-hover mb-0"},Jc={class:"text-center"},Zc=["textContent"],Xc={class:"d-flex flex-column flex-md-row justify-content-start"},em={class:""},tm=["src"],sm={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},om={class:"ms-md-2"},am={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},lm={class:"badge bg-primary me-1"},nm={key:0},rm={class:"badge bg-info me-1"},im={class:"d-flex flex-row justify-content-start"},dm={class:"ms-2"},um={class:"small"},cm={class:"badge bg-secondary me-1"},mm={class:"text-center"},fm=["onUpdate:modelValue"],pm="/api/v1/vodsources/search",vm={__name:"index",props:{urlAdd:{type:String,default:"/vod-sources/add"},urlView:{type:String,default:"/vod-sources/view"},urlViewVideo:{type:String,default:"/videos/view"}},setup(r){Ce("$config");const T=we().user,{appTitle:M,pageTitle:k,busy:H,infoMessage:V,warningMessage:Q,errorMessage:j,router:S,axios:z,utils:ae,toasts:N,close:L,closeWithReturnUrl:n,generateReturnUrl:I,security:$,filter:K,initializeFilter:J,getQuery:u,saveQuery:p,search:W,getRowNumber:g,setSelected:G,isSelected:y}=De({appTitle:"Arcadian-FAST",pageTitle:"VOD Sources",cacheKey:`${T==null?void 0:T.userId}/vod-sources/search`,baseUrl:pm,filter:{updateUrl:!0,lookups:{sourceLocations:[],genres:[]},query:{type:0,sourceLocationId:""}},initializeFilter:(h,_)=>{const v=h.value,B=new URLSearchParams(window.location.search),P=JSON.parse(localStorage.getItem(_))||{};v.query.category=B.get("category")||P.category||v.query.category||0,v.query.genre=B.get("genre")||P.genre||v.query.genre||0,v.query.sourceLocationId=B.get("slid")||P.sourceLocationId||v.query.sourceLocationId||""},getQuery:h=>["?c=",encodeURIComponent(h.query.criteria),"&p=",h.pageIndex,"&s=",h.pageSize,"&sf=",h.sortField,"&so=",h.sortOrder,"&category=",h.query.category,"&genre=",h.query.genre,"&slid=",h.query.sourceLocationId].join(""),saveQuery:(h,_)=>{localStorage.setItem(_,JSON.stringify({criteria:h.query.criteria,pageIndex:h.pageIndex,pageSize:h.pageSize,sortField:h.sortField,sortOrder:h.sortOrder,visible:h.visible,category:h.query.category,genre:h.query.genre,sourceLocationId:h.query.sourceLocationId}))}}),f=xe(()=>{const h=K.value;return h&&h.items?h.items.filter(B=>B.selected):[]});fe(async()=>{J(),await l(),await a(),await W()});const m=async()=>{if(!(f.length<=0||!confirm("The selected VODs will be submitted to AWS MediaTailer. Are you sure you want to publish the selected VODs?"))&&!H.value){j.value=null;try{H.value=!0;const v={vodSourceIds:f.value.map(B=>B.vodSourceId)};await z.post("/api/v1/vodsources/publish/",v).then(B=>{N.success("Publish VODs","VODs was published.",{async onClose(){}})}),H.value=!1,await W()}catch(_){j.value=ae.getErrorMessageAsHtml(_),window.scrollTo(0,0)}finally{H.value=!1}}},i=async()=>{if(!(f.length<=0||!confirm("The selected VODs will be removed frpm AWS MediaTailer. Are you sure you want to unpublish the selected VODs?"))&&!H.value){j.value=null;try{H.value=!0;const v={vodSourceIds:f.value.map(B=>B.vodSourceId)};await z.post("/api/v1/vodsources/unpublish/",v).then(B=>{N.success("Unpublish VODs","VODs was inpublished.",{async onClose(){}})}),H.value=!1,await W()}catch(_){j.value=ae.getErrorMessageAsHtml(_),window.scrollTo(0,0)}finally{H.value=!1}}},d=()=>{const h=K.value.items;if(h.length<1)return;const _=!h[0].selected;K.value.items.forEach(v=>{v.selected=_})},l=async()=>{try{await z.get("/api/v1/sourcelocations/lookup/").then(_=>{K.value.lookups.sourceLocations=_.data})}catch(h){j.value=ae.getErrorMessageAsHtml(h),window.scrollTo(0,0)}finally{}},a=async()=>{try{await z.get("/api/v1/lookups/video-genres/").then(h=>{const _=h.data;K.value.lookups.genres=_})}catch(h){j.value=ae.getErrorMessageAsHtml(h),window.scrollTo(0,0)}finally{}};return ge(!1),(h,_)=>{const v=oe("router-link"),B=oe("PageHeader"),P=oe("m-pagination"),w=oe("PageBody");return t(),be($e,null,{default:R(()=>[e("div",null,[F(B,{"page-icon":"fas fa-fw fa-tags",pageTitle:o(k)},{default:R(()=>[F(v,{to:r.urlAdd,class:"btn btn-primary"},{default:R(()=>_[6]||(_[6]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",qc,[e("div",Bc,[_[8]||(_[8]=e("span",{class:"input-group-text fw-bold"},"Source",-1)),q(e("select",{"onUpdate:modelValue":_[0]||(_[0]=D=>o(K).query.sourceLocationId=D),class:"form-select"},[_[7]||(_[7]=e("option",{value:""},"All",-1)),(t(!0),s(A,null,E(o(K).lookups.sourceLocations,D=>(t(),s("option",{value:D.id},c(D.name),9,Nc))),256))],512),[[pe,o(K).query.sourceLocationId]])])]),e("div",Rc,[e("div",Fc,[_[9]||(_[9]=e("span",{class:"input-group-text fw-bold"},"Genre",-1)),q(e("select",{"onUpdate:modelValue":_[1]||(_[1]=D=>o(K).query.genre=D),class:"form-select"},[(t(!0),s(A,null,E(o(K).lookups.genres,D=>(t(),s("option",{value:D.id},c(D.name),9,zc))),256))],512),[[pe,o(K).query.genre]])])]),e("div",Gc,[e("div",jc,[_[11]||(_[11]=e("span",{class:"input-group-text fw-bold"},"Category",-1)),q(e("select",{"onUpdate:modelValue":_[2]||(_[2]=D=>o(K).query.category=D),class:"form-select"},_[10]||(_[10]=[e("option",{value:"0"},"All",-1),e("option",{value:"1"},"Ad Break",-1),e("option",{value:"2"},"Filler Slate",-1),e("option",{value:"3"},"Program Content",-1)]),512),[[pe,o(K).query.category]])])]),e("div",Yc,[e("div",Kc,[q(e("input",{"onUpdate:modelValue":_[3]||(_[3]=D=>o(K).query.criteria=D),onKeyup:_[4]||(_[4]=He(D=>o(W)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria...","aria-label":"Enter criteria...","aria-describedby":"button-addon2"},null,544),[[ee,o(K).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:_[5]||(_[5]=D=>o(W)(1))},_[12]||(_[12]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),F(w,{errorMessage:o(j)},{default:R(()=>[e("div",Wc,[e("table",Qc,[e("thead",null,[e("tr",null,[_[16]||(_[16]=e("td",{class:"text-center"},"#",-1)),_[17]||(_[17]=e("th",null,"Name",-1)),_[18]||(_[18]=e("th",null,"Video Title",-1)),e("th",Jc,[f.value.length?(t(),s(A,{key:0},[e("button",{onClick:m,class:"btn btn-sm btn-primary"},_[13]||(_[13]=[e("span",{class:"fas fa-fw fa-link"},null,-1)])),e("button",{onClick:i,class:"btn btn-sm btn-warning ms-1"},_[14]||(_[14]=[e("span",{class:"fas fa-fw fa-unlink"},null,-1)]))],64)):x("",!0),e("button",{onClick:d,class:"btn btn-sm btn-outline-primary ms-2"},_[15]||(_[15]=[e("span",{class:"fas fa-fw fa-check-double"},null,-1)]))])])]),q(F(Se,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(A,null,E(o(K).items,(D,X)=>(t(),s("tr",{key:D.vodSourceId},[e("td",{textContent:c(o(g)(X)),class:"text-center"},null,8,Zc),e("td",null,[e("div",Xc,[e("div",null,[D.video.thumbnails.length>0?(t(!0),s(A,{key:0},E(D.video.thumbnails,U=>(t(),s("div",em,[e("img",{src:U.url,class:"img-fuild border",width:"128"},null,8,tm)]))),256)):(t(),s("img",sm))]),e("div",om,[F(v,{to:`${r.urlView}/${D.vodSourceId}`,class:"d-inline-block text-wrap link-offset-2"},{default:R(()=>[D.arn?(t(),s("span",am)):x("",!0),Y(c(D.name),1)]),_:2},1032,["to"]),e("div",null,[(t(!0),s(A,null,E(D.video.categories,U=>(t(),s("div",null,[e("span",lm,c(U.categoryName),1)]))),256)),D.video.genres.length>0?(t(),s("div",nm,[(t(!0),s(A,null,E(D.video.genres,U=>(t(),s("span",rm,c(U.genreName),1))),256))])):x("",!0)])])])]),e("td",null,[e("div",im,[e("div",dm,[F(v,{to:`${r.urlViewVideo}/${encodeURIComponent(D.video.videoId)}/${o(I)()}`,class:"link-offset-2"},{default:R(()=>[Y(c(D.video.title),1)]),_:2},1032,["to"]),e("div",null,[e("span",um,c(o(ae).moment.utc(D.video.durationInMillis).format("HH:mm:ss")),1)]),D.video.formats.length>0?(t(!0),s(A,{key:0},E(D.video.formats,U=>(t(),s("span",cm,c(U.formatName),1))),256)):x("",!0)])])]),e("td",mm,[q(e("input",{"onUpdate:modelValue":U=>D.selected=U,type:"checkbox",class:"form-check-input"},null,8,fm),[[qe,D.selected]])])]))),128))]),_:1},512),[[ke,o(K).items.length>0]])])]),F(P,{filter:o(K),search:o(W),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},gm=["id"],bm={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},ym={class:"modal-content"},$m={class:"modal-header"},hm={class:"modal-title"},wm={class:"modal-body"},_m={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},km=["innerHTML"],Sm={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},Tm={class:"container"},Im={class:"col"},Mm={class:"form-floating mb-2"},xm=["value"],Cm={key:0,class:"d-block invalid-feedback"},Vm={class:"col"},Am={class:"form-floating mb-2"},Om={key:0,class:"d-block invalid-feedback"},Pm={class:"col"},Um={class:"form-floating mb-2"},Lm=["value"],Hm={key:0,class:"d-block invalid-feedback"},Dm={class:"modal-footer"},Em=["disabled"],qm={__name:"_addPackageConfiguration",emits:["refresh"],setup(r,{expose:b,emit:T}){const{appTitle:M,pageTitle:k,busy:H,isDirty:V,validations:Q,infoMessage:j,warningMessage:S,errorMessage:z,router:ae,axios:N,utils:L,toasts:n,closeWithReturnUrl:I,security:$}=he({appTitle:"Arcadian-FAST",pageTitle:"Add VOD Source Package Configuration"}),K=T;ge();const J=ge("modalAddChannelOutput"),u=ye({lookups:{sourceGroups:[],formats:[]},item:{sourceGroupId:null,vodSourceId:null,path:null,type:null}}),p={item:{sourceGroupId:{required:le.withMessage("Source Group is required.",re),$autoDirty:!0,$lazy:!0},vodSourceId:{required:le.withMessage("VOD Source is required.",re),$autoDirty:!0,$lazy:!0},path:{required:le.withMessage("Path is required.",re),$autoDirty:!0,$lazy:!0},type:{required:le.withMessage("Type is required.",re),$autoDirty:!0,$lazy:!0}}},W=Te(p,u);fe(async()=>{W.value.$reset()});const g=async()=>{await G()},G=async()=>{try{await N.get("/api/v1/sourceGroups/lookup/").then(l=>{u.lookups.sourceGroups=l.data,u.lookups.sourceGroups.length===1&&(u.item.sourceGroupId=u.lookups.sourceGroups[0].id)})}catch(d){z.value=L.getErrorMessageAsHtml(d),window.scrollTo(0,0)}finally{}},y=async d=>{try{const l=`/api/v1/videos/${d}/formats/`;await N.get(l).then(a=>{u.lookups.formats=a.data})}catch(l){z.value=L.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{}},f=async(d,l)=>{const a=u;Q.value.clear(),z.value="",a.lookups={sourceGroups:[],formats:[]},a.item={sourceGroupId:null,vodSourceId:d,path:null,type:null},await g(),await y(l),W.value.$reset();var h=document.getElementById(J.value),_=_e.getOrCreateInstance(h);_.show()},m=async()=>{var d=document.getElementById(J.value),l=_e.getOrCreateInstance(d);l.hide(),K("refresh")},i=async()=>{const d=u;if(H.value)return;const l=await W.value.$validate();debugger;if(!l){window.scrollTo(0,0);return}try{H.value=!0,z.value="";const a=d.item;await N.post("/api/v1/vodSources/package-configurations/",a).then(h=>{n.success("Add VOD Source Package Configuration","VOD Source package configuration added.")}),await m()}catch(a){z.value=L.getErrorMessageAsHtml(a),window.scrollTo(0,0)}finally{H.value=!1}};return b({open:f,close:m}),(d,l)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:J.value,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",bm,[e("div",ym,[e("div",$m,[e("h5",hm,[l[5]||(l[5]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Y(c(o(k)),1)]),e("button",{type:"button",class:"btn-close",onClick:l[0]||(l[0]=a=>m()),"aria-label":"Close"})]),e("div",wm,[o(z)?(t(),s("div",_m,[l[6]||(l[6]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Y("Error ")],-1)),e("div",{innerHTML:o(z)},null,8,km)])):x("",!0),o(Q).size>0?(t(),s("div",Sm,[l[7]||(l[7]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Y("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(A,null,E(o(Q).values(),a=>(t(),s("li",null,c(a),1))),256))])])):x("",!0),e("div",Tm,[e("div",Im,[e("div",Mm,[q(e("select",{"onUpdate:modelValue":l[1]||(l[1]=a=>u.item.sourceGroupId=a),class:te([o(L).getValidFeedbackCss(u.item.sourceGroupId),"form-select"]),id:"sourceGroupId"},[(t(!0),s(A,null,E(u.lookups.sourceGroups,a=>(t(),s("option",{value:a.id},c(a.name),9,xm))),256))],2),[[pe,u.item.sourceGroupId]]),l[8]||(l[8]=e("label",{for:"sourceGroupId",class:""},"Source Group",-1)),o(W).item.sourceGroupId.$error?(t(),s("div",Cm,[(t(!0),s(A,null,E(o(W).item.sourceGroupId.$errors,a=>(t(),s("div",{key:a.$uid},c(a.$message),1))),128))])):x("",!0)])]),e("div",Vm,[e("div",Am,[q(e("select",{"onUpdate:modelValue":l[2]||(l[2]=a=>u.item.type=a),class:te([o(L).getValidFeedbackCss(u.item.type),"form-select"]),id:"type"},l[9]||(l[9]=[e("option",{value:"HLS",selected:""},"HLS",-1),e("option",{value:"DASH"},"DASH",-1)]),2),[[pe,u.item.type]]),l[10]||(l[10]=e("label",{for:"type",class:""},"Type",-1)),o(W).item.type.$error?(t(),s("div",Om,[(t(!0),s(A,null,E(o(W).item.type.$errors,a=>(t(),s("div",{key:a.$uid},c(a.$message),1))),128))])):x("",!0)])]),e("div",Pm,[e("div",Um,[q(e("select",{"onUpdate:modelValue":l[3]||(l[3]=a=>u.item.path=a),class:te([o(L).getValidFeedbackCss(u.item.path),"form-control"]),id:"path"},[(t(!0),s(A,null,E(u.lookups.formats,a=>(t(),s("option",{value:a.path},c(a.path),9,Lm))),256))],2),[[pe,u.item.path]]),l[11]||(l[11]=e("label",{for:"path",class:""},"Path",-1)),o(W).item.path.$error?(t(),s("div",Hm,[(t(!0),s(A,null,E(o(W).item.path.$errors,a=>(t(),s("div",{key:a.$uid},c(a.$message),1))),128))])):x("",!0)])])])]),e("div",Dm,[e("button",{disabled:o(W).$dirty&&o(W).$invalid,onClick:l[4]||(l[4]=a=>i()),class:"btn btn-primary",type:"button"},l[12]||(l[12]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Em),l[13]||(l[13]=e("button",{"data-bs-dismiss":"modal",class:"btn btn-secondary ms-1"},[e("span",{class:"fas fa-fw fa-times"})],-1))])])])],8,gm))}},Bm=["id"],Nm={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},Rm={class:"modal-content"},Fm={class:"modal-header"},zm={class:"modal-title"},Gm={class:"modal-body"},jm={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},Ym=["innerHTML"],Km={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},Wm={class:"container"},Qm={class:"col"},Jm={class:"form-floating mb-2"},Zm={class:"col"},Xm={class:"form-floating mb-2"},ef={key:0,class:"d-block invalid-feedback"},tf={class:"col"},sf={class:"form-floating mb-2"},of={key:0,class:"d-block invalid-feedback"},af={class:"col"},lf={class:"form-floating mb-2"},nf={key:0,class:"d-block invalid-feedback"},rf={class:"modal-footer"},df=["disabled"],uf={__name:"_addPlaybackConfiguration",emits:["refresh"],setup(r,{expose:b,emit:T}){const{appTitle:M,pageTitle:k,busy:H,isDirty:V,validations:Q,infoMessage:j,warningMessage:S,errorMessage:z,router:ae,axios:N,utils:L,toasts:n,closeWithReturnUrl:I,security:$}=he({appTitle:"Arcadian-FAST",pageTitle:"Add Vod Source Playback Configuration"}),K=T,J=ge(),u=ge("modalAddPlaybackConfiguration"),p=ye({lookups:{},item:{name:null,adDecisionServerUrl:null,videoContentSourceUrl:null}}),W={item:{name:{required:le.withMessage("Name is required.",re),$autoDirty:!0,$lazy:!0},adDecisionServerUrl:{required:le.withMessage("adDecisionServerUrl is required.",re),$autoDirty:!0,$lazy:!0},videoContentSourceUrl:{required:le.withMessage("videoContentSourceUrl is required.",re),$autoDirty:!0,$lazy:!0}}},g=Te(W,p);fe(async()=>{g.value.$reset()});const G=async(m,i)=>{J.value=m;const d=p;Q.value.clear(),z.value="";const l=i,a=l.lastIndexOf("/"),h=l.substring(0,a),_="ad_campaign_"+l.substring(a+1).replace(".","_");d.item={name:_,originalVideoContentSourceUrl:i,videoContentSourceUrl:h,adDecisionServerUrl:"https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=/124319096/external/ad_rule_samples&ciu_szs=300x250&ad_rule=1&impl=s&gdfp_req=1&env=vp&output=vmap&unviewed_position_start=1&cust_params=deployment%3Ddevsite%26sample_ar%3Dpremidpost&cmsid=496&vid=short_onecue&correlator=[avail.random]"},g.value.$reset();var v=document.getElementById(u.value),B=_e.getOrCreateInstance(v);B.show()},y=async()=>{var m=document.getElementById(u.value),i=_e.getOrCreateInstance(m);i.hide(),K("refresh")},f=async()=>{const m=p;if(H.value)return;if(!await g.value.$validate()){window.scrollTo(0,0);return}try{H.value=!0,z.value="";const d=m.item;d.vodSourceId=J.value,await N.post("/api/v1/playbackconfigurations/vodsource",d).then(l=>{n.success("Add Vod Source Playback Configuration","Vod Source playback configuration added.",{async onClose(){}})}),await y()}catch(d){z.value=L.getErrorMessageAsHtml(d),window.scrollTo(0,0)}finally{H.value=!1}};return b({open:G,close:y}),(m,i)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:u.value,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",Nm,[e("div",Rm,[e("div",Fm,[e("h5",zm,[i[6]||(i[6]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Y(c(o(k)),1)]),e("button",{type:"button",class:"btn-close",onClick:i[0]||(i[0]=d=>y()),"aria-label":"Close"})]),e("div",Gm,[o(z)?(t(),s("div",jm,[i[7]||(i[7]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Y("Error ")],-1)),e("div",{innerHTML:o(z)},null,8,Ym)])):x("",!0),o(Q).size>0?(t(),s("div",Km,[i[8]||(i[8]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Y("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(A,null,E(o(Q).values(),d=>(t(),s("li",null,c(d),1))),256))])])):x("",!0),e("div",Wm,[e("div",Qm,[e("div",Jm,[q(e("input",{"onUpdate:modelValue":i[1]||(i[1]=d=>p.item.originalVideoContentSourceUrl=d),id:"originalVideoContentSourceUrl",class:"form-control",placeholder:"originalVideoContentSourceUrl",disabled:""},null,512),[[ee,p.item.originalVideoContentSourceUrl]]),i[9]||(i[9]=e("label",{for:"originalVideoContentSourceUrl",class:""},"Original Video Content Source Url",-1))])]),e("div",Zm,[e("div",Xm,[q(e("input",{"onUpdate:modelValue":i[2]||(i[2]=d=>p.item.name=d),id:"name",class:"form-control",placeholder:"Name"},null,512),[[ee,p.item.name]]),i[10]||(i[10]=e("label",{for:"name",class:""},"Name",-1)),o(g).item.name.$error?(t(),s("div",ef,[(t(!0),s(A,null,E(o(g).item.name.$errors,d=>(t(),s("div",{key:d.$uid},c(d.$message),1))),128))])):x("",!0)])]),e("div",tf,[e("div",sf,[q(e("input",{"onUpdate:modelValue":i[3]||(i[3]=d=>p.item.videoContentSourceUrl=d),id:"videoContentSourceUrl",class:"form-control",placeholder:"videoContentSourceUrl"},null,512),[[ee,p.item.videoContentSourceUrl]]),i[11]||(i[11]=e("label",{for:"videoContentSourceUrl",class:""},"Video Content Source Url",-1)),i[12]||(i[12]=e("div",null,[e("span",{class:"fas fa-fw fa-info-circle"}),e("span",{class:"text-info small"},"The URL prefix for the parent manifest for the stream, minus the asset ID")],-1)),o(g).item.videoContentSourceUrl.$error?(t(),s("div",of,[(t(!0),s(A,null,E(o(g).item.videoContentSourceUrl.$errors,d=>(t(),s("div",{key:d.$uid},c(d.$message),1))),128))])):x("",!0)])]),e("div",af,[e("div",lf,[q(e("textarea",{"onUpdate:modelValue":i[4]||(i[4]=d=>p.item.adDecisionServerUrl=d),id:"adDecisionServerUrl",class:"form-control",placeholder:"adDecisionServerUrl",style:{height:"10rem"}},null,512),[[ee,p.item.adDecisionServerUrl]]),i[13]||(i[13]=e("label",{for:"adDecisionServerUrl",class:""},"Ad Decision Server Url",-1)),o(g).item.adDecisionServerUrl.$error?(t(),s("div",nf,[(t(!0),s(A,null,E(o(g).item.adDecisionServerUrl.$errors,d=>(t(),s("div",{key:d.$uid},c(d.$message),1))),128))])):x("",!0)])])])]),e("div",rf,[e("button",{disabled:o(g).$dirty&&o(g).$invalid,onClick:i[5]||(i[5]=d=>f()),class:"btn btn-primary",type:"button"},i[14]||(i[14]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,df),i[15]||(i[15]=e("button",{"data-bs-dismiss":"modal",class:"btn btn-secondary ms-1"},[e("span",{class:"fas fa-fw fa-times"})],-1))])])])],8,Bm))}},cf={key:0},mf={class:"nav nav-tabs",id:"myTab",role:"tablist"},ff={class:"nav-item",role:"presentation"},pf={class:"nav-item",role:"presentation"},vf={class:"nav-item",role:"presentation"},gf={class:"nav-item",role:"presentation"},bf={class:"nav-item",role:"presentation"},yf={class:"tab-content",id:"myTabContent"},$f={class:""},hf={class:"row row-cols-1 row-cols-sm-2"},wf={class:"col"},_f=["id"],kf={class:"col"},Sf={class:"col"},Tf={class:"form-floating mb-2"},If={class:"mt-2"},Mf={class:"row row-cols-sm-2"},xf={class:"col"},Cf={class:"form-floating mb-2"},Vf={class:"form-control-plaintext card"},Af={class:"col"},Of={class:"form-floating mb-2"},Pf={class:"mt-2"},Uf={class:"badge bg-info me-1"},Lf={class:"badge bg-primary me-1"},Hf={class:"badge bg-info me-1"},Df={class:"table-responsive border mt-2"},Ef={class:"table table-hover mb-0"},qf={class:"table-group-divider"},Bf={class:"align-middle"},Nf={class:"text-center"},Rf={class:"text-truncate text-wrap"},Ff={class:"text-truncate text-wrap"},zf={class:""},Gf={class:"mt-2 text-end"},jf={class:"table-responsive border mt-2"},Yf={class:"table table-hover mb-0 caption-top"},Kf={class:"text-end"},Wf=["onClick"],Qf={class:""},Jf={class:"mt-1"},Zf=["id"],Xf={class:"text-end"},ep={__name:"view",props:{id:{type:String,required:!0},urlEdit:{type:String,default:"/vod-sources/edit"},urlMain:{type:String,default:"/vod-sources"},urlViewVideo:{type:String,default:"/videos/view"}},setup(r){const b=r,{appTitle:T,pageTitle:M,busy:k,isDirty:H,validations:V,infoMessage:Q,warningMessage:j,errorMessage:S,router:z,axios:ae,utils:N,toasts:L,close:n,closeWithReturnUrl:I,generateReturnUrl:$,security:K}=he({appTitle:"Arcadian-FAST",pageTitle:"View VOD Source"});Ce("$config");const J=we();J.user;const u=ye({user:J.user,item:null,hls:null}),p=ge();ge(null);const W=ge();fe(async()=>{await f();const _=N.getPageTab("vodSource")||"information-tab";g(_)}),Le(()=>{u.hls&&(u.hls.stopLoad(),u.hls.destroy())});const g=_=>{N.setPageTab("vodSource",_),p.value=_},G=_=>_!==p.value?"":"active",y=_=>_!==p.value?"":"show active",f=async()=>{const _=u;if(!k.value)try{k.value=!0,S.value="",u.item=null;const v=`/api/v1/vodsources/${b.id}/`;await ae.get(v).then(B=>{_.item=B.data;const P=_.item,w=N.moment.utc(_.item.video.durationInMillis).format("HH:mm:ss");P.video.duration=w}),h()}catch(v){S.value=N.getErrorMessageAsHtml(v),window.scrollTo(0,0)}finally{k.value=!1}},m=async()=>{await f()},i=()=>{W.value.open(u.item.vodSourceId,u.item.videoId)},d=async()=>{if(confirm("VOD will be submitted to AWS MediaTailer. Are you sure you want to publish the VOD?")&&!k.value){S.value=null;try{k.value=!0;const v={vodSourceIds:[b.id]};await ae.post("/api/v1/vodsources/publish/",v).then(B=>{L.success("Publish VOD","VOD was published.",{async onClose(){}})}),k.value=!1,await m()}catch(v){S.value=N.getErrorMessageAsHtml(v),window.scrollTo(0,0)}finally{k.value=!1}}},l=async()=>{if(confirm("VOD will be removed to AWS MediaTailer. Are you sure you want to remove the VOD?")&&!k.value){S.value=null;try{k.value=!0;const v={vodSourceIds:[b.id]};await ae.post("/api/v1/vodsources/unpublish/",v).then(B=>{L.warning("Remove VOD","VOD was removed.",{async onClose(){}})}),k.value=!1,await m()}catch(v){S.value=N.getErrorMessageAsHtml(v),window.scrollTo(0,0)}finally{k.value=!1}}},a=async _=>{if(confirm("Are you sure you want to remove the VOD Package configuration?")&&!k.value){S.value=null;try{k.value=!0,await ae.delete(`/api/v1/vodSources/package-configurations/${_}/`).then(B=>{L.warning("Remove VOD Source Package Configuration","VOD Source package configuration was removed.")}),k.value=!1,await m()}catch(B){S.value=N.getErrorMessageAsHtml(B),window.scrollTo(0,0)}finally{k.value=!1}}},h=()=>{if(Hls.isSupported()){u.hls&&(u.hls.stopLoad(),u.hls.destroy());const _=`video-${u.item.vodSourceId}`,v=document.getElementById(_),B=u.item.video.formats.find(w=>w.formatName==="HLS"),P=`${B.serverUrl}${B.path}`;u.hls=N.createHlsStream(v,P)}};return(_,v)=>{const B=oe("router-link"),P=oe("PageHeader"),w=oe("PageBody");return t(),be($e,null,{default:R(()=>[e("div",null,[F(P,{"page-icon":"fas fa-fw fa-tag",pageTitle:o(M)},{default:R(()=>[u.item?(t(),s(A,{key:0},[u.item.arn?(t(),s("button",{key:0,onClick:v[0]||(v[0]=D=>l()),class:"ms-1 btn btn-warning"},v[14]||(v[14]=[e("span",{class:"fas fa-fw fa-unlink"},null,-1)]))):(t(),s("button",{key:1,onClick:v[1]||(v[1]=D=>d()),class:"ms-1 btn btn-primary"},v[15]||(v[15]=[e("span",{class:"fas fa-fw fa-link"},null,-1)])))],64)):x("",!0),F(B,{to:`${r.urlEdit}/${r.id}`,class:"ms-2 btn btn-primary"},{default:R(()=>v[16]||(v[16]=[e("span",{class:"fas fa-fw fa-edit"},null,-1)])),_:1},8,["to"]),e("button",{onClick:v[2]||(v[2]=D=>m()),class:"ms-2 btn btn-secondary"},v[17]||(v[17]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:v[3]||(v[3]=D=>o(I)(b.urlMain)),class:"btn btn-secondary ms-1"},v[18]||(v[18]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),F(w,{errorMessage:o(S)},{default:R(()=>[u.item?(t(),s("div",cf,[e("div",null,[e("ul",mf,[e("li",ff,[e("button",{onClick:v[4]||(v[4]=D=>g("information-tab")),class:te([G("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"}," Information ",2)]),e("li",pf,[e("button",{onClick:v[5]||(v[5]=D=>g("packageConfigurations-tab")),class:te([G("packageConfigurations-tab"),"nav-link"]),id:"packageConfigurations-tab","data-bs-toggle":"tab","data-bs-target":"#packageConfigurations",type:"button",role:"tab","aria-controls":"packageConfigurations","aria-selected":"false"}," Package Configurations ",2)]),e("li",vf,[e("button",{onClick:v[6]||(v[6]=D=>g("channels-tab")),class:te([G("channels-tab"),"nav-link"]),id:"channels-tab","data-bs-toggle":"tab","data-bs-target":"#channels",type:"button",role:"tab","aria-controls":"channels","aria-selected":"false"},v[19]||(v[19]=[e("span",{class:"fas fa-fw fa-warning me-1"},null,-1),Y("Channels ")]),2)]),e("li",gf,[e("button",{onClick:v[7]||(v[7]=D=>g("programs-tab")),class:te([G("programs-tab"),"nav-link"]),id:"programs-tab","data-bs-toggle":"tab","data-bs-target":"#programs",type:"button",role:"tab","aria-controls":"programs","aria-selected":"false"},v[20]||(v[20]=[e("span",{class:"fas fa-fw fa-warning me-1"},null,-1),Y("Programs ")]),2)]),e("li",bf,[e("button",{onClick:v[8]||(v[8]=D=>g("programTemplates-tab")),class:te([G("programTemplates-tab"),"nav-link"]),id:"programTemplates-tab","data-bs-toggle":"tab","data-bs-target":"#programTemplates",type:"button",role:"tab","aria-controls":"programTemplates","aria-selected":"false"},v[21]||(v[21]=[e("span",{class:"fas fa-fw fa-warning me-1"},null,-1),Y("Program Templates ")]),2)])]),e("div",yf,[e("div",{class:te([y("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",$f,[e("div",hf,[e("div",wf,[e("video",{id:`video-${u.item.vodSourceId}`,controls:"",muted:"",class:"card-img-top object-fit-contain border"},null,8,_f)]),e("div",kf,[e("div",Sf,[e("div",Tf,[q(e("input",{"onUpdate:modelValue":v[9]||(v[9]=D=>u.item.name=D),type:"text",class:"form-control-plaintext card",id:"name"},null,512),[[ee,u.item.name]]),v[22]||(v[22]=e("label",{for:"name"},"Name",-1))])]),e("div",If,[v[26]||(v[26]=e("b",null," Video Information ",-1)),e("div",null,[e("div",Mf,[e("div",xf,[e("div",Cf,[e("div",Vf,[F(B,{to:`${r.urlViewVideo}/${u.item.video.videoId}/${o($)()}`,class:"link-offset-2"},{default:R(()=>[Y(c(u.item.video.title),1)]),_:1},8,["to"])]),v[23]||(v[23]=e("label",{for:"title"},"Title",-1))])]),e("div",Af,[e("div",Of,[q(e("input",{"onUpdate:modelValue":v[10]||(v[10]=D=>u.item.video.duration=D),type:"text",class:"form-control-plaintext card",id:"duration"},null,512),[[ee,u.item.video.duration]]),v[24]||(v[24]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",Pf,[(t(!0),s(A,null,E(u.item.video.genres,D=>(t(),s("span",Uf,c(D.genreName),1))),256)),(t(!0),s(A,null,E(u.item.video.categories,D=>(t(),s("span",Lf,c(D.categoryName),1))),256)),(t(!0),s(A,null,E(u.item.video.categories,D=>(t(),s("span",Hf,c(D.categoryName),1))),256))]),e("div",Df,[e("table",Ef,[v[25]||(v[25]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Type"),e("th",null,"Server"),e("th",null,"Path")])],-1)),e("tbody",qf,[(t(!0),s(A,null,E(u.item.video.formats,(D,X)=>(t(),s("tr",Bf,[e("td",Nf,c(X+1),1),e("td",null,c(D.formatName),1),e("td",null,[e("div",Rf,c(D.serverUrl),1)]),e("td",null,[e("div",Ff,c(D.path),1)])]))),256))])])])])])])])])],2),e("div",{class:te([y("packageConfigurations-tab"),"tab-pane fade"]),id:"packageConfigurations",role:"tabpanel","aria-labelledby":"packageConfigurations-tab"},[e("div",zf,[e("div",Gf,[e("button",{onClick:v[11]||(v[11]=D=>i()),class:"btn btn-outline-primary btn-sm"},v[27]||(v[27]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))]),e("div",jf,[e("table",Yf,[v[29]||(v[29]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Path"),e("th",null,"Source Group"),e("th",null,"Type"),e("th")])],-1)),q(F(Se,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(A,null,E(u.item.packageConfigurations,(D,X)=>(t(),s("tr",{key:D.packageConfigurationId,class:"align-middle"},[e("td",null,c(X+1),1),e("td",null,c(D.path),1),e("td",null,c(D.sourceGroup.name),1),e("td",null,c(D.type),1),e("td",Kf,[e("button",{onClick:U=>a(D.packageConfigurationId),class:"btn btn-outline-warning btn-sm"},v[28]||(v[28]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,Wf)])]))),128))]),_:1},512),[[ke,u.item.packageConfigurations.length>0]])])])])],2),e("div",{class:te([y("viewStream-tab"),"tab-pane fade"]),id:"viewStream",role:"tabpanel","aria-labelledby":"viewStream-tab"},[e("div",Qf,[e("div",Jf,[e("video",{id:`video-${u.item.vodSourceId}`,controls:"",muted:"",class:"card-img-top object-fit-contain border"},null,8,Zf),e("div",Xf,[e("button",{onClick:v[12]||(v[12]=D=>u.hls.startLoad(-1)),class:"btn btn-outline-info btn-sm"},v[30]||(v[30]=[e("span",{class:"fas fa-fw fa-cloud-download"},null,-1)]))])])])],2),e("div",{class:te([y("channels-tab"),"tab-pane fade"]),id:"channels",role:"tabpanel","aria-labelledby":"channels-tab"},v[31]||(v[31]=[e("div",{class:""}," TODO: List of Channels using this as filler slate ",-1)]),2),e("div",{class:te([y("programs-tab"),"tab-pane fade"]),id:"programs",role:"tabpanel","aria-labelledby":"programs-tab"},v[32]||(v[32]=[e("div",{class:""}," TODO: List of Programs using this as VOD source ",-1)]),2),e("div",{class:te([y("programTemplates-tab"),"tab-pane fade"]),id:"programTemplates",role:"tabpanel","aria-labelledby":"programTemplates-tab"},v[33]||(v[33]=[e("div",{class:""}," TODO: List of Program Templates using this as VOD source ",-1)]),2)])])])):x("",!0)]),_:1},8,["errorMessage"]),F(qm,{ref_key:"modalAddPackageConfiguration",ref:W,onRefresh:m},null,512),F(uf,{ref:"modalAddPlaybackConfiguration",onRefresh:v[13]||(v[13]=D=>m())},null,512)])]),_:1})}}},tp=["id"],sp={class:"modal-dialog modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},op={class:"modal-content"},ap={class:"modal-header py-2"},lp={class:"modal-title"},np={class:"modal-body p-0"},rp={class:"row row-cols-1 row-cols-sm-3 g-2 g-md-3"},ip={class:"col"},dp={class:"form-floating mb-2"},up=["disabled"],cp=["value","disabled"],mp={class:"col"},fp={class:"form-floating mb-2"},pp=["value"],vp={class:"col"},gp={class:"input-group mb-2"},bp={class:"form-floating"},yp={class:"row g-2 g-md-3"},$p={class:"col-md-4"},hp={class:"card h-100"},wp={key:0,class:"mt-2"},_p={class:"col"},kp={class:"form-floating mb-2"},Sp={class:"col ms-2 my-2"},Tp={class:"badge bg-info me-1"},Ip={class:"badge bg-primary me-1"},Mp={class:"row row-cols-1 row-cols-sm-2"},xp={class:"col"},Cp={class:"form-floating mb-2"},Vp={class:"form-control-plaintext",id:"dateReleased",placeholder:"Date Released",readonly:""},Ap={class:"col d-block"},Op={class:"form-floating mb-2"},Pp={class:"form-control-plaintext",id:"duration",placeholder:"Duration"},Up={class:"col"},Lp={class:"form-floating mb-2"},Hp={class:"table-responsive card shadow-sm"},Dp={class:"table table-sm table-hover mb-0 overflow-auto"},Ep=["textContent"],qp={class:"d-flex flex-row justify-content-start"},Bp={class:"mt-1"},Np=["src"],Rp={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},Fp={class:"ms-2"},zp=["onClick"],Gp={key:0,class:"fas fa-fw fa-check-circle text-primary"},jp={class:"badge text-bg-info"},Yp={class:"modal-footer py-2"},Kp=["disabled"],Wp="/api/v1/vodSources/search",Re={__name:"_selectVodSource",props:{sourceLocationId:{type:String,required:!0},genreId:{type:String},categoryId:{type:String},durationInMillis:{type:String},withArn:{type:String}},emits:["confirm","cancel"],setup(r,{expose:b,emit:T}){const k=we().user,{appTitle:H,pageTitle:V,busy:Q,infoMessage:j,warningMessage:S,errorMessage:z,router:ae,axios:N,utils:L,toasts:n,security:I,filter:$,initializeFilter:K,getQuery:J,saveQuery:u,search:p,getRowNumber:W,setSelected:g,isSelected:G}=De({appTitle:"Arcadian-FAST",pageTitle:"Select VOD Source",cacheKey:`${k==null?void 0:k.userId}/vodsources/select`,baseUrl:Wp,filter:{updateUrl:!0,lookups:{genres:[]},query:{genreId:0,categoryId:0,sourceLocationId:null,durationInMillis:0}},initializeFilter:(P,w)=>{P.value,new URLSearchParams(window.location.search),JSON.parse(localStorage.getItem(w)),P.value.query.sourceLocationId=f.sourceLocationId||null,P.value.query.genreId=f.genreId||0,P.value.query.categoryId=f.categoryId||0,P.value.query.durationInMillis=f.durationInMillis||0,P.value.query.withArn=f.withArn||!1},getQuery:P=>["?c=",encodeURIComponent(P.query.criteria),"&p=",P.pageIndex,"&s=",P.pageSize,"&sf=",P.sortField,"&so=",P.sortOrder,"&slid=",P.query.sourceLocationId,"&genre=",P.query.genreId,"&category=",P.query.categoryId,"&durationInMillis=",P.query.durationInMillis,"&withArn=true"].join(""),saveQuery:(P,w)=>{localStorage.setItem(w,JSON.stringify({criteria:P.query.criteria,pageIndex:P.pageIndex,pageSize:P.pageSize,sortField:P.sortField,sortOrder:P.sortOrder,visible:P.visible}))},successAction:P=>{P.items.length===1&&v(P.items[0])}}),y=T,f=r,m=ge("modalSelectVodSource"),i=ye({vodSource:null,hls:null});fe(async()=>{K(),await d(),await l()}),Le(()=>{i.hls&&(i.hls.stopLoad(),i.hls.destroy())});const d=async()=>{await h(),await _()},l=async()=>{z.value="",await p();var P=document.getElementById(m.value),w=_e.getOrCreateInstance(P);w.show()},a=async P=>{var w=document.getElementById(m.value),D=_e.getOrCreateInstance(w);D.hide(),i.hls&&(i.hls.stopLoad(),i.hls.destroy()),y(P?"confirm":"cancel",P?i.vodSource:null)},h=async P=>{try{const D=await N.get("/api/v1/lookups/video-categories/").then(X=>X.data);$.value.lookups.categories=D}catch(w){z.value=L.getErrorMessageAsHtml(w),window.scrollTo(0,0)}finally{}},_=async P=>{try{const D=await N.get("/api/v1/lookups/video-genres/").then(X=>X.data);$.value.lookups.genres=D}catch(w){z.value=L.getErrorMessageAsHtml(w),window.scrollTo(0,0)}finally{}},v=P=>{i.vodSource=P,B()},B=()=>{if(Hls.isSupported()){i.hls&&(i.hls.stopLoad(),i.hls.destroy());var P=document.getElementById("video-select-preview");const D=i.vodSource.video.formats.find(U=>U.formatName==="HLS"),X=D.serverUrl+D.path;i.hls=L.createHlsStream(P,X)}};return b({open:l,close:a}),(P,w)=>{const D=oe("m-pagination"),X=oe("PageBody");return t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:m.value,tabindex:"-1","aria-hidden":"true"},[e("div",sp,[e("div",op,[e("div",ap,[e("h5",lp,[w[10]||(w[10]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Y(c(o(V)),1)]),e("button",{type:"button",class:"btn-close",onClick:w[0]||(w[0]=U=>a(!1)),"aria-label":"Close"})]),e("div",np,[F(X,{errorMessage:o(z)},{default:R(()=>[e("div",rp,[e("div",ip,[e("div",dp,[q(e("select",{"onUpdate:modelValue":w[1]||(w[1]=U=>o($).query.categoryId=U),class:"form-select form-control-plaintext",id:"category",disabled:f.categoryId>0},[(t(!0),s(A,null,E(o($).lookups.categories,U=>(t(),s("option",{value:U.id,disabled:f.categoryId>0},c(U.name),9,cp))),256))],8,up),[[pe,o($).query.categoryId]]),w[11]||(w[11]=e("label",{for:"category",class:""},"Category",-1))])]),e("div",mp,[e("div",fp,[q(e("select",{"onUpdate:modelValue":w[2]||(w[2]=U=>o($).query.genreId=U),class:"form-select",id:"genre"},[(t(!0),s(A,null,E(o($).lookups.genres,U=>(t(),s("option",{value:U.id},c(U.name),9,pp))),256))],512),[[pe,o($).query.genreId]]),w[12]||(w[12]=e("label",{for:"genre",class:""},"Genre",-1))])]),e("div",vp,[e("div",gp,[e("div",bp,[q(e("input",{"onUpdate:modelValue":w[3]||(w[3]=U=>o($).query.criteria=U),onKeyup:w[4]||(w[4]=He(U=>o(p)(1),["enter"])),id:"criteria",type:"text",class:"form-control"},null,544),[[ee,o($).query.criteria]]),w[13]||(w[13]=e("label",{for:"criteria",class:""},"Criteria",-1))]),e("button",{class:"btn btn-primary",type:"button",onClick:w[5]||(w[5]=U=>o(p)(1))},w[14]||(w[14]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),e("div",yp,[q(e("div",$p,[e("div",hp,[w[19]||(w[19]=e("video",{id:"video-select-preview",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain"},null,-1)),i.vodSource?(t(),s("div",wp,[e("div",_p,[e("div",kp,[q(e("input",{"onUpdate:modelValue":w[6]||(w[6]=U=>i.vodSource.video.title=U),type:"text",class:"form-control-plaintext",id:"title",placeholder:"Title",readonly:""},null,512),[[ee,i.vodSource.video.title]]),w[15]||(w[15]=e("label",{for:"title"},"Title",-1))])]),e("div",Sp,[e("div",null,[(t(!0),s(A,null,E(i.vodSource.video.genres,U=>(t(),s("span",Tp,c(U.genreName),1))),256)),(t(!0),s(A,null,E(i.vodSource.video.categories,U=>(t(),s("span",Ip,c(U.categoryName),1))),256))])]),e("div",Mp,[e("div",xp,[e("div",Cp,[e("div",Vp,c(o(L).moment(i.vodSource.video.dateReleased).calendar()),1),w[16]||(w[16]=e("label",{for:"dateReleased"},"Date Released",-1))])]),e("div",Ap,[e("div",Op,[e("div",Pp,c(o(L).moment.utc(i.vodSource.video.durationInMillis).format("HH:mm:ss")),1),w[17]||(w[17]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",Up,[e("div",Lp,[q(e("textarea",{"onUpdate:modelValue":w[7]||(w[7]=U=>i.vodSource.video.description=U),type:"text",class:"form-control-plaintext",id:"description",placeholder:"Description",readonly:"",style:{height:"11rem"}},null,512),[[ee,i.vodSource.video.description]]),w[18]||(w[18]=e("label",{for:"description"},"Description",-1))])])])):x("",!0)])],512),[[ke,i.vodSource]]),e("div",{class:te([i.vodSource?"col-md-8":"col-md-12"])},[e("div",Hp,[e("table",Dp,[w[20]||(w[20]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Title")])],-1)),q(F(Se,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(A,null,E(o($).items,(U,ne)=>(t(),s("tr",{key:U.videoId},[e("td",{textContent:c(o(W)(ne)),class:"text-center"},null,8,Ep),e("td",null,[e("div",qp,[e("div",null,[U.video.thumbnails.length>0?(t(!0),s(A,{key:0},E(U.video.thumbnails,Z=>(t(),s("div",Bp,[e("img",{src:Z.url,class:"img-fuild border",width:"128"},null,8,Np)]))),256)):(t(),s("img",Rp))]),e("div",Fp,[e("a",{onClick:Z=>v(U),class:"text-wrap link-offset-2",role:"button"},[i.vodSource===U?(t(),s("span",Gp)):x("",!0),Y(c(U.name),1)],8,zp),e("div",null,[e("span",jp,c(o(L).moment.utc(U.video.durationInMillis).format("HH:mm:ss")),1)])])])])]))),128))]),_:1},512),[[ke,o($).items.length>0]])])]),F(D,{filter:o($),search:o(p),showPerPage:!0},null,8,["filter","search"])],2)])]),_:1},8,["errorMessage"])]),e("div",Yp,[e("button",{onClick:w[8]||(w[8]=U=>a(!0)),class:"btn btn-primary btn-sm",type:"button",disabled:!i.vodSource},w[21]||(w[21]=[e("span",{class:"fas fa-fw fa-circle-check"},null,-1)]),8,Kp),e("button",{onClick:w[9]||(w[9]=U=>a(!1)),class:"btn btn-secondary btn-sm ms-1"},w[22]||(w[22]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])])],8,tp)}}},Qp=["disabled"],Jp={class:"container1"},Zp={class:"row"},Xp={class:"col-12 col-lg-5"},ev={class:"col"},tv={class:"form-floating mb-2"},sv=["value"],ov={key:0,class:"d-block invalid-feedback"},av={class:"col"},lv={class:"input-group mb-2"},nv={class:"form-floating"},rv={class:"col-12 col-lg-7"},iv={class:"col"},dv={class:"form-floating mb-2"},uv={key:0,class:"d-block invalid-feedback"},cv={class:"row row-cols-1 row-cols-sm-3 mt-2"},mv={class:"col"},fv={class:"form-floating mb-2"},pv={key:0},vv={key:1},gv={key:2},bv={key:3,class:"d-block invalid-feedback"},yv={class:"col"},$v={class:"form-floating mb-2"},hv={key:0},wv={key:1},_v={key:2,class:"d-block invalid-feedback"},kv={class:"col"},Sv={class:"form-floating mb-2"},Tv={key:0,class:"mt-3"},Iv={class:"table-responsive border mt-1"},Mv={class:"table table-sm mb-0 align-middle"},xv={class:"table-group-divider"},Cv={class:"text-center"},Vv=["onUpdate:modelValue","onChange"],Av={key:0},Ov=["onUpdate:modelValue","onChange"],Pv={key:0},Uv={key:1},Lv={class:"text-start"},Hv={class:"d-flex flex-row justify-content-end align-items-baseline"},Dv=["onClick"],Ev=["onClick"],qv={class:"col mt-2"},Bv={class:"row row-cols-1 row-cols-sm-2"},Nv={class:"col"},Rv={class:"form-floating mb-2"},Fv={class:"col"},zv={class:"form-floating mb-2"},Gv={__name:"add",props:{urlView:{type:String,default:"/program-templates/view"},urlMain:{type:String,default:"/program-templates"}},setup(r){const{appTitle:b,pageTitle:T,busy:M,infoMessage:k,warningMessage:H,errorMessage:V,router:Q,axios:j,utils:S,toasts:z,close:ae,security:N}=he({appTitle:"Arcadian-FAST",pageTitle:"Add Program Template"}),L=r,n=ye({lookups:{sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[]},selected:{vodSource:null},startOffsetTime:null,endOffsetTime:null,item:{name:null,sourceLocationId:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]},hls:null}),I={item:{name:{required:le.withMessage("Name is required.",re),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:le.withMessage("sourceLocationId is required.",re),$autoDirty:!0,$lazy:!0},vodSourceId:{required:le.withMessage("vodSourceId is required.",re),$autoDirty:!0,$lazy:!0},startOffsetMillis:{required:le.withMessage("startOffsetMillis is required.",re),minValue:Be(0),$autoDirty:!0,$lazy:!0},endOffsetMillis:{required:le.withMessage("endOffsetMillis is required.",re),minValue:Be(0),$autoDirty:!0,$lazy:!0}}},$=Te(I,n),K=xe(()=>{const X=S.moment;if(n.startOffsetTime&&n.startOffsetTime!=="00:00:00"&&S.isValidTime(n.startOffsetTime)){const U=X().startOf("day"),ne=U.format("YYYY-MM-DD ")+n.startOffsetTime,se=X(ne).subtract(U);return n.item.startOffsetMillis=se.valueOf(),n.item.startOffsetMillis}return 0}),J=xe(()=>{const X=S.moment;if(n.endOffsetTime&&n.endOffsetTime!=="00:00:00"&&S.isValidTime(n.endOffsetTime)){const U=X().startOf("day"),ne=U.format("YYYY-MM-DD ")+n.endOffsetTime,se=X(ne).subtract(U);return n.item.endOffsetMillis=se.valueOf(),n.item.endOffsetMillis}return 0}),u=xe(()=>n.item.endOffsetMillis-n.item.startOffsetMillis),p=xe(()=>S.moment.utc(u.value).format("HH:mm:ss")),W=xe(()=>{const X=n.item.adBreaks;return X&&X.length>0?X.reduce((ne,Z,se)=>ne+Z.durationInMillis,0):0}),g=xe(()=>{const X=u.value+W.value;return S.moment.utc(X).format("HH:mm:ss")}),G=xe(()=>S.moment.utc(W.value).format("HH:mm:ss"));fe(async()=>{await y()}),Le(()=>{n.hls&&(n.hls.stopLoad(),n.hls.destroy())});const y=async()=>{await f(),await l()},f=async()=>{try{await j.get("/api/v1/sourcelocations/lookup/").then(U=>{n.lookups.sourceLocations=U.data,n.lookups.sourceLocations.length===1&&(n.item.sourceLocationId=n.lookups.sourceLocations[0].id)}),n.item.sourceLocationId&&await m(n.item.sourceLocationId)}catch(X){V.value=S.getErrorMessageAsHtml(X),window.scrollTo(0,0)}finally{}},m=async X=>{try{const U=`/api/v1/vodSources/lookup/source-location/${X}/?category=3`;await j.get(U).then(ne=>{n.lookups.vodSources=ne.data}),n.selected.vodSource=null,i()}catch(U){V.value=S.getErrorMessageAsHtml(U),window.scrollTo(0,0)}finally{}},i=async()=>{const X=n.selected.vodSource;X?(n.item.vodSourceId=X.id,n.endOffsetTime=S.moment.utc(X.durationInMillis).format("HH:mm:ss"),await d(X.vodSourceId),P()):(n.selected.vodSource=null,n.item.vodSourceId=null,n.startOffsetTime=null,n.endOffsetTime=null,n.hls&&(n.hls.stopLoad(),n.hls.destroy()))},d=async X=>{try{let U=`/api/v1/vodSources/${X}/blank-frames`;const ne=await j.get(U).then(Z=>Z.data);n.item.adBreaks=[],ne&&ne.length>0&&(n.item.adBreaks=ne.map(Z=>{const se=(Z.endInMillis-Z.startInMillis)/2+Z.startInMillis;return{offsetTime:S.moment.utc(se).format("HH:mm:ss"),offsetMillis:se,durationTime:"00:00:00",durationInMillis:0,sourceLocationId:null,vodSourceId:null}}))}catch{}finally{}},l=async()=>{try{await j.get("/api/v1/sourcelocations/lookup/").then(U=>{n.lookups.adBreakSourceLocations=U.data})}catch(X){V.value=S.getErrorMessageAsHtml(X),window.scrollTo(0,0)}finally{}},a=()=>{const X={offsetTime:"00:00:00",offsetMillis:0,durationTime:"00:00:00",durationInMillis:0,sourceLocationId:null,vodSourceId:null};n.item.adBreaks.push(X)},h=X=>{n.item.adBreaks.splice(X,1)},_=X=>{const U=S.moment,ne=U().startOf("day"),Z=ne.format("YYYY-MM-DD ")+X.offsetTime,O=U(Z).subtract(ne);X.offsetMillis=O.valueOf()},v=X=>{const U=S.moment,ne=U().startOf("day"),Z=ne.format("YYYY-MM-DD ")+X.durationTime,O=U(Z).subtract(ne);X.durationInMillis=O.valueOf()},B=async()=>{const X=n;if(M.value)return;if(!await $.value.$validate()){window.scrollTo(0,0);return}try{M.value=!0,V.value="";const ne=S.clone(X.item),Z=ne.adBreaks.filter(se=>se.durationInMillis>0).map(se=>({offsetMillis:se.offsetMillis,durationInMillis:se.durationInMillis,vodSourceId:se.vodSource?se.vodSource.vodSourceId:null}));ne.adBreaks=Z,await j.post("/api/v1/programtemplates/",ne).then(se=>{z.success("Add Program Template","Program template added.",{onClose:async()=>{const O=`${L.urlView}/${se.data}`;await Q.push(O)}})})}catch(ne){V.value=S.getErrorMessageAsHtml(ne),window.scrollTo(0,0)}finally{M.value=!1}},P=()=>{if(Hls.isSupported()){n.hls&&(n.hls.stopLoad(),n.hls.destroy());var X=document.getElementById("video-add-program-template");const ne=n.selected.vodSource.video.formats.find(se=>se.formatName==="HLS"),Z=ne.serverUrl+ne.path;n.hls=S.createHlsStream(X,Z)}},w=async()=>{const X=Ae(Re,{sourceLocationId:n.item.sourceLocationId,genreId:0,categoryId:3,withArn:!0},{chore:!0,keepInitial:!1}),{data:U,isCanceled:ne}=await X.reveal();if(X.closeAll(),!ne&&U){const Z=U;n.selected.vodSource=Z,n.item.vodSourceId=Z.vodSourceId,n.startOffsetTime="00:00:00",n.endOffsetTime=S.moment.utc(Z.video.durationInMillis).format("HH:mm:ss"),await d(Z.vodSourceId),P()}},D=async X=>{const U=Ae(Re,{sourceLocationId:null,genreId:0,categoryId:1,durationInMillis:X.durationInMillis,withArn:!0},{chore:!0,keepInitial:!1}),{data:ne,isCanceled:Z}=await U.reveal();U.closeAll(),!Z&&ne&&(X.vodSource=ne)};return(X,U)=>{const ne=oe("router-link"),Z=oe("PageHeader"),se=oe("PageBody");return t(),be($e,null,{default:R(()=>[e("div",null,[F(Z,{"page-icon":"fas fa-fw fa-file-video",pageTitle:o(T)},{default:R(()=>[e("button",{disabled:o($).$dirty&&o($).$invalid,onClick:U[0]||(U[0]=O=>B()),class:"btn btn-primary"},U[9]||(U[9]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,Qp),F(ne,{to:L.urlMain,class:"btn btn-secondary ms-2"},{default:R(()=>U[10]||(U[10]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),F(se,{errorMessage:o(V),vuelidate:o($)},{default:R(()=>[e("div",null,[e("div",Jp,[e("div",Zp,[e("div",Xp,[e("div",ev,[e("div",tv,[q(e("select",{"onUpdate:modelValue":U[1]||(U[1]=O=>n.item.sourceLocationId=O),onChange:U[2]||(U[2]=O=>m(n.item.sourceLocationId)),class:te([o(S).getValidFeedbackCss(n.item.sourceLocationId),"form-select"]),id:"sourceLocationId"},[(t(!0),s(A,null,E(n.lookups.sourceLocations,O=>(t(),s("option",{value:O.id},c(O.name),9,sv))),256))],34),[[pe,n.item.sourceLocationId]]),U[11]||(U[11]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o($).item.sourceLocationId.$error?(t(),s("div",ov,[(t(!0),s(A,null,E(o($).item.sourceLocationId.$errors,O=>(t(),s("div",{key:O.$uid},c(O.$message),1))),128))])):x("",!0)])]),e("div",av,[e("div",lv,[e("div",nv,[e("div",{id:"selectedVodSource",class:te([o(S).getValidFeedbackCss(n.selected.vodSource),"form-control"]),placeholder:"Title"},[n.selected.vodSource?(t(),s(A,{key:0},[Y(" ["+c(o(S).moment.utc(n.selected.vodSource.video.durationInMillis).format("HH:mm:ss"))+"] - "+c(n.selected.vodSource.name),1)],64)):x("",!0)],2),U[12]||(U[12]=e("label",{for:"selectedVodSource",class:""},"VOD Source",-1))]),n.item.sourceLocationId?(t(),s("button",{key:0,onClick:w,class:"btn btn-primary",type:"button"},U[13]||(U[13]=[e("i",{class:"fa-solid fa-filter"},null,-1)]))):x("",!0)])]),U[14]||(U[14]=e("div",{class:"col"},[e("div",null,[e("video",{id:"video-add-program-template",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain border"})])],-1))]),e("div",rv,[e("div",iv,[e("div",dv,[q(e("input",{"onUpdate:modelValue":U[3]||(U[3]=O=>n.item.name=O),id:"name",class:te([o(S).getValidFeedbackCss(n.item.name),"form-control"]),placeholder:"Name"},null,2),[[ee,n.item.name]]),U[15]||(U[15]=e("label",{for:"name",class:""},"Name",-1)),o($).item.name.$error?(t(),s("div",uv,[(t(!0),s(A,null,E(o($).item.name.$errors,O=>(t(),s("div",{key:O.$uid},c(O.$message),1))),128))])):x("",!0)])]),e("div",cv,[e("div",mv,[e("div",null,[e("div",fv,[q(e("input",{"onUpdate:modelValue":U[4]||(U[4]=O=>n.startOffsetTime=O),type:"time",step:"1",id:"startOffsetTime",class:te([o(S).getValidFeedbackCss(n.startOffsetTime),"form-control"])},null,2),[[ee,n.startOffsetTime]]),U[16]||(U[16]=e("label",{for:"startOffsetTime",class:""}," Start OffSet Time ",-1))]),K.value>0&&K.value<3e4?(t(),s("div",pv,U[17]||(U[17]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset must be at least 30 seconds ",-1)]))):x("",!0),K.value>J.value&&J.value>0?(t(),s("div",vv,U[18]||(U[18]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start offset time Exceeds End offset time ",-1)]))):x("",!0),n.selected.vodSource&&K.value>=n.selected.vodSource.durationInMillis?(t(),s("div",gv,U[19]||(U[19]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset Time Exceeds VOD Source Duration ",-1)]))):x("",!0),o($).item.startOffsetMillis.$error?(t(),s("div",bv,[(t(!0),s(A,null,E(o($).item.startOffsetMillis.$errors,O=>(t(),s("div",{key:O.$uid},c(O.$message),1))),128))])):x("",!0)])]),e("div",yv,[e("div",null,[e("div",$v,[q(e("input",{"onUpdate:modelValue":U[5]||(U[5]=O=>n.endOffsetTime=O),type:"time",step:"1",id:"endOffsetTime",class:te([o(S).getValidFeedbackCss(n.endOffsetTime),"form-control"])},null,2),[[ee,n.endOffsetTime]]),U[20]||(U[20]=e("label",{for:"endOffsetTime",class:""}," End OffSet Time ",-1))]),J.value>0&&J.value<3e4?(t(),s("div",hv,U[21]||(U[21]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset must be at least 30 seconds ",-1)]))):x("",!0),n.selected.vodSource&&J.value>n.selected.vodSource.durationInMillis?(t(),s("div",wv,U[22]||(U[22]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset Time Exceeds VOD Source Duration ",-1)]))):x("",!0),o($).item.endOffsetMillis.$error?(t(),s("div",_v,[(t(!0),s(A,null,E(o($).item.endOffsetMillis.$errors,O=>(t(),s("div",{key:O.$uid},c(O.$message),1))),128))])):x("",!0)])]),e("div",kv,[e("div",Sv,[q(e("input",{"onUpdate:modelValue":U[6]||(U[6]=O=>p.value=O),type:"text",class:"form-control-plaintext",id:"durationTime",readonly:""},null,512),[[ee,p.value]]),U[23]||(U[23]=e("label",{for:"durationTime"},"Clip",-1))])])]),n.item.vodSourceId?(t(),s("div",Tv,[e("div",{class:"d-flex flex-row justify-content-between align-items-center"},[U[25]||(U[25]=e("div",{class:"fw-bold small"}," Ad Break ",-1)),e("div",null,[e("button",{onClick:a,class:"btn btn-outline-primary btn-sm"},U[24]||(U[24]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))])]),e("div",Iv,[e("table",Mv,[U[29]||(U[29]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Offset Time"),e("th",null,"Duration Time"),e("th",null,"VOD Source"),e("th")])],-1)),e("tbody",xv,[(t(!0),s(A,null,E(n.item.adBreaks,(O,me)=>(t(),s("tr",null,[e("td",Cv,c(me+1),1),e("td",null,[q(e("input",{"onUpdate:modelValue":ue=>O.offsetTime=ue,onChange:ue=>_(O),type:"time",step:"1",class:te([o(S).getValidFeedbackCss(O.offsetTime),"form-control"])},null,42,Vv),[[ee,O.offsetTime]]),O.offsetMillis>=n.selected.vodSource.durationInMillis?(t(),s("div",Av,U[26]||(U[26]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Ad Break Offset Time Exceeds VOD Source Duration ",-1)]))):x("",!0)]),e("td",null,[q(e("input",{"onUpdate:modelValue":ue=>O.durationTime=ue,onChange:ue=>v(O),type:"time",step:"1",class:te([o(S).getValidFeedbackCss(O.durationTime),"form-control"])},null,42,Ov),[[ee,O.durationTime]])]),e("td",null,[O.vodSource?(t(),s("span",Pv,c(O.vodSource.name),1)):x("",!0),O.durationInMillis<=0?(t(),s("span",Uv," Specify the Ad Break Duration Time to configure the VOD to assign ")):x("",!0)]),e("td",Lv,[e("div",Hv,[O.durationInMillis>0?(t(),s("button",{key:0,onClick:ue=>D(O),class:"btn btn-outline-info btn-sm"},U[27]||(U[27]=[e("span",{class:"fas fa-fw fa-cog"},null,-1)]),8,Dv)):x("",!0),e("button",{onClick:ue=>h(me),class:"btn btn-outline-warning btn-sm ms-2"},U[28]||(U[28]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,Ev)])])]))),256))])]),U[30]||(U[30]=e("div",{class:"small m-2 text-end"},[e("div",null,[e("span",{class:"fas fa-fw fa-circle-info"}),Y(" Vod source can also be defined during creation of Program Instance. Allowed VODs will be based on the channel's output type (HLS or DASH) and duration specified on this ad break. ")])],-1))])])):x("",!0),e("div",qv,[U[33]||(U[33]=e("div",{class:"fw-bold small"}," Duration ",-1)),e("div",Bv,[e("div",Nv,[e("div",Rv,[q(e("input",{"onUpdate:modelValue":U[7]||(U[7]=O=>G.value=O),type:"text",class:"form-control-plaintext",id:"totalAdBreakDurationTime",readonly:""},null,512),[[ee,G.value]]),U[31]||(U[31]=e("label",{for:"totalAdBreakDurationTime"},"Total Ad Breaks",-1))])]),e("div",Fv,[e("div",zv,[q(e("input",{"onUpdate:modelValue":U[8]||(U[8]=O=>g.value=O),type:"text",class:"form-control-plaintext",id:"totalProgramDuration",readonly:""},null,512),[[ee,g.value]]),U[32]||(U[32]=e("label",{for:"totalProgramDuration"},"Total Program Duration",-1))])])])])])])])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},jv=["disabled"],Yv={class:"container1"},Kv={class:"row"},Wv={class:"col-12 col-lg-5"},Qv={class:"col"},Jv={class:"form-floating mb-2"},Zv=["value"],Xv={key:0,class:"d-block invalid-feedback"},eg={class:"col"},tg={class:"form-floating"},sg={id:"selectedVodSource",class:"form-control",placeholder:"Title"},og={class:"col-12 col-lg-7"},ag={class:"col"},lg={class:"form-floating mb-2"},ng={key:0,class:"d-block invalid-feedback"},rg={class:"row row-cols- row-cols-sm-3"},ig={class:"col"},dg={class:"form-floating mb-2"},ug={key:0},cg={key:1},mg={key:2},fg={key:3,class:"d-block invalid-feedback"},pg={class:"col"},vg={class:"form-floating"},gg={key:0},bg={key:1},yg={key:2,class:"d-block invalid-feedback"},$g={class:"col"},hg={class:"form-floating mb-2"},wg={key:0,class:"mt-2"},_g={class:"table-responsive border mt-1"},kg={class:"table table-sm mb-0 align-middle"},Sg={class:"table-group-divider"},Tg=["onUpdate:modelValue","onChange"],Ig={key:0},Mg=["onUpdate:modelValue","onChange"],xg={key:0},Cg=["onClick"],Vg={key:1},Ag={class:"text-start"},Og={class:"d-flex flex-row justify-content-end align-items-baseline"},Pg=["onClick"],Ug=["onClick"],Lg={class:"col mt-2"},Hg={class:"row row-cols-1 row-cols-sm-2"},Dg={class:"col"},Eg={class:"form-floating mb-2"},qg={class:"col"},Bg={class:"form-floating mb-2"},Ng={__name:"edit",props:{id:{type:String,required:!0},urlView:{type:String,default:"/program-templates/view"},urlMain:{type:String,default:"/program-templates"}},setup(r){const{appTitle:b,pageTitle:T,busy:M,infoMessage:k,warningMessage:H,errorMessage:V,router:Q,axios:j,utils:S,toasts:z,close:ae,closeWithReturnUrl:N,security:L}=he({appTitle:"Arcadian-FAST",pageTitle:"Edit Program Template"}),n=r,I=ye({lookups:{sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[]},selected:{sourceLocation:null,vodSource:null},startOffsetTime:"00:00:00",endOffsetTime:"00:00:00",item:{name:null,sourceLocationId:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]}}),$=ge(!0),K={item:{name:{required:le.withMessage("Name is required.",re),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:le.withMessage("sourceLocationId is required.",re),$autoDirty:!0,$lazy:!0},vodSourceId:{required:le.withMessage("vodSourceId is required.",re),$autoDirty:!0,$lazy:!0},startOffsetMillis:{required:le.withMessage("startOffsetMillis is required.",re),$autoDirty:!0,$lazy:!0},endOffsetMillis:{required:le.withMessage("endOffsetMillis is required.",re),$autoDirty:!0,$lazy:!0}}},J=Te(K,I),u=xe(()=>{if(I.startOffsetTime&&I.startOffsetTime!=="00:00:00"&&S.isValidTime(I.startOffsetTime)){const se=S.moment,O=se().startOf("day"),ue=se(I.startOffsetTime,"hh:mm:ss").diff(O);return I.item.startOffsetMillis=ue.valueOf(),I.item.startOffsetMillis}return 0}),p=xe(()=>{if(I.endOffsetTime&&I.endOffsetTime!=="00:00:00"&&S.isValidTime(I.endOffsetTime)){const se=S.moment,O=se().startOf("day"),ue=se(I.endOffsetTime,"hh:mm:ss").diff(O);return I.item.endOffsetMillis=ue.valueOf(),I.item.endOffsetMillis}return 0}),W=xe(()=>I.item.endOffsetMillis-I.item.startOffsetMillis),g=xe(()=>S.moment.utc(W.value).format("HH:mm:ss")),G=xe(()=>{const se=I.item.adBreaks;return se&&se.length>0?se.reduce((me,ue,de)=>me+ue.durationInMillis,0):0}),y=xe(()=>{const se=W.value+G.value;return S.moment.utc(se).format("HH:mm:ss")}),f=xe(()=>S.moment.utc(G.value).format("HH:mm:ss"));fe(async()=>{await m()});const m=async()=>{$.value=!0,await i(),await d(),await l()},i=async()=>{try{const se=`/api/v1/programtemplates/${n.id}/`;await j.get(se).then(O=>{I.item=O.data}),I.startOffsetTime=S.moment.utc(I.item.startOffsetMillis).format("HH:mm:ss"),I.endOffsetTime=S.moment.utc(I.item.endOffsetMillis).format("HH:mm:ss"),I.item.adBreaks.forEach(O=>{O.offsetTime=S.moment.utc(O.offsetMillis).format("HH:mm:ss"),O.durationTime=S.moment.utc(O.durationInMillis).format("HH:mm:ss")})}catch(se){V.value=S.getErrorMessageAsHtml(se),window.scrollTo(0,0)}finally{}},d=async()=>{try{const se=`/api/v1/vodSources/${I.item.vodSourceId}/`;await j.get(se).then(O=>{I.selected.vodSource=O.data}),X()}catch(se){V.value=S.getErrorMessageAsHtml(se),window.scrollTo(0,0)}finally{}},l=async()=>{await a()},a=async()=>{try{await j.get("/api/v1/sourcelocations/lookup/").then(O=>{I.lookups.sourceLocations=O.data}),I.item.sourceLocationId&&await h(I.item.sourceLocationId)}catch(se){V.value=S.getErrorMessageAsHtml(se),window.scrollTo(0,0)}finally{}},h=async se=>{try{const O=`/api/v1/vodSources/lookup/source-location/${se}/?type=3`;if(await j.get(O).then(me=>{I.lookups.vodSources=me.data}),$.value){$.value=!1;return}I.selected.vodSource=null,_()}catch(O){V.value=S.getErrorMessageAsHtml(O),window.scrollTo(0,0)}finally{}},_=async()=>{const se=I.selected.vodSource;if(se){debugger;I.item.vodSourceId=se.vodSourceId,I.startOffsetTime=S.moment.utc(0).format("HH:mm:ss"),I.endOffsetTime=S.moment.utc(se.video.durationInMillis).format("HH:mm:ss"),X()}else I.selected.vodSource=null,I.item.vodSourceId=null,I.startOffsetTime=null,I.endOffsetTime=null,I.hls&&(I.hls.stopLoad(),I.hls.destroy())},v=()=>{const se={offsetTime:"00:00:00",offsetMillis:0,durationTime:"00:00:00",durationInMillis:0,sourceLocationId:null,vodSourceId:null};I.item.adBreaks.push(se)},B=se=>{I.item.adBreaks.splice(se,1)},P=se=>{const O=S.moment,me=O().startOf("day"),ue=me.format("YYYY-MM-DD ")+se.offsetTime,ce=O(ue).subtract(me);se.offsetMillis=ce.valueOf()},w=se=>{const O=S.moment,me=O().startOf("day"),ue=me.format("YYYY-MM-DD ")+se.durationTime,ce=O(ue).subtract(me);se.durationInMillis=ce.valueOf()},D=async()=>{const se=I;if(M.value)return;if(!await J.value.$validate()){window.scrollTo(0,0);return}try{M.value=!0,V.value="";const me=S.clone(se.item);debugger;const ue=me.adBreaks.filter(de=>de.durationInMillis>0).map(de=>{debugger;return{offsetMillis:de.offsetMillis,durationInMillis:de.durationInMillis,vodSourceId:de.vodSource?de.vodSource.vodSourceId:null}});me.adBreaks=ue,await j.put("/api/v1/programtemplates/",me).then(de=>{z.success("Edit Program Template","Program template edit.",{onClose:async()=>{const ce=`${n.urlView}/${n.id}`;await Q.push(ce)}})})}catch(me){V.value=S.getErrorMessageAsHtml(me),window.scrollTo(0,0)}finally{M.value=!1}},X=()=>{if(Hls.isSupported()){I.hls&&(I.hls.stopLoad(),I.hls.destroy());var se=document.getElementById("video-edit-program-template");const me=I.selected.vodSource.video.formats.find(de=>de.formatName==="HLS"),ue=me.serverUrl+me.path;I.hls=S.createHlsStream(se,ue)}},U=async se=>{try{let O=`/api/v1/vodSources/${se}/blank-frames`;const me=await j.get(O).then(ue=>ue.data);I.item.adBreaks=[],me&&me.length>0&&(I.item.adBreaks=me.map(ue=>{const de=(ue.endInMillis-ue.startInMillis)/2+ue.startInMillis;return{offsetTime:S.moment.utc(de).format("HH:mm:ss"),offsetMillis:de,durationTime:"00:00:00",durationInMillis:0,sourceLocationId:null,vodSourceId:null}}))}catch(O){V.value=S.getErrorMessageAsHtml(O),window.scrollTo(0,0)}finally{}},ne=async()=>{const se=Ae(Re,{sourceLocationId:I.sourceLocationId,genreId:0,categoryId:3,withArn:!0},{chore:!0,keepInitial:!1}),{data:O,isCanceled:me}=await se.reveal();if(se.closeAll(),!me&&O){const ue=O;I.selected.vodSource=ue,I.item.vodSourceId=ue.vodSourceId,_(),await U(ue.vodSourceId)}},Z=async se=>{const O=Ae(Re,{sourceLocationId:null,genreId:0,categoryId:1,durationInMillis:se.durationInMillis,withArn:!0},{chore:!0,keepInitial:!1}),{data:me,isCanceled:ue}=await O.reveal();O.closeAll(),!ue&&me&&(se.vodSource=me)};return(se,O)=>{const me=oe("PageHeader"),ue=oe("PageBody");return t(),be($e,null,{default:R(()=>[e("div",null,[F(me,{"page-icon":"fas fa-fw fa-file-video",pageTitle:o(T)},{default:R(()=>[e("button",{disabled:o(J).$dirty&&o(J).$invalid,onClick:O[0]||(O[0]=de=>D()),class:"btn btn-primary"},O[11]||(O[11]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,jv),e("button",{onClick:O[1]||(O[1]=de=>m()),class:"btn btn-secondary ms-2"},O[12]||(O[12]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:O[2]||(O[2]=de=>o(N)(n.urlMain)),class:"btn btn-secondary ms-1"},O[13]||(O[13]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),F(ue,{errorMessage:o(V),vuelidate:o(J)},{default:R(()=>[e("div",null,[e("div",Yv,[e("div",Kv,[e("div",Wv,[e("div",Qv,[e("div",Jv,[q(e("select",{"onUpdate:modelValue":O[3]||(O[3]=de=>I.item.sourceLocationId=de),onChange:O[4]||(O[4]=de=>h(I.item.sourceLocationId)),class:"form-select",id:"sourceLocationId"},[(t(!0),s(A,null,E(I.lookups.sourceLocations,de=>(t(),s("option",{value:de.id},c(de.name),9,Zv))),256))],544),[[pe,I.item.sourceLocationId]]),O[14]||(O[14]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o(J).item.sourceLocationId.$error?(t(),s("div",Xv,[(t(!0),s(A,null,E(o(J).item.sourceLocationId.$errors,de=>(t(),s("div",{key:de.$uid},c(de.$message),1))),128))])):x("",!0)])]),e("div",eg,[e("div",{onClick:ne,class:"input-group mb-2"},[e("div",tg,[e("div",sg,[I.selected.vodSource?(t(),s(A,{key:0},[Y(" ["+c(o(S).moment.utc(I.selected.vodSource.video.durationInMillis).format("HH:mm:ss"))+"] - "+c(I.selected.vodSource.name),1)],64)):x("",!0)]),O[15]||(O[15]=e("label",{for:"selectedVodSource",class:""},"VOD Source",-1))]),O[16]||(O[16]=e("button",{class:"btn btn-primary",type:"button"},[e("i",{class:"fa-solid fa-filter"})],-1))])]),O[17]||(O[17]=e("div",{class:"col"},[e("div",{class:"rounded1"},[e("video",{id:"video-edit-program-template",controls:"",class:"card-img-top object-fit-contain border"})])],-1))]),e("div",og,[e("div",ag,[e("div",lg,[q(e("input",{"onUpdate:modelValue":O[5]||(O[5]=de=>I.item.name=de),id:"name",class:te([o(S).getValidFeedbackCss(I.item.name),"form-control"]),placeholder:"Name"},null,2),[[ee,I.item.name]]),O[18]||(O[18]=e("label",{for:"name",class:""},"Name",-1)),o(J).item.name.$error?(t(),s("div",ng,[(t(!0),s(A,null,E(o(J).item.name.$errors,de=>(t(),s("div",{key:de.$uid},' d" '+c(de.$message),1))),128))])):x("",!0)])]),e("div",rg,[e("div",ig,[e("div",dg,[q(e("input",{"onUpdate:modelValue":O[6]||(O[6]=de=>I.startOffsetTime=de),type:"time",step:"1",id:"startOffsetTime",class:te([o(S).getValidFeedbackCss(I.startOffsetTime),"form-control"])},null,2),[[ee,I.startOffsetTime]]),O[19]||(O[19]=e("label",{for:"startOffsetTime",class:""},"Start OffSet Time",-1))]),u.value>0&&u.value<3e4?(t(),s("div",ug,O[20]||(O[20]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset must be at least 30 seconds ",-1)]))):x("",!0),u.value>p.value&&p.value>0?(t(),s("div",cg,O[21]||(O[21]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start offset time Exceeds End offset time ",-1)]))):x("",!0),I.selected.vodSource&&u.value>=I.selected.vodSource.durationInMillis?(t(),s("div",mg,O[22]||(O[22]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset Time Exceeds VOD Source Duration ",-1)]))):x("",!0),o(J).item.startOffsetMillis.$error?(t(),s("div",fg,[(t(!0),s(A,null,E(o(J).item.startOffsetMillis.$errors,de=>(t(),s("div",{key:de.$uid},c(de.$message),1))),128))])):x("",!0)]),e("div",pg,[e("div",vg,[q(e("input",{"onUpdate:modelValue":O[7]||(O[7]=de=>I.endOffsetTime=de),type:"time",step:"1",id:"endOffsetTime",class:te([o(S).getValidFeedbackCss(I.endOffsetTime),"form-control"])},null,2),[[ee,I.endOffsetTime]]),O[23]||(O[23]=e("label",{for:"endOffsetTime",class:""},"End OffSet Time",-1))]),p.value>0&&p.value<3e4?(t(),s("div",gg,O[24]||(O[24]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset must be at least 30 seconds ",-1)]))):x("",!0),I.selected.vodSource&&p.value>I.selected.vodSource.durationInMillis?(t(),s("div",bg,O[25]||(O[25]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset Time Exceeds VOD Source Duration ",-1)]))):x("",!0),o(J).item.endOffsetMillis.$error?(t(),s("div",yg,[(t(!0),s(A,null,E(o(J).item.endOffsetMillis.$errors,de=>(t(),s("div",{key:de.$uid},c(de.$message),1))),128))])):x("",!0)]),e("div",$g,[e("div",hg,[q(e("input",{"onUpdate:modelValue":O[8]||(O[8]=de=>g.value=de),type:"text",class:"form-control-plaintext",id:"durationTime",readonly:""},null,512),[[ee,g.value]]),O[26]||(O[26]=e("label",{for:"durationTime"},"Clip Duration",-1))])])]),I.selected.vodSource?(t(),s("div",wg,[e("div",{class:"d-flex flex-row justify-content-between align-items-center"},[O[28]||(O[28]=e("b",null," Ad Break ",-1)),e("div",null,[e("button",{onClick:v,class:"btn btn-outline-primary btn-sm"},O[27]||(O[27]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))])]),e("div",_g,[e("table",kg,[O[33]||(O[33]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Offset Time"),e("th",null,"Duration Time"),e("th",null,"VOD Source"),e("th")])],-1)),e("tbody",Sg,[(t(!0),s(A,null,E(I.item.adBreaks,(de,ce)=>(t(),s("tr",null,[e("td",null,c(ce+1),1),e("td",null,[q(e("input",{"onUpdate:modelValue":C=>de.offsetTime=C,onChange:C=>P(de),type:"time",step:"1",class:"form-control"},null,40,Tg),[[ee,de.offsetTime]]),de.offsetMillis>=I.selected.vodSource.durationInMillis?(t(),s("div",Ig,O[29]||(O[29]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Ad Break Offset Time Exceeds VOD Source Duration ",-1)]))):x("",!0)]),e("td",null,[q(e("input",{"onUpdate:modelValue":C=>de.durationTime=C,onChange:C=>w(de),type:"time",step:"1",class:"form-control"},null,40,Mg),[[ee,de.durationTime]])]),e("td",null,[de.vodSource?(t(),s("span",xg,[e("button",{onClick:C=>de.vodSource=null,class:"btn btn-outline-warning btn-sm me-1"},O[30]||(O[30]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]),8,Cg),Y(c(de.vodSource.name),1)])):x("",!0),de.durationInMillis<=0?(t(),s("span",Vg," Specify the Ad Break Duration Time to configure the VOD to assign ")):x("",!0)]),e("td",Ag,[e("div",Og,[de.durationInMillis>0?(t(),s("button",{key:0,onClick:C=>Z(de),class:"btn btn-outline-info btn-sm"},O[31]||(O[31]=[e("span",{class:"fas fa-fw fa-cog"},null,-1)]),8,Pg)):x("",!0),e("button",{onClick:C=>B(ce),class:"btn btn-outline-warning btn-sm ms-2"},O[32]||(O[32]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,Ug)])])]))),256))])]),O[34]||(O[34]=e("div",{class:"small m-2 text-end"},[e("div",null,[e("span",{class:"fas fa-fw fa-circle-info"}),Y(" Vod source can also be defined during creation of Program Instance. Allowed VODs will be based on the channel's output type (HLS or DASH) and duration specified on this ad break. ")])],-1))])])):x("",!0),e("div",Lg,[O[37]||(O[37]=e("b",null," Duration ",-1)),e("div",Hg,[e("div",Dg,[e("div",Eg,[q(e("input",{"onUpdate:modelValue":O[9]||(O[9]=de=>f.value=de),type:"text",class:"form-control-plaintext",id:"totalAdBreakDurationTime",readonly:""},null,512),[[ee,f.value]]),O[35]||(O[35]=e("label",{for:"totalAdBreakDurationTime"},"Total Ad Breaks",-1))])]),e("div",qg,[e("div",Bg,[q(e("input",{"onUpdate:modelValue":O[10]||(O[10]=de=>y.value=de),type:"text",class:"form-control-plaintext",id:"totalProgramDuration",readonly:""},null,512),[[ee,y.value]]),O[36]||(O[36]=e("label",{for:"totalProgramDuration"},"Total Program Duration",-1))])])])])])])])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},Rg={class:"ms-1"},Fg={class:"input-group"},zg={class:"table-responsive border shadow-sm"},Gg={class:"table table-hover mb-0"},jg=["textContent"],Yg={class:"d-flex flex-column flex-lg-row justify-content-start"},Kg={class:""},Wg={class:"mb-11"},Qg=["src"],Jg={class:"ms-lg-2"},Zg={key:0,class:"fas fa-fw fa-check-circle text-success"},Xg={class:"text-wrap text-truncate",style:{width:"20px !important"}},e1={class:"badge bg-primary me-1"},t1={key:0},s1={class:"badge bg-info me-1"},o1={class:"text-end me-0 me-sm-5"},a1={class:"text-center"},l1={class:"mt-3 mt-lg-2"},n1="/api/v1/programTemplates/search",r1={__name:"index",props:{urlAdd:{type:String,default:"/program-templates/add"},urlView:{type:String,default:"/program-templates/view"},urlViewSourceLocation:{type:String,default:"/source-locations/view"},urlViewVodSource:{type:String,default:"/vod-sources/view"}},setup(r){Ce("$config");const T=we().user,{appTitle:M,pageTitle:k,busy:H,infoMessage:V,warningMessage:Q,errorMessage:j,router:S,axios:z,utils:ae,toasts:N,close:L,generateReturnUrl:n,security:I,filter:$,initializeFilter:K,getQuery:J,saveQuery:u,search:p,getRowNumber:W,setSelected:g,isSelected:G}=De({appTitle:"Arcadian-FAST",pageTitle:"Program Templates",cacheKey:`${T==null?void 0:T.userId}/program-templates/search`,baseUrl:n1,filter:{updateUrl:!0}});return fe(async()=>{K(),await p()}),(y,f)=>{const m=oe("router-link"),i=oe("PageHeader"),d=oe("m-pagination"),l=oe("PageBody");return t(),be($e,null,{default:R(()=>[e("div",null,[F(i,{"page-icon":"fas fa-fw fa-file-video",pageTitle:o(k)},{default:R(()=>[F(m,{to:r.urlAdd,class:"btn btn-primary"},{default:R(()=>f[3]||(f[3]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",Rg,[e("div",Fg,[q(e("input",{"onUpdate:modelValue":f[0]||(f[0]=a=>o($).query.criteria=a),onKeyup:f[1]||(f[1]=He(a=>o(p)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria...","aria-label":"Enter criteria...","aria-describedby":"button-addon2"},null,544),[[ee,o($).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:f[2]||(f[2]=a=>o(p)(1))},f[4]||(f[4]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),F(l,{errorMessage:o(j)},{default:R(()=>[e("div",zg,[e("table",Gg,[f[5]||(f[5]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Name"),e("th",{class:"text-center"},"Duration"),e("th",{class:"text-center"},"# Ad Breaks"),e("th",null,"Source")])],-1)),q(F(Se,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(A,null,E(o($).items,(a,h)=>(t(),s("tr",{key:a.programTemplateId},[e("td",{textContent:c(o(W)(h)),class:"text-center"},null,8,jg),e("td",null,[e("div",Yg,[e("div",Kg,[a.vodSource.video.thumbnails.length>0?(t(!0),s(A,{key:0},E(a.vodSource.video.thumbnails,_=>(t(),s("div",Wg,[e("img",{src:_.url,class:"img-fuild border",width:"128"},null,8,Qg)]))),256)):x("",!0)]),e("div",Jg,[F(m,{to:`${r.urlView}/${a.programTemplateId}`,class:"d-inline-block text-wrap link-offset-2"},{default:R(()=>[a.arn?(t(),s("span",Zg)):x("",!0),e("span",Xg,c(a.name),1)]),_:2},1032,["to"]),e("div",null,[(t(!0),s(A,null,E(a.vodSource.video.categories,_=>(t(),s("div",null,[e("span",e1,c(_.categoryName),1)]))),256)),a.vodSource.video.genres.length>0?(t(),s("div",t1,[(t(!0),s(A,null,E(a.vodSource.video.genres,_=>(t(),s("span",s1,c(_.genreName),1))),256))])):x("",!0)])])])]),e("td",o1,c(o(ae).moment.utc(a.totalProgramTemplateDurationInMillis).format("HH:mm:ss")),1),e("td",a1,c(a.adBreaks.length),1),e("td",null,[e("div",null,[F(m,{to:`${r.urlViewSourceLocation}/${a.sourceLocationId}/${o(n)()}`,class:"link-offset-2"},{default:R(()=>[Y(c(a.sourceLocation.name),1)]),_:2},1032,["to"])]),e("div",l1,[F(m,{to:`${r.urlViewVodSource}/${a.vodSourceId}/${o(n)()}`,class:"link-offset-2"},{default:R(()=>[Y(c(a.vodSource.name),1)]),_:2},1032,["to"])])])]))),128))]),_:1},512),[[ke,o($).items.length>0]])])]),F(d,{filter:o($),search:o(p),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},i1={key:0},d1={class:"nav nav-tabs",id:"myTab",role:"tablist"},u1={class:"nav-item",role:"presentation"},c1={class:"nav-item",role:"presentation"},m1={class:"nav-item d-none",role:"presentation"},f1={class:"tab-content",id:"myTabContent"},p1={class:""},v1={class:""},g1={class:"row row-cols-1 row-cols-lg-2"},b1={class:"col"},y1={class:"col"},$1={class:"form-floating mb-2"},h1={id:"sourceLocation",class:"form-control-plaintext card"},w1={class:"col"},_1={class:"form-floating mb-2"},k1={id:"vodSource",class:"form-control-plaintext card"},S1={class:"col"},T1={class:"col"},I1={class:"form-floating mb-2"},M1={class:"row row-cols-1 row-cols-sm-3"},x1={class:"col"},C1={class:"form-floating mb-2"},V1={class:"col"},A1={class:"form-floating mb-2"},O1={class:"col"},P1={class:"form-floating mb-2"},U1={class:"row row-cols-1 row-cols-sm-2"},L1={class:"col"},H1={class:"form-floating mb-2"},D1={class:"col"},E1={class:"form-floating mb-2"},q1={class:""},B1={class:"table-responsive border"},N1={class:"table table-hover mb-0"},R1={class:"text-center"},F1={key:0},z1={class:"mt-2"},G1={__name:"view",props:{id:{type:String,required:!0},urlMain:{type:String,default:"/program-templates"},urlEdit:{type:String,default:"/program-templates/edit"},urlViewSourceLocation:{type:String,default:"/source-locations/view"},urlViewVodSource:{type:String,default:"/vod-sources/view"},urlViewVideo:{type:String,default:"/videos/view"},urlViewChannel:{type:String,default:"/channels/view"}},setup(r){const b=r,{appTitle:T,pageTitle:M,busy:k,isDirty:H,validations:V,infoMessage:Q,warningMessage:j,errorMessage:S,router:z,axios:ae,utils:N,toasts:L,close:n,closeWithReturnUrl:I,generateReturnUrl:$,security:K}=he({appTitle:"Arcadian-FAST",pageTitle:"View Program Template"});Ce("$config");const J=we();J.user;const u=ye({user:J.user,item:null,hls:null}),p=ge();fe(async()=>{await y(),p.value=N.getPageTab("programTemplate")||"information-tab"});const W=i=>{N.setPageTab("programTemplate",i),p.value=i},g=i=>i!==p.value?"":"active",G=i=>i!==p.value?"":"show active",y=async()=>{const i=u;if(!k.value)try{k.value=!0,S.value="",u.item=null;const d=`/api/v1/programTemplates/${b.id}/`;await ae.get(d).then(l=>{i.item=l.data;const a=i.item;a.startOffsetTime=N.moment.utc(a.startOffsetMillis).format("HH:mm:ss"),a.endOffsetTime=N.moment.utc(a.endOffsetMillis).format("HH:mm:ss"),a.durationTime=N.moment.utc(a.durationInMillis).format("HH:mm:ss"),a.adBreaksDurationTime=N.moment.utc(a.adBreaksDurationInMillis).format("HH:mm:ss"),a.totalProgramTemplateDurationTime=N.moment.utc(a.totalProgramTemplateDurationInMillis).format("HH:mm:ss");const h=a.vodSource.video,_=h.durationInMillis;h.durationInMillis=N.moment.utc(_).format("HH:mm:ss")}),u.item.vodSource&&await m(u.item.vodSourceId)}catch(d){S.value=N.getErrorMessageAsHtml(d),window.scrollTo(0,0)}finally{k.value=!1}},f=async()=>{await y()},m=async i=>{try{let d=`/api/v1/vodSources/${i}/hls`;const l=await ae.get(d).then(h=>h.data);u.hls&&u.hls.destroy();const a=document.getElementById("video-view-program-template");u.hls=N.createHlsStream(a,l,"Previewing VOD.")}catch(d){S.value=N.getErrorMessageAsHtml(d),window.scrollTo(0,0)}finally{}};return(i,d)=>{const l=oe("router-link"),a=oe("PageHeader"),h=oe("PageBody");return t(),be($e,null,{default:R(()=>[e("div",null,[F(a,{"page-icon":"fas fa-fw fa-file-video",pageTitle:o(M)},{default:R(()=>[F(l,{to:`${r.urlEdit}/${r.id}/${o($)()}`,class:"ms-2 btn btn-primary"},{default:R(()=>d[11]||(d[11]=[e("span",{class:"fas fa-fw fa-edit"},null,-1)])),_:1},8,["to"]),e("button",{onClick:d[0]||(d[0]=_=>f()),class:"ms-2 btn btn-secondary"},d[12]||(d[12]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:d[1]||(d[1]=_=>o(I)(b.urlMain)),class:"btn btn-secondary ms-1"},d[13]||(d[13]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),F(h,{errorMessage:o(S)},{default:R(()=>[u.item?(t(),s("div",i1,[e("div",null,[e("ul",d1,[e("li",u1,[e("button",{onClick:d[2]||(d[2]=_=>W("information-tab")),class:te([g("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"}," Information ",2)]),e("li",c1,[e("button",{onClick:d[3]||(d[3]=_=>W("adBreaks-tab")),class:te([g("adBreaks-tab"),"nav-link"]),id:"adBreaks-tab","data-bs-toggle":"tab","data-bs-target":"#adBreaks",type:"button",role:"tab","aria-controls":"adBreaks","aria-selected":"false"}," Ad Breaks ",2)]),e("li",m1,[e("button",{onClick:d[4]||(d[4]=_=>W("programs-tab")),class:te([g("programs-tab"),"nav-link"]),id:"programs-tab","data-bs-toggle":"tab","data-bs-target":"#programs",type:"button",role:"tab","aria-controls":"programs","aria-selected":"false"}," Programs ",2)])]),e("div",f1,[e("div",{class:te([G("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",p1,[e("div",v1,[e("div",g1,[e("div",b1,[e("div",y1,[e("div",$1,[e("div",h1,[F(l,{to:`${r.urlViewSourceLocation}/${u.item.sourceLocationId}/${o($)()}`,class:"link-offset-2"},{default:R(()=>[Y(c(u.item.sourceLocation.name),1)]),_:1},8,["to"])]),d[14]||(d[14]=e("label",{for:"sourceLocation",class:""},"Source Location",-1))])]),e("div",w1,[e("div",_1,[e("div",k1,[F(l,{to:`${r.urlViewVodSource}/${u.item.vodSourceId}/${o($)()}`,class:"link-offset-2"},{default:R(()=>[Y(c(u.item.vodSource.name),1)]),_:1},8,["to"])]),d[15]||(d[15]=e("label",{for:"vodSource",class:""},"VOD Name",-1))])]),d[16]||(d[16]=e("div",{class:"col"},[e("div",{class:"rounded1"},[e("video",{id:"video-view-program-template",controls:"",class:"card-img-top object-fit-contain border"})])],-1))]),e("div",S1,[e("div",T1,[e("div",I1,[q(e("input",{"onUpdate:modelValue":d[5]||(d[5]=_=>u.item.name=_),type:"text",class:"form-control-plaintext card",id:"name"},null,512),[[ee,u.item.name]]),d[17]||(d[17]=e("label",{for:"name",class:""},"Name",-1))])]),e("div",M1,[e("div",x1,[e("div",C1,[q(e("input",{"onUpdate:modelValue":d[6]||(d[6]=_=>u.item.startOffsetTime=_),type:"text",class:"form-control-plaintext card",id:"startOffsetTime"},null,512),[[ee,u.item.startOffsetTime]]),d[18]||(d[18]=e("label",{for:"startOffsetTime",class:""},"Start Offset",-1))])]),e("div",V1,[e("div",A1,[q(e("input",{"onUpdate:modelValue":d[7]||(d[7]=_=>u.item.endOffsetTime=_),type:"text",class:"form-control-plaintext card",id:"endOffsetTime"},null,512),[[ee,u.item.endOffsetTime]]),d[19]||(d[19]=e("label",{for:"endOffsetTime",class:""},"End Offset",-1))])]),e("div",O1,[e("div",P1,[q(e("input",{"onUpdate:modelValue":d[8]||(d[8]=_=>u.item.durationTime=_),type:"text",class:"form-control-plaintext card",id:"durationTime"},null,512),[[ee,u.item.durationTime]]),d[20]||(d[20]=e("label",{for:"durationTime",class:""},"Clip Duration",-1))])])]),e("div",U1,[e("div",L1,[e("div",H1,[q(e("input",{"onUpdate:modelValue":d[9]||(d[9]=_=>u.item.adBreaksDurationTime=_),type:"text",class:"form-control-plaintext card",id:"adBreaksDurationTime"},null,512),[[ee,u.item.adBreaksDurationTime]]),d[21]||(d[21]=e("label",{for:"adBreaksDurationTime",class:""},"Total Ad Breaks",-1))])]),e("div",D1,[e("div",E1,[q(e("input",{"onUpdate:modelValue":d[10]||(d[10]=_=>u.item.totalProgramTemplateDurationTime=_),type:"text",class:"form-control-plaintext card",id:"totalProgramTemplateDurationTime"},null,512),[[ee,u.item.totalProgramTemplateDurationTime]]),d[22]||(d[22]=e("label",{for:"totalProgramTemplateDurationTime",class:""},"Total Program Duration",-1))])])])])])])])],2),e("div",{class:te([G("adBreaks-tab"),"tab-pane fade"]),id:"adBreaks",role:"tabpanel","aria-labelledby":"adBreaks-tab"},[e("div",q1,[e("div",B1,[e("table",N1,[d[23]||(d[23]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Offset"),e("th",null,"Duration"),e("th",null,"Vod Source")])],-1)),q(F(Se,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(A,null,E(u.item.adBreaks,(_,v)=>(t(),s("tr",{key:_.programTemplateAdBreakId},[e("td",R1,c(v+1),1),e("td",null,c(o(N).moment.utc(_.offsetMillis).format("HH:mm:ss")),1),e("td",null,c(o(N).moment.utc(_.durationInMillis).format("HH:mm:ss")),1),e("td",null,[_.vodSource?(t(),s("span",F1,[F(l,{to:`${r.urlViewVodSource}/${_.vodSourceId}/${o($)()}`,class:"link-offset-2"},{default:R(()=>[Y(c(_.vodSource.name),1)]),_:2},1032,["to"])])):x("",!0)])]))),128))]),_:1},512),[[ke,u.item.adBreaks.length>0]])])])])],2),e("div",{class:te([G("programs-tab"),"tab-pane fade"]),id:"programs",role:"tabpanel","aria-labelledby":"programs-tab"},[e("div",z1,[e("pre",null,c(u.item.programs),1)])],2)])])])):x("",!0)]),_:1},8,["errorMessage"])])]),_:1})}}},j1=["disabled"],Y1={class:"row row-cols-1 row-cols-lg-2"},K1={class:"col"},W1={class:""},Q1={class:"row row-cols-1 row-cols-md-3"},J1={class:"col"},Z1={class:"form-floating mb-2"},X1={key:0,class:"d-block invalid-feedback"},eb={class:"col"},tb={class:"form-floating mb-2"},sb={key:0,class:"d-block invalid-feedback"},ob={class:"col"},ab={class:"form-floating mb-2"},lb=["disabled"],nb={key:0,class:"d-block invalid-feedback"},rb={class:"col"},ib={class:"col"},db={class:"form-floating mb-2"},ub=["value"],cb={key:0,class:"d-block invalid-feedback"},mb={key:0,class:"w-100 text-center"},fb={class:"mx-auto"},pb=["src"],vb={class:"col"},gb={class:""},bb={class:"col"},yb={class:"form-floating mb-2"},$b=["value"],hb={key:0,class:"d-block invalid-feedback"},wb={class:"col"},_b={class:"input-group mb-2"},kb={class:"form-floating"},Sb={__name:"add",props:{urlView:{type:String,default:"/channels/view"},urlMain:{type:String,default:"/channels"}},setup(r){const{appTitle:b,pageTitle:T,busy:M,infoMessage:k,warningMessage:H,errorMessage:V,router:Q,axios:j,utils:S,toasts:z,close:ae,security:N}=he({appTitle:"Arcadian-FAST",pageTitle:"Add Channel"}),L=r,n=ye({lookups:{sourceLocations:[],vodSources:[],logos:[]},selected:{vodSource:null},item:{name:"",logoUrl:null,tier:"STANDARD",playbackMode:"LINEAR",fillerSlateSourceLocationId:null,fillerSlateVodSourceId:null,policy:null},hls:null});debugger;n.lookups.logos=[{id:"Viva | Batang 90s",url:"https://d1qfpvemzhsbpm.cloudfront.net/images/P00203_KA_MAIN_HORIZ_LM_TGIS%20THE%20MOVIE.480.jpg"},{id:"Viva | Kids & Family",url:"https://d1qfpvemzhsbpm.cloudfront.net/images/P00219_KA_MAIN_HORIZ_LM_ANG%20TANGING%20INA.480.jpg"},{id:"Viva | Horror Movie Marathon",url:"https://d1qfpvemzhsbpm.cloudfront.net/images/P00408_KA_MAIN_HORIZ_FM_WINNIE%20THE%20POOH%20BLOOD%20AND%20HONEY.480.jpg"},{id:"Viva | BitterSweet Stories",url:"https://d1qfpvemzhsbpm.cloudfront.net/images/P00074_KA_MAIN_HORIZ_LM_CAMP%20SAWI.480.jpg"},{id:"Viva | Comedy",url:"https://d1qfpvemzhsbpm.cloudfront.net/images/P00207_KA_MAIN_HORIZ_LM_THE%20GIFTED.480.jpg"},{id:"Viva | Romance",url:"https://d1qfpvemzhsbpm.cloudfront.net/images/P00697_KA_MAIN_HORIZ_LM_CLOSE%20TO%20YOU.480.jpg"},{id:"Viva | ROMCOM",url:"https://d1qfpvemzhsbpm.cloudfront.net/images/P00220_KA_MAIN_HORIZ_LM_KASAL,%20KASALI,%20KASALO.480.jpg"}];const I={item:{name:{title:le.withMessage("Name is required.",re),$autoDirty:!0,$lazy:!0},logoUrl:{title:le.withMessage("Logo is required.",re),$autoDirty:!0,$lazy:!0},tier:{title:le.withMessage("Tier is required.",re),$autoDirty:!0,$lazy:!0},playbackMode:{title:le.withMessage("PlaybackMode is required.",re),$autoDirty:!0,$lazy:!0},fillerSlateSourceLocationId:{title:le.withMessage("Filler Slate Source Location is required.",re),$autoDirty:!0,$lazy:!0},fillerSlateVodSourceId:{title:le.withMessage("Filler Slate Vod Source is required.",re),$autoDirty:!0,$lazy:!0},policy:{title:le.withMessage("Policy is required.",re),$autoDirty:!0,$lazy:!0}}},$=Te(I,n);fe(async()=>{await K()});const K=async()=>{try{await j.get("/api/v1/sourcelocations/lookup/").then(m=>{n.lookups.sourceLocations=m.data,n.lookups.sourceLocations.length===1&&(n.item.fillerSlateSourceLocationId=n.lookups.sourceLocations[0].id)}),n.item.fillerSlateSourceLocationId&&await u(n.item.fillerSlateSourceLocationId)}catch(f){V.value=S.getErrorMessageAsHtml(f),window.scrollTo(0,0)}finally{}},J=async()=>{n.item.fillerSlateVodSourceId=null,await u(n.item.fillerSlateSourceLocationId)},u=async f=>{try{let m=`/api/v1/vodSources/lookup/source-location/${f}/?category=2`;await j.get(m).then(i=>{n.lookups.vodSources=i.data})}catch(m){V.value=S.getErrorMessageAsHtml(m),window.scrollTo(0,0)}finally{}},p=()=>{if(n.item.name){const f=`{"Version":"2012-10-17","Statement": [{"Sid":"AllowAnonymous","Effect":"Allow","Principal":"*","Action":"mediatailor:GetManifest","Resource":"arn:aws:mediatailor:us-west-2:799350865909:channel/${n.item.name}"}]}`;n.item.policy=f}else n.item.policy=null},W=async()=>{const f=n;if(M.value)return;if(!await $.value.$validate()){window.scrollTo(0,0);return}try{M.value=!0,V.value="";const i=S.clone(f.item);await j.post("/api/v1/channels/",i).then(d=>{z.success("Add Channel","Channel added.",{onClose:async()=>{const l=`${L.urlView}/${d.data}`;await Q.push(l)}})})}catch(i){V.value=S.getErrorMessageAsHtml(i),window.scrollTo(0,0)}finally{M.value=!1}},g=()=>{n.item.playbackMode==="LOOP"&&n.item.tier!=="BASIC"&&(n.item.tier="BASIC")},G=async()=>{const f=Ae(Re,{sourceLocationId:n.item.sourceLocationId,genreId:0,categoryId:2,withArn:!0},{chore:!0,keepInitial:!1}),{data:m,isCanceled:i}=await f.reveal();if(f.closeAll(),!i&&m){const d=m;n.selected.vodSource=d,n.item.fillerSlateVodSourceId=d.vodSourceId,y()}},y=()=>{if(Hls.isSupported()){n.hls&&(n.hls.stopLoad(),n.hls.destroy());var f=document.getElementById("video-preview");const i=n.selected.vodSource.video.formats.find(l=>l.formatName==="HLS"),d=i.serverUrl+i.path;n.hls=S.createHlsStream(f,d)}};return(f,m)=>{const i=oe("router-link"),d=oe("PageHeader"),l=oe("PageBody");return t(),be($e,null,{default:R(()=>[e("div",null,[F(d,{"page-icon":"fas fa-fw fa-tv",pageTitle:o(T)},{default:R(()=>[e("button",{disabled:o($).$dirty&&o($).$invalid,onClick:m[0]||(m[0]=a=>W()),class:"btn btn-primary"},m[9]||(m[9]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,j1),F(i,{to:L.urlMain,class:"btn btn-secondary ms-2"},{default:R(()=>m[10]||(m[10]=[e("span",{class:"fas fa-fw fa-times"},null,-1)])),_:1},8,["to"])]),_:1},8,["pageTitle"]),F(l,{errorMessage:o(V),vuelidate:o($)},{default:R(()=>[e("div",Y1,[e("div",K1,[e("div",W1,[e("div",Q1,[e("div",J1,[e("div",Z1,[q(e("input",{"onUpdate:modelValue":m[1]||(m[1]=a=>n.item.name=a),onChange:m[2]||(m[2]=a=>p()),id:"name",class:te([o(S).getValidFeedbackCss(n.item.name),"form-control"]),placeholder:"name"},null,34),[[ee,n.item.name]]),m[11]||(m[11]=e("label",{for:"name",class:""},"Name",-1)),o($).item.name.$error?(t(),s("div",X1,[(t(!0),s(A,null,E(o($).item.name.$errors,a=>(t(),s("div",{key:a.$uid},c(a.$message),1))),128))])):x("",!0)])]),e("div",eb,[e("div",tb,[q(e("select",{"onUpdate:modelValue":m[3]||(m[3]=a=>n.item.playbackMode=a),onChange:m[4]||(m[4]=a=>g()),id:"playbackMode",class:"form-control",placeholder:"playbackMode"},m[12]||(m[12]=[e("option",{value:"LINEAR"},"LINEAR",-1),e("option",{value:"LOOP"},"LOOP",-1)]),544),[[pe,n.item.playbackMode]]),m[13]||(m[13]=e("label",{for:"playbackMode",class:""},"PlaybackMode",-1)),o($).item.playbackMode.$error?(t(),s("div",sb,[(t(!0),s(A,null,E(o($).item.playbackMode.$errors,a=>(t(),s("div",{key:a.$uid},c(a.$message),1))),128))])):x("",!0)])]),e("div",ob,[e("div",ab,[q(e("select",{"onUpdate:modelValue":m[5]||(m[5]=a=>n.item.tier=a),id:"tier",class:"form-control",placeholder:"Tier",disabled:n.item.playbackMode==="LOOP"},m[14]||(m[14]=[e("option",{value:"BASIC"},"BASIC",-1),e("option",{value:"STANDARD"},"STANDARD",-1)]),8,lb),[[pe,n.item.tier]]),m[15]||(m[15]=e("label",{for:"tier",class:""},"Tier",-1)),o($).item.tier.$error?(t(),s("div",nb,[(t(!0),s(A,null,E(o($).item.tier.$errors,a=>(t(),s("div",{key:a.$uid},c(a.$message),1))),128))])):x("",!0)])])]),e("div",rb,[e("div",ib,[e("div",db,[q(e("select",{"onUpdate:modelValue":m[6]||(m[6]=a=>n.item.logoUrl=a),class:te([o(S).getValidFeedbackCss(n.item.logoUrl),"form-select"]),id:"logoUrl"},[(t(!0),s(A,null,E(n.lookups.logos,a=>(t(),s("option",{value:a.url},c(a.id),9,ub))),256))],2),[[pe,n.item.logoUrl]]),m[16]||(m[16]=e("label",{for:"logoUrl",class:""},"Logo",-1)),o($).item.logoUrl.$error?(t(),s("div",cb,[(t(!0),s(A,null,E(o($).item.logoUrl.$errors,a=>(t(),s("div",{key:a.$uid},c(a.$message),1))),128))])):x("",!0)])]),n.item.logoUrl?(t(),s("div",mb,[e("div",fb,[e("img",{src:n.item.logoUrl,class:"img-fluid card"},null,8,pb)])])):x("",!0)])])]),e("div",vb,[e("div",gb,[e("div",bb,[e("div",yb,[q(e("select",{"onUpdate:modelValue":m[7]||(m[7]=a=>n.item.fillerSlateSourceLocationId=a),onChange:m[8]||(m[8]=a=>J()),class:te([o(S).getValidFeedbackCss(n.item.fillerSlateSourceLocationId),"form-select"]),id:"fillerSlateSourceLocationId"},[(t(!0),s(A,null,E(n.lookups.sourceLocations,a=>(t(),s("option",{value:a.id},c(a.name),9,$b))),256))],34),[[pe,n.item.fillerSlateSourceLocationId]]),m[17]||(m[17]=e("label",{for:"fillerSlateSourceLocationId",class:""},"Filler Slate Source Location",-1)),o($).item.fillerSlateSourceLocationId.$error?(t(),s("div",hb,[(t(!0),s(A,null,E(o($).item.fillerSlateSourceLocationId.$errors,a=>(t(),s("div",{key:a.$uid},c(a.$message),1))),128))])):x("",!0)])]),e("div",wb,[e("div",_b,[e("div",kb,[e("div",{id:"fillerSlateVodSourceId",class:te([o(S).getValidFeedbackCss(n.selected.vodSource),"form-control"]),placeholder:"Title"},[n.selected.vodSource?(t(),s(A,{key:0},[Y(" ["+c(o(S).moment.utc(n.selected.vodSource.video.durationInMillis).format("HH:mm:ss"))+"] - "+c(n.selected.vodSource.name),1)],64)):x("",!0)],2),m[18]||(m[18]=e("label",{for:"fillerSlateVodSourceId",class:""},"Filler Slate VOD Source",-1))]),n.item.fillerSlateSourceLocationId?(t(),s("button",{key:0,onClick:G,class:"btn btn-primary",type:"button"},m[19]||(m[19]=[e("i",{class:"fa-solid fa-filter"},null,-1)]))):x("",!0)])]),q(e("div",null,m[20]||(m[20]=[e("div",{class:"card1"},[e("video",{id:"video-preview",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain card"})],-1)]),512),[[ke,n.selected.vodSource]])])])])]),_:1},8,["errorMessage","vuelidate"])])]),_:1})}}},Tb={components:{Page:ct},props:{id:{type:String,required:!0},urlView:{type:String,default:"/movieAlphas/view"}}};function Ib(r,b,T,M,k,H){const V=oe("Page");return t(),be(V,{id:T.id,urlView:T.urlView},null,8,["id","urlView"])}const Mb=Oe(Tb,[["render",Ib]]),xb={class:"ms-1"},Cb={class:"input-group"},Vb={class:"table-responsive border shadow-sm"},Ab={class:"table table-hover mb-0"},Ob=["textContent"],Pb={class:"d-flex flex-column flex-lg-row"},Ub=["src"],Lb={class:"ms-lg-2 mt-2 mt-lg-0"},Hb={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},Db={class:"text-center"},Eb={key:0,class:"badge text-bg-success"},qb={key:1,class:"badge text-bg-warning"},Bb={class:"text-end"},Nb={class:"text-end"},Rb={class:"text-end"},Fb={class:"text-end"},zb=["onClick"],Gb=["onClick"],jb="/api/v1/channels/search",Yb={__name:"index",props:{urlAdd:{type:String,default:"/channels/add"},urlView:{type:String,default:"/channels/view"},urlSchedulePrograms:{type:String,default:"/channels/schedule-programs"}},setup(r){Ce("$config");const T=we().user,{appTitle:M,pageTitle:k,busy:H,infoMessage:V,warningMessage:Q,errorMessage:j,router:S,axios:z,utils:ae,toasts:N,close:L,security:n,generateReturnUrl:I,filter:$,initializeFilter:K,getQuery:J,saveQuery:u,search:p,getRowNumber:W,setSelected:g,isSelected:G}=De({appTitle:"ARC CMS",pageTitle:"Channels",cacheKey:`${T==null?void 0:T.userId}/Channels/search`,baseUrl:jb,filter:{updateUrl:!0}});fe(async()=>{K(),await p()});const y=async(f,m)=>{if(!H.value){j.value=null;try{H.value=!0,await z.put(`/api/v1/channels/${f}/change-state/${m}`).then(i=>{N.success("Update Channel state","Change state was updated")}),H.value=!1,await p()}catch(i){j.value=ae.getErrorMessageAsHtml(i),window.scrollTo(0,0)}finally{H.value=!1}}};return(f,m)=>{const i=oe("router-link"),d=oe("PageHeader"),l=oe("m-pagination"),a=oe("PageBody");return t(),be($e,null,{default:R(()=>[e("div",null,[F(d,{"page-icon":"fas fa-fw fa-tv",pageTitle:o(k)},{default:R(()=>[F(i,{to:r.urlAdd,class:"btn btn-primary"},{default:R(()=>m[3]||(m[3]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)])),_:1},8,["to"]),e("div",xb,[e("div",Cb,[q(e("input",{"onUpdate:modelValue":m[0]||(m[0]=h=>o($).query.criteria=h),onKeyup:m[1]||(m[1]=He(h=>o(p)(1),["enter"])),type:"text",class:"form-control",placeholder:"Enter criteria...","aria-label":"Enter criteria...","aria-describedby":"button-addon2"},null,544),[[ee,o($).query.criteria]]),e("button",{class:"btn btn-primary",type:"button",id:"button-addon2",onClick:m[2]||(m[2]=h=>o(p)(1))},m[4]||(m[4]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])])]),_:1},8,["pageTitle"]),F(a,{errorMessage:o(j)},{default:R(()=>[e("div",Vb,[e("table",Ab,[m[8]||(m[8]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Name"),e("th",{class:"text-center"},"State"),e("th",{class:"text-center"},"Programs"),e("th",{class:"text-center"},"Outputs"),e("th",{class:"text-center"},"SSAI"),e("th")])],-1)),q(F(Se,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(A,null,E(o($).items,(h,_)=>(t(),s("tr",{key:h.channelId},[e("td",{textContent:c(o(W)(_)),class:"text-center"},null,8,Ob),e("td",null,[e("div",Pb,[e("div",null,[e("img",{src:h.logoUrl,class:"img-fluid border",style:{width:"6rem"}},null,8,Ub)]),e("div",Lb,[F(i,{to:`${r.urlView}/${h.channelId}`,class:"d-inline-block text-truncate link-offset-2"},{default:R(()=>[h.arn?(t(),s("span",Hb)):x("",!0),Y(c(h.name),1)]),_:2},1032,["to"])])])]),e("td",Db,[e("div",null,[h.state==="RUNNING"?(t(),s("span",Eb,c(h.state),1)):h.state==="STOPPED"?(t(),s("span",qb,c(h.state),1)):x("",!0)])]),e("td",Bb,c(h.programs),1),e("td",Nb,c(h.outputs),1),e("td",Rb,c(h.playbackConfigurations),1),e("td",Fb,[h.state==="RUNNING"?(t(),s("button",{key:0,onClick:v=>y(h.channelId,"STOPPED"),class:"btn btn-sm btn-warning ms-2"},m[5]||(m[5]=[e("span",{class:"fas fa-fw fa-stop me-1"},null,-1),Y("Stop ")]),8,zb)):h.state==="STOPPED"?(t(),s(A,{key:1},[h.arn?(t(),s("button",{key:0,onClick:v=>y(h.channelId,"RUNNING"),class:"btn btn-sm btn-info ms-2"},m[6]||(m[6]=[e("span",{class:"fas fa-fw fa-play me-1"},null,-1),Y("Start ")]),8,Gb)):x("",!0)],64)):x("",!0),F(i,{to:`${r.urlSchedulePrograms}/${h.channelId}/${o(I)()}`,class:"btn btn-sm btn-outline-info ms-2"},{default:R(()=>m[7]||(m[7]=[e("span",{class:"fas fa-fw fa-calendar"},null,-1)])),_:2},1032,["to"])])]))),128))]),_:1},512),[[ke,o($).items.length>0]])])]),F(l,{filter:o($),search:o(p),showPerPage:!0},null,8,["filter","search"])]),_:1},8,["errorMessage"])])]),_:1})}}},Kb=["id"],Wb={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},Qb={class:"modal-content"},Jb={class:"modal-header"},Zb={class:"modal-title"},Xb={class:"modal-body p-1"},ey={class:"row row-cols-1 row-cols-sm-2 g-2"},ty={class:"col-sm-4"},sy={class:"card"},oy={key:0,class:"mt-2"},ay={class:"col"},ly={class:"form-floating mb-2"},ny={class:"col ms-2 my-2"},ry={class:"badge bg-info me-1"},iy={class:"badge bg-primary me-1"},dy={class:"row row-cols-1 row-cols-sm-2"},uy={class:"col"},cy={class:"form-floating mb-2"},my={class:"form-control-plaintext",id:"dateReleased",placeholder:"Date Released",readonly:""},fy={class:"col"},py={class:"form-floating mb-2"},vy={class:"form-control-plaintext",id:"duration",placeholder:"Duration",readonly:""},gy={class:"col"},by={class:"form-floating mb-2"},yy={class:"col-sm-8"},$y={class:"col"},hy={class:"input-group mb-2"},wy={class:"form-floating"},_y={class:"table-responsive border shadow-sm"},ky={class:"table table-sm table-hover mb-0 overflow-auto"},Sy=["textContent"],Ty={class:"d-flex flex-row justify-content-start"},Iy={class:"mt-1"},My=["src"],xy={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},Cy={class:"ms-2"},Vy=["onClick"],Ay={class:"modal-footer"},Oy="/api/v1/programtemplates/search",Py={__name:"_selectProgramTemplate",emits:["close"],setup(r,{expose:b,emit:T}){const k=we().user,{appTitle:H,pageTitle:V,busy:Q,infoMessage:j,warningMessage:S,errorMessage:z,router:ae,axios:N,utils:L,toasts:n,security:I,filter:$,initializeFilter:K,getQuery:J,saveQuery:u,search:p,getRowNumber:W,setSelected:g,isSelected:G}=De({appTitle:"Arcadian-FAST",pageTitle:"Select Program Template",cacheKey:`${k==null?void 0:k.userId}/program-templates/select`,baseUrl:Oy,filter:{updateUrl:!0,lookups:{genres:[]},query:{}}}),y=T,f=ge("modalSelectProgramTemplate"),m=ye({programTemplate:null,hls:null});fe(async()=>{K(),await i()}),Le(()=>{m.hls&&(m.hls.stopLoad(),m.hls.destroy())});const i=async()=>{await a(),await h()},d=async v=>{$.value.query.sourceLocationId=v,z.value="",await p();var B=document.getElementById(f.value),P=_e.getOrCreateInstance(B);P.show()},l=async()=>{var v=document.getElementById(f.value),B=_e.getOrCreateInstance(v);B.hide();debugger;m.hls&&(m.hls.stopLoad(),m.hls.destroy()),y("close",m.programTemplate)},a=async v=>{try{const P=await N.get("/api/v1/lookups/video-categories/").then(w=>w.data);$.value.lookups.categories=P}catch(B){z.value=L.getErrorMessageAsHtml(B),window.scrollTo(0,0)}finally{}},h=async v=>{try{const P=await N.get("/api/v1/lookups/video-genres/").then(w=>w.data);$.value.lookups.genres=P}catch(B){z.value=L.getErrorMessageAsHtml(B),window.scrollTo(0,0)}finally{}},_=v=>{m.programTemplate=v,l()};return b({open:d,close:l}),(v,B)=>{const P=oe("m-pagination"),w=oe("PageBody");return t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:f.value,tabindex:"-1","aria-hidden":"true"},[e("div",Wb,[e("div",Qb,[e("div",Jb,[e("h5",Zb,[B[8]||(B[8]=e("span",{class:"fas fa-fw fa-filter me-1"},null,-1)),Y(c(o(V)),1)]),e("button",{type:"button",class:"btn-close",onClick:B[0]||(B[0]=D=>l()),"aria-label":"Close"})]),e("div",Xb,[F(w,{errorMessage:o(z)},{default:R(()=>[e("div",ey,[e("div",ty,[e("div",sy,[B[13]||(B[13]=e("video",{id:"video-select-preview",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain"},null,-1)),m.programTemplate?(t(),s("div",oy,[e("div",ay,[e("div",ly,[q(e("input",{"onUpdate:modelValue":B[1]||(B[1]=D=>m.programTemplate.vodSource.video.title=D),type:"text",class:"form-control-plaintext",id:"title",placeholder:"Title",readonly:""},null,512),[[ee,m.programTemplate.vodSource.video.title]]),B[9]||(B[9]=e("label",{for:"title"},"Title",-1))])]),e("div",ny,[e("div",null,[(t(!0),s(A,null,E(m.programTemplate.vodSource.video.genres,D=>(t(),s("span",ry,c(D.genreName),1))),256)),(t(!0),s(A,null,E(m.programTemplate.vodSource.video.categories,D=>(t(),s("span",iy,c(D.categoryName),1))),256))])]),e("div",dy,[e("div",uy,[e("div",cy,[e("div",my,c(o(L).moment(m.programTemplate.vodSource.video.dateReleased).calendar()),1),B[10]||(B[10]=e("label",{for:"dateReleased"},"Date Released",-1))])]),e("div",fy,[e("div",py,[e("div",vy,c(o(L).moment.utc(m.programTemplate.vodSource.video.durationInMillis).format("HH:mm:ss")),1),B[11]||(B[11]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",gy,[e("div",by,[q(e("textarea",{"onUpdate:modelValue":B[2]||(B[2]=D=>m.programTemplate.vodSource.video.description=D),type:"text",class:"form-control-plaintext",id:"description",placeholder:"Description",readonly:"",style:{height:"7rem"}},null,512),[[ee,m.programTemplate.vodSource.video.description]]),B[12]||(B[12]=e("label",{for:"description"},"Description",-1))])])])):x("",!0)])]),e("div",yy,[e("div",$y,[e("div",hy,[e("div",wy,[q(e("input",{"onUpdate:modelValue":B[3]||(B[3]=D=>o($).query.criteria=D),onKeyup:B[4]||(B[4]=He(D=>o(p)(1),["enter"])),id:"criteria",type:"text",class:"form-control"},null,544),[[ee,o($).query.criteria]]),B[14]||(B[14]=e("label",{for:"criteria",class:""},"Criteria",-1))]),e("button",{class:"btn btn-primary",type:"button",onClick:B[5]||(B[5]=D=>o(p)(1))},B[15]||(B[15]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])]),e("div",_y,[e("table",ky,[B[16]||(B[16]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Title")])],-1)),q(F(Se,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(A,null,E(o($).items,(D,X)=>(t(),s("tr",{key:D.videoId},[e("td",{textContent:c(o(W)(X)),class:"text-center"},null,8,Sy),e("td",null,[e("div",Ty,[e("div",null,[D.vodSource.video.thumbnails.length>0?(t(!0),s(A,{key:0},E(D.vodSource.video.thumbnails,U=>(t(),s("div",Iy,[e("img",{src:U.url,class:"img-fuild border",width:"128"},null,8,My)]))),256)):(t(),s("img",xy))]),e("div",Cy,[e("a",{onClick:U=>_(D),class:"text-wrap link-offset-2",role:"button"},c(D.name),9,Vy)])])])]))),128))]),_:1},512),[[ke,o($).items.length>0]])])]),F(P,{filter:o($),search:o(p),showPerPage:!0},null,8,["filter","search"])])])]),_:1},8,["errorMessage"])]),e("div",Ay,[e("button",{onClick:B[6]||(B[6]=D=>l()),class:"btn btn-primary",type:"button"},B[17]||(B[17]=[e("span",{class:"fas fa-fw fa-circle-check"},null,-1)])),e("button",{onClick:B[7]||(B[7]=D=>l()),class:"btn btn-secondary ms-1"},B[18]||(B[18]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])])],8,Kb)}}},Uy={key:0,class:"modal-content"},Ly={class:"modal-header p-2"},Hy={class:"modal-title"},Dy={class:"modal-body container-fluid py-1 overflow-y-auto"},Ey=["errorMessage"],qy={class:"row row-cols-1 row-cols-sm-2"},By={class:"card"},Ny={key:0,class:"mt-2"},Ry={class:"col"},Fy={class:"form-floating mb-2"},zy={class:"col ms-2 my-2"},Gy={class:"badge bg-info me-1"},jy={class:"badge bg-primary me-1"},Yy={class:"row row-cols-1 row-cols-sm-2"},Ky={class:"col"},Wy={class:"form-floating mb-2"},Qy={class:"form-control-plaintext",id:"dateReleased",placeholder:"Date Released",readonly:""},Jy={class:"col"},Zy={class:"form-floating mb-2"},Xy={class:"form-control-plaintext",id:"duration",placeholder:"Duration",readonly:""},e$={class:"col"},t$={class:"form-floating mb-2"},s$={class:"col"},o$={class:"input-group mb-2"},a$={class:"form-floating"},l$={class:"table-responsive border shadow-sm"},n$={class:"table table-sm table-hover mb-0 overflow-auto"},r$=["textContent"],i$={class:"d-flex flex-row justify-content-start"},d$={class:"mt-1"},u$=["src"],c$={key:1,src:"https://placehold.co/600x400?text=No+Thumbnail",class:"img-fuild border",width:"128"},m$={class:"ms-2"},f$=["onClick"],p$={class:"modal-footer p-1"},v$="/api/v1/programtemplates/search",g$={__name:"_selectProgramTemplateInline",props:{isOpen:{type:Boolean,required:!0}},emits:["close"],setup(r,{expose:b,emit:T}){const k=we().user,{appTitle:H,pageTitle:V,busy:Q,infoMessage:j,warningMessage:S,errorMessage:z,router:ae,axios:N,utils:L,toasts:n,security:I,filter:$,initializeFilter:K,getQuery:J,saveQuery:u,search:p,getRowNumber:W,setSelected:g,isSelected:G}=De({appTitle:"Arcadian-FAST",pageTitle:"Select Program Template",cacheKey:`${k==null?void 0:k.userId}/program-templates/select`,baseUrl:v$,filter:{updateUrl:!1,lookups:{genres:[]},query:{}},initializeFilter:(B,P)=>{B.value,new URLSearchParams(window.location.search),JSON.parse(localStorage.getItem(P))},getQuery:B=>["?c=",encodeURIComponent(B.query.criteria),"&p=",B.pageIndex,"&s=",B.pageSize,"&sf=",B.sortField,"&so=",B.sortOrder,"&withArn=true"].join(""),saveQuery:(B,P)=>{},successAction:()=>{m.programTemplate&&(m.programTemplate=null)}}),y=r,f=T;ge("modalSelectProgramTemplateInline");const m=ye({programTemplate:null,hls:null});fe(async()=>{K(),await i()}),Le(()=>{m.hls&&(m.hls.stopLoad(),m.hls.destroy())});const i=async()=>{await a(),await h()},d=async B=>{debugger;$.value.query.sourceLocationId=B,z.value="",await p(),y.isOpen=!0},l=async()=>{m.hls&&(m.hls.stopLoad(),m.hls.destroy()),f("close",m.programTemplate),y.isOpen=!1},a=async B=>{try{const w=await N.get("/api/v1/lookups/video-categories/").then(D=>D.data);$.value.lookups.categories=w}catch(P){z.value=L.getErrorMessageAsHtml(P),window.scrollTo(0,0)}finally{}},h=async B=>{try{const w=await N.get("/api/v1/lookups/video-genres/").then(D=>D.data);$.value.lookups.genres=w}catch(P){z.value=L.getErrorMessageAsHtml(P),window.scrollTo(0,0)}finally{}},_=B=>{m.programTemplate=B,v()},v=()=>{if(Hls.isSupported()){m.hls&&(m.hls.stopLoad(),m.hls.destroy());var B=document.getElementById("video-select-preview");const w=m.programTemplate.vodSource.video.formats.find(X=>X.formatName==="HLS"),D=w.serverUrl+w.path;m.hls=L.createHlsStream(B,D)}};return b({open:d,close:l}),(B,P)=>{const w=oe("PageMessages"),D=oe("m-pagination");return t(),be($e,null,{default:R(()=>[r.isOpen?(t(),s("div",Uy,[e("div",Ly,[e("h6",Hy,[P[7]||(P[7]=e("span",{class:"fas fa-fw fa-filter me-1"},null,-1)),Y(c(o(V)),1)])]),e("div",Dy,[F(w,{errorMessage:o(z)},null,8,["errorMessage"]),e("div",{errorMessage:o(z),class:""},[e("div",qy,[e("div",{class:te([m.programTemplate?"col-sm-4":"d-none"])},[e("div",By,[P[12]||(P[12]=e("video",{id:"video-select-preview",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain"},null,-1)),m.programTemplate?(t(),s("div",Ny,[e("div",Ry,[e("div",Fy,[q(e("input",{"onUpdate:modelValue":P[0]||(P[0]=X=>m.programTemplate.vodSource.video.title=X),type:"text",class:"form-control-plaintext",id:"title",placeholder:"Title",readonly:""},null,512),[[ee,m.programTemplate.vodSource.video.title]]),P[8]||(P[8]=e("label",{for:"title"},"Title",-1))])]),e("div",zy,[e("div",null,[(t(!0),s(A,null,E(m.programTemplate.vodSource.video.genres,X=>(t(),s("span",Gy,c(X.genreName),1))),256)),(t(!0),s(A,null,E(m.programTemplate.vodSource.video.categories,X=>(t(),s("span",jy,c(X.categoryName),1))),256))])]),e("div",Yy,[e("div",Ky,[e("div",Wy,[e("div",Qy,c(o(L).moment(m.programTemplate.vodSource.video.dateReleased).calendar()),1),P[9]||(P[9]=e("label",{for:"dateReleased"},"Date Released",-1))])]),e("div",Jy,[e("div",Zy,[e("div",Xy,c(o(L).moment.utc(m.programTemplate.vodSource.video.durationInMillis).format("HH:mm:ss")),1),P[10]||(P[10]=e("label",{for:"duration"},"Duration",-1))])])]),e("div",e$,[e("div",t$,[q(e("textarea",{"onUpdate:modelValue":P[1]||(P[1]=X=>m.programTemplate.vodSource.video.description=X),type:"text",class:"form-control-plaintext",id:"description",placeholder:"Description",readonly:"",style:{height:"7rem"}},null,512),[[ee,m.programTemplate.vodSource.video.description]]),P[11]||(P[11]=e("label",{for:"description"},"Description",-1))])])])):x("",!0)])],2),e("div",{class:te([[m.programTemplate?"col-sm-8":"col-sm-12"],"mt-2 mt-sm-0"])},[e("div",s$,[e("div",o$,[e("div",a$,[q(e("input",{"onUpdate:modelValue":P[2]||(P[2]=X=>o($).query.criteria=X),onKeyup:P[3]||(P[3]=He(X=>o(p)(1),["enter"])),id:"criteria",type:"text",class:"form-control"},null,544),[[ee,o($).query.criteria]]),P[13]||(P[13]=e("label",{for:"criteria",class:""},"Criteria",-1))]),e("button",{class:"btn btn-primary",type:"button",onClick:P[4]||(P[4]=X=>o(p)(1))},P[14]||(P[14]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)]))])]),e("div",l$,[e("table",n$,[P[15]||(P[15]=e("thead",null,[e("tr",null,[e("td",{class:"text-center"},"#"),e("th",null,"Title")])],-1)),q(F(Se,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(A,null,E(o($).items,(X,U)=>(t(),s("tr",{key:X.videoId},[e("td",{textContent:c(o(W)(U)),class:"text-center"},null,8,r$),e("td",null,[e("div",i$,[e("div",null,[X.vodSource.video.thumbnails.length>0?(t(!0),s(A,{key:0},E(X.vodSource.video.thumbnails,ne=>(t(),s("div",d$,[e("img",{src:ne.url,class:"img-fuild border",width:"128"},null,8,u$)]))),256)):(t(),s("img",c$))]),e("div",m$,[e("a",{onClick:ne=>_(X),class:"text-wrap link-offset-2",role:"button"},c(X.name),9,f$)])])])]))),128))]),_:1},512),[[ke,o($).items.length>0]])])]),F(D,{filter:o($),search:o(p),showPerPage:!0},null,8,["filter","search"])],2)])],8,Ey)]),e("div",p$,[e("button",{onClick:P[5]||(P[5]=X=>l()),class:"btn btn-primary btn-sm",type:"button"},P[16]||(P[16]=[e("span",{class:"fas fa-fw fa-circle-check"},null,-1)])),e("button",{onClick:P[6]||(P[6]=X=>l(!1)),class:"btn btn-secondary btn-sm ms-1"},P[17]||(P[17]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])):x("",!0)]),_:1})}}},b$=["id"],y$={class:"modal-dialog modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},$$={class:"modal-content"},h$={class:"modal-header"},w$={class:"modal-title"},_$={class:"modal-body"},k$={key:0},S$={class:"row row-cols-1 row-cols-sm-3"},T$={class:"col-sm-3"},I$={class:"form-floating mb-2"},M$={key:0,class:"d-block invalid-feedback"},x$={class:"col-sm-3"},C$={class:"form-floating mb-2"},V$={key:0,class:"d-block invalid-feedback"},A$={class:"col-sm-6"},O$={class:"form-floating"},P$={id:"programTemplateId",class:"form-control",placeholder:"Title"},U$={key:0,class:"btn btn-primary",type:"button"},L$={key:0,class:"d-block invalid-feedback"},H$={key:1,class:"d-block invalid-feedback"},D$={key:0},E$={class:"row row-cols-1 row-cols-sm-2"},q$={class:"col"},B$={class:"row row-cols-1"},N$={class:"col"},R$={class:"form-floating mb-2"},F$={class:"col"},z$={class:"form-floating mb-2"},G$={class:"row row-cols-1 row-cols-sm-3"},j$={class:"col"},Y$={class:"form-floating mb-2"},K$={class:"col"},W$={class:"form-floating mb-2"},Q$={class:"col"},J$={class:"form-floating mb-2"},Z$={class:"row row-cols-1 row-cols-sm-3"},X$={class:"col"},eh={class:"form-floating mb-2"},th={class:"col"},sh={class:"form-floating mb-2"},oh={key:1},ah={class:"table-responsive border mt-1"},lh={class:"table table-sm mb-0"},nh=["onUpdate:modelValue","onChange"],rh=["value"],ih={key:0,class:"modal-footer"},dh=["disabled"],uh={__name:"_addProgram",props:{channelId:{type:String,required:!0},eventId:{type:String,required:!0},dateScheduledStart:{type:String,required:!0},timezone:{type:String,default:""}},emits:["confirm","cancel"],setup(r,{expose:b,emit:T}){const{appTitle:M,pageTitle:k,busy:H,isDirty:V,validations:Q,infoMessage:j,warningMessage:S,errorMessage:z,router:ae,axios:N,utils:L,toasts:n,closeWithReturnUrl:I,security:$}=he({appTitle:"Arcadian-FAST",pageTitle:"Add Program"}),K=T,J=r,u=ge(),p=ge(),W=ge("modalAddProgramFromTemplate"),g=ye({eventId:null,lookups:{sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[],channelOutputs:[],programTemplates:[]},selected:{programTemplate:null,channel:null},item:{programTemplateId:null,name:null,dateScheduledStart:null,sourceLocationId:null,vodSource:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]}}),G=(ne,Z,se)=>ne.length<=0?!0:ne.every(me=>me.vodSourceId),y={item:{name:{required:le.withMessage("Name is required.",re),$autoDirty:!0,$lazy:!0},programTemplateId:{required:le.withMessage("Program Template is required.",re),$autoDirty:!0,$lazy:!0},dateScheduledStart:{required:le.withMessage("Date Scheduled Start is required.",re),$autoDirty:!0,$lazy:!0},adBreaks:{adBreaksRequired:le.withMessage("Ad Break is not properly configured.",G),$each:le.forEach({vodSourceId:{required:le.withMessage("Vod Source is required.",re)}})}}},f=Te(y,g);fe(async()=>{m()});const m=async()=>{const ne=g;Q.value.clear(),z.value="";const Z=L.moment(J.dateScheduledStart),O=Z.format("YYYY-MM-DD HH:mm"),me=Z.format("YYYYMMDD_HHmm")+"_PRG_";ne.eventId=J.eventId,ne.lookups={sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[],channelOutputs:[],programTemplates:[]},ne.selected={programTemplate:null},ne.item={programTemplateId:null,name:me,dateScheduledStart:O,sourceLocationId:null,vodSource:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]},await d(),f.value.$reset();var ue=document.getElementById(W.value),de=_e.getOrCreateInstance(ue);de.show()},i=async ne=>{if(!ne){var Z=document.getElementById(W.value),se=_e.getOrCreateInstance(Z);se.hide(),K("cancel");return}if(!await f.value.$validate()){window.scrollTo(0,0);return}const me=g;let ue=L.moment(me.item.dateScheduledStart).utc(!0).format(),de=L.moment(me.item.dateScheduledStart).add(me.selected.programTemplate.totalProgramTemplateDurationInMillis,"milliseconds").utc(!0).format();if(J.timezone){ue=L.moment.tz(me.item.dateScheduledStart,J.timezone).utc().format(),de=L.moment.utc(me.item.dateScheduledStart,J.timezone).add(me.selected.programTemplate.totalProgramTemplateDurationInMillis,"milliseconds").utc().format();debugger}g.item={eventId:J.eventId,programTemplateId:me.selected.programTemplate.programTemplateId,channelId:J.channelId,name:me.item.name,dateScheduledStart:ue,dateScheduledEnd:de,adBreaks:me.selected.programTemplate.adBreaks.map(ce=>({sourceLocationId:ce.sourceLocationId,vodSourceId:ce.vodSourceId,offsetMillis:ce.offsetMillis,durationInMillis:ce.durationInMillis}))};try{await N.post("/api/v1/programs/",g.item).then(ve=>{n.success("Add New Program",`Program [${g.item.name}] was added to this channel.`)});var Z=document.getElementById(W.value),se=_e.getOrCreateInstance(Z);se.hide(),K("confirm",g.item)}catch(ce){z.value=L.getErrorMessageAsHtml(ce)}},d=async()=>{await v(),await l(),await a()},l=async()=>{try{const ne=`/api/v1/channelOutputs/get-by-channel/${J.channelId}`;await N.get(ne).then(Z=>{g.lookups.channelOutputs=Z.data}),g.item.programTemplateId&&await h()}catch(ne){z.value=L.getErrorMessageAsHtml(ne),window.scrollTo(0,0)}finally{}},a=async()=>{try{const ne=`/api/v1/programTemplates/lookup/by-channel/${J.channelId}`;await N.get(ne).then(Z=>{g.lookups.programTemplates=Z.data,g.lookups.programTemplates.length===1&&(g.item.programTemplateId=g.lookups.programTemplates[0].id)}),g.item.programTemplateId&&await h(g.item.programTemplateId)}catch(ne){z.value=L.getErrorMessageAsHtml(ne),window.scrollTo(0,0)}finally{}},h=async ne=>{await _(ne)},_=async ne=>{try{const Z=`/api/v1/programTemplates/${ne}/`;await N.get(Z).then(me=>{g.selected.programTemplate=me.data;const ue=g.selected.programTemplate;ue.startOffsetTime=L.moment.utc(ue.startOffsetMillis).format("HH:mm:ss"),ue.endOffsetTime=L.moment.utc(ue.endOffsetMillis).format("HH:mm:ss"),ue.durationTime=L.moment.utc(ue.durationInMillis).format("HH:mm:ss"),ue.adBreaksDurationTime=L.moment.utc(ue.adBreaksDurationInMillis).format("HH:mm:ss"),ue.totalProgramTemplateDurationTime=L.moment.utc(ue.totalProgramTemplateDurationInMillis).format("HH:mm:ss"),g.item.programTemplateId=ue.programTemplateId,g.item.adBreaks=ue.adBreaks});const se=g;if(se.lookups.channelOutputs.length<=0){alert("Create channel output first.");return}const O=se.lookups.channelOutputs[0].outputType;await P(se.selected.programTemplate.sourceLocationId,O)}catch(Z){z.value=L.getErrorMessageAsHtml(Z),window.scrollTo(0,0)}finally{}},v=async()=>{try{await N.get("/api/v1/sourcelocations/lookup/").then(Z=>{g.lookups.sourceLocations=Z.data,g.lookups.sourceLocations.length===1&&(g.item.sourceLocationId=g.lookups.sourceLocations[0].id)}),g.item.sourceLocationId&&await B(g.item.sourceLocationId)}catch(ne){z.value=L.getErrorMessageAsHtml(ne),window.scrollTo(0,0)}finally{}},B=async ne=>{try{let Z=`/api/v1/vodSources/lookup/source-location/${ne}`;await N.get(Z).then(se=>{g.lookups.vodSources=se.data})}catch(Z){z.value=L.getErrorMessageAsHtml(Z),window.scrollTo(0,0)}finally{}},P=async(ne,Z)=>{try{let se=`/api/v1/vodsources/lookup/output-type/${Z}`;await N.get(se).then(O=>{g.lookups.adBreakVodSources=O.data})}catch(se){z.value=L.getErrorMessageAsHtml(se),window.scrollTo(0,0)}finally{}},w=ne=>{const Z=g.lookups.adBreakVodSources.find(se=>se.id==ne.vodSourceId);ne.sourceLocationId=Z.sourceLocationId},D=async ne=>{U.value=!1,ne&&(await h(ne.programTemplateId),X())},X=()=>{if(Hls.isSupported()){g.hls&&(g.hls.stopLoad(),g.hls.destroy());var ne=document.getElementById("video-add-program");const se=g.selected.programTemplate.vodSource.video.formats.find(me=>me.formatName==="HLS"),O=se.serverUrl+se.path;g.hls=L.createHlsStream(ne,O)}},U=ge(!1);return b({open:m,close:i}),(ne,Z)=>{const se=oe("PageMessages");return t(),be($e,null,{default:R(()=>[e("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:W.value,tabindex:"-1","aria-hidden":"false"},[e("div",y$,[e("div",$$,[e("div",h$,[e("h5",w$,[Z[13]||(Z[13]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Y(c(o(k)),1)]),e("button",{type:"button",class:"btn-close",onClick:Z[0]||(Z[0]=O=>i(!1)),"aria-label":"Close"})]),e("div",_$,[F(se,{errorMessage:o(z),vuelidate:o(f)},null,8,["errorMessage","vuelidate"]),F(g$,{ref_key:"modalSelectProgramTemplateInline",ref:p,isOpen:U.value,onClose:D},null,8,["isOpen"]),U.value?x("",!0):(t(),s("div",k$,[e("div",S$,[e("div",T$,[e("div",I$,[q(e("input",{"onUpdate:modelValue":Z[1]||(Z[1]=O=>g.item.name=O),id:"name",class:"form-control",placeholder:"Name"},null,512),[[ee,g.item.name]]),Z[14]||(Z[14]=e("label",{for:"name",class:""},"Name",-1)),o(f).item.name.$error?(t(),s("div",M$,[(t(!0),s(A,null,E(o(f).item.name.$errors,O=>(t(),s("div",{key:O.$uid},c(O.$message),1))),128))])):x("",!0)])]),e("div",x$,[e("div",C$,[q(e("input",{"onUpdate:modelValue":Z[2]||(Z[2]=O=>g.item.dateScheduledStart=O),type:"datetime-local",id:"dateScheduledStart",class:"form-control"},null,512),[[ee,g.item.dateScheduledStart]]),Z[15]||(Z[15]=e("label",{for:"dateScheduledStart",class:""},"Date Scheduled Start",-1)),o(f).item.dateScheduledStart.$error?(t(),s("div",V$,[(t(!0),s(A,null,E(o(f).item.dateScheduledStart.$errors,O=>(t(),s("div",{key:O.$uid},c(O.$message),1))),128))])):x("",!0)])]),e("div",A$,[e("div",{onClick:Z[3]||(Z[3]=O=>U.value=!U.value),class:"input-group mb-2"},[e("div",O$,[e("div",P$,[g.selected.programTemplate?(t(),s(A,{key:0},[Y(c(g.selected.programTemplate.name),1)],64)):x("",!0)]),Z[16]||(Z[16]=e("label",{for:"programTemplateId",class:""},"Program Template",-1))]),g.lookups.channelOutputs.length>0?(t(),s("button",U$,Z[17]||(Z[17]=[e("i",{class:"fa-solid fa-filter"},null,-1)]))):x("",!0)]),g.lookups.channelOutputs.length<=0?(t(),s("div",L$," Channel has no output. Please create first before adding program. ")):x("",!0),o(f).item.programTemplateId.$error?(t(),s("div",H$,[(t(!0),s(A,null,E(o(f).item.programTemplateId.$errors,O=>(t(),s("div",{key:O.$uid},c(O.$message),1))),128))])):x("",!0)])]),g.selected.programTemplate?(t(),s("div",D$,[e("div",E$,[Z[25]||(Z[25]=e("div",{class:"col"},[e("div",null,[e("video",{id:"video-add-program",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain border"})])],-1)),e("div",q$,[e("div",B$,[g.selected.programTemplate?(t(),s(A,{key:0},[e("div",N$,[e("div",R$,[q(e("input",{"onUpdate:modelValue":Z[4]||(Z[4]=O=>g.selected.programTemplate.sourceLocation.name=O),id:"name",class:"form-control-plaintext",readonly:""},null,512),[[ee,g.selected.programTemplate.sourceLocation.name]]),Z[18]||(Z[18]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1))])]),e("div",F$,[e("div",z$,[q(e("input",{"onUpdate:modelValue":Z[5]||(Z[5]=O=>g.selected.programTemplate.vodSource.name=O),id:"name",class:"form-control-plaintext",readonly:""},null,512),[[ee,g.selected.programTemplate.vodSource.name]]),Z[19]||(Z[19]=e("label",{for:"vodSourceId",class:""},"VOD Source",-1))])])],64)):x("",!0)]),e("div",G$,[e("div",j$,[e("div",Y$,[q(e("input",{"onUpdate:modelValue":Z[6]||(Z[6]=O=>g.selected.programTemplate.startOffsetTime=O),type:"text",class:"form-control-plaintext",id:"startOffsetTime",readonly:""},null,512),[[ee,g.selected.programTemplate.startOffsetTime]]),Z[20]||(Z[20]=e("label",{for:"startOffsetTime"},"Total Program Duration",-1))])]),e("div",K$,[e("div",W$,[q(e("input",{"onUpdate:modelValue":Z[7]||(Z[7]=O=>g.selected.programTemplate.endOffsetTime=O),type:"text",class:"form-control-plaintext",id:"endOffsetTime",readonly:""},null,512),[[ee,g.selected.programTemplate.endOffsetTime]]),Z[21]||(Z[21]=e("label",{for:"endOffsetTime"},"End Offset",-1))])]),e("div",Q$,[e("div",J$,[q(e("input",{"onUpdate:modelValue":Z[8]||(Z[8]=O=>g.selected.programTemplate.durationTime=O),type:"text",class:"form-control-plaintext",id:"durationTime",readonly:""},null,512),[[ee,g.selected.programTemplate.durationTime]]),Z[22]||(Z[22]=e("label",{for:"durationTime"},"Clip Duration",-1))])])]),e("div",Z$,[e("div",X$,[e("div",eh,[q(e("input",{"onUpdate:modelValue":Z[9]||(Z[9]=O=>g.selected.programTemplate.adBreaksDurationTime=O),type:"text",class:"form-control-plaintext",id:"adBreaksDurationTime",readonly:""},null,512),[[ee,g.selected.programTemplate.adBreaksDurationTime]]),Z[23]||(Z[23]=e("label",{for:"adBreaksDurationTime"},"Ad Breaks Total Duration",-1))])]),e("div",th,[e("div",sh,[q(e("input",{"onUpdate:modelValue":Z[10]||(Z[10]=O=>g.selected.programTemplate.totalProgramTemplateDurationTime=O),type:"text",class:"form-control-plaintext",id:"totalProgramTemplateDurationTime",readonly:""},null,512),[[ee,g.selected.programTemplate.totalProgramTemplateDurationTime]]),Z[24]||(Z[24]=e("label",{for:"totalProgramTemplateDurationTime"},"Program Total Duration",-1))])])])])])])):x("",!0),g.selected.programTemplate&&g.selected.programTemplate.adBreaks.length>0?(t(),s("div",oh,[Z[27]||(Z[27]=e("div",{class:"d-flex flex-row justify-content-between"},[e("b",null," Ad Break ")],-1)),e("div",ah,[e("table",lh,[Z[26]||(Z[26]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Offset"),e("th",null,"Duration"),e("th",null,"VOD Source")])],-1)),e("tbody",null,[(t(!0),s(A,null,E(g.item.adBreaks,(O,me)=>(t(),s("tr",null,[e("td",null,c(me+1),1),e("td",null,c(o(L).moment.utc(O.offsetMillis).format("HH:mm:ss")),1),e("td",null,c(o(L).moment.utc(O.durationInMillis).format("HH:mm:ss")),1),e("td",null,[g.lookups.adBreakVodSources.length>0?(t(),s(A,{key:0},[q(e("select",{"onUpdate:modelValue":ue=>O.vodSourceId=ue,onChange:ue=>w(O),class:"form-select",id:"adBreakVodSourceId"},[(t(!0),s(A,null,E(g.lookups.adBreakVodSources,ue=>(t(),s(A,null,[ue.durationInMillis===O.durationInMillis?(t(),s("option",{key:0,value:ue.id}," ["+c(o(L).moment.utc(ue.durationInMillis).format("HH:mm:ss"))+"] "+c(ue.name),9,rh)):x("",!0)],64))),256))],40,nh),[[pe,O.vodSourceId]]),o(f).item.adBreaks.$each.$response?(t(!0),s(A,{key:0},E(o(f).item.adBreaks.$each.$response.$errors[me].vodSourceId,ue=>(t(),s("div",{key:ue,class:"d-block invalid-feedback"},c(ue.$message),1))),128)):x("",!0)],64)):x("",!0)])]))),256))])])])])):x("",!0)]))]),U.value?x("",!0):(t(),s("div",ih,[e("button",{disabled:o(f).$dirty&&o(f).$invalid,onClick:Z[11]||(Z[11]=O=>i(!0)),class:"btn btn-primary",type:"button"},Z[28]||(Z[28]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,dh),e("button",{onClick:Z[12]||(Z[12]=O=>i(!1)),class:"btn btn-secondary ms-1"},Z[29]||(Z[29]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))]))])]),F(Py,{ref_key:"modalSelectProgramTemplate",ref:u,onClose:D},null,512)],8,b$)]),_:1})}}},ch=["id"],mh={class:"modal-dialog modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},fh={class:"modal-content"},ph={class:"modal-header"},vh={class:"modal-title"},gh={class:"modal-body"},bh={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},yh=["innerHTML"],$h={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},hh={key:2,class:"container"},wh={class:"row row-cols-1 row-cols-sm-2"},_h={class:"col"},kh={class:"form-floating mb-2"},Sh={class:"col"},Th={class:"form-floating mb-2"},Ih={class:"row row-cols-1 row-cols-sm-3 mt-2"},Mh={class:"col"},xh={class:"form-floating mb-2"},Ch={class:"col"},Vh={class:"form-floating mb-2"},Ah={key:0,class:"d-block invalid-feedback"},Oh={class:"col"},Ph={class:"form-floating mb-2"},Uh={key:0,class:"d-block invalid-feedback"},Lh={class:"row row-cols-1 row-cols-sm-3"},Hh={class:"col"},Dh={class:"form-floating mb-2"},Eh={class:"col"},qh={class:"form-floating mb-2"},Bh={class:"col"},Nh={class:"form-floating mb-2"},Rh={class:"row row-cols-1 row-cols-sm-3"},Fh={class:"col"},zh={class:"form-floating mb-2"},Gh={class:"col"},jh={class:"form-floating mb-2"},Yh={key:0,class:"col"},Kh={class:"form-floating mb-2"},Wh={key:0},Qh={class:"table-responsive border mt-1"},Jh={class:"table table-sm mb-0"},Zh={class:"align-middle"},Xh=["onUpdate:modelValue","onChange"],ew=["value"],tw={class:"modal-footer"},sw=["disabled"],ft={__name:"_editProgram",props:{programId:{type:String,required:!0},dateScheduledStart:{type:String,required:!0}},emits:["confirm","cancel"],setup(r,{expose:b,emit:T}){const{appTitle:M,pageTitle:k,busy:H,isDirty:V,validations:Q,infoMessage:j,warningMessage:S,errorMessage:z,router:ae,axios:N,utils:L,toasts:n,closeWithReturnUrl:I,security:$}=he({appTitle:"Arcadian-FAST",pageTitle:"Edit Program"}),K=T,J=r,u=ge("modalEditProgram"),p=ye({lookups:{adBreakSourceLocations:[],adBreakVodSources:[]},item:{programTemplateId:null,name:null,relativeProgramId:null,dateScheduledStart:null,sourceLocationId:null,vodSource:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]}}),W={item:{name:{required:le.withMessage("Name is required.",re),$autoDirty:!0,$lazy:!0},dateScheduledStart:{required:le.withMessage("Date Scheduled Start is required.",re),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:le.withMessage("sourceLocationId is required.",re),$autoDirty:!0,$lazy:!0},vodSourceId:{required:le.withMessage("vodSourceId is required.",re),$autoDirty:!0,$lazy:!0},startOffsetMillis:{required:le.withMessage("startOffsetMillis is required.",re),minValue:Be(0),$autoDirty:!0,$lazy:!0},endOffsetMillis:{required:le.withMessage("endOffsetMillis is required.",re),minValue:Be(0),$autoDirty:!0,$lazy:!0}}},g=Te(W,p);fe(async()=>{g.value.$reset(),await G()});const G=async(l,a)=>{const h=p;Q.value.clear(),z.value="",h.lookups={adBreakSourceLocations:[],adBreakVodSources:[]},h.item=null,await f(),await m();var _=document.getElementById(u.value),v=_e.getOrCreateInstance(_);v.show()},y=async l=>{if(!l){var a=document.getElementById(u.value),h=_e.getOrCreateInstance(a);h.hide(),K("cancel");return}const _=p,v=L.moment(_.item.dateScheduledStart).utc().format(),B={programId:J.programId,name:_.item.name,dateScheduledStart:v,adBreaks:_.item.adBreaks.map(P=>({sourceLocationId:P.sourceLocationId,vodSourceId:P.vodSourceId,offsetMillis:P.offsetMillis,durationInMillis:P.durationInMillis}))};try{await N.put("/api/v1/programs/",B).then(X=>{n.success("Edit Program","Program was edited.")});var a=document.getElementById(u.value),h=_e.getOrCreateInstance(a);h.hide(),K("confirm")}catch(P){z.value=L.getErrorMessageAsHtml(P),window.scrollTo(0,0);return}finally{}},f=async()=>{try{const l=`/api/v1/programs/${J.programId}/`;await N.get(l).then(_=>{p.item=_.data;const v=p.item,w=L.moment(v.dateScheduledStart).format("YYYY-MM-DD HH:mm");p.item.dateScheduledStart=w,v.startOffsetTime=L.moment.utc(v.startOffsetMillis).format("HH:mm:ss"),v.endOffsetTime=L.moment.utc(v.endOffsetMillis).format("HH:mm:ss"),v.durationTime=L.moment.utc(v.durationInMillis).format("HH:mm:ss"),v.adBreaksDurationTime=L.moment.utc(v.adBreaksDurationInMillis).format("HH:mm:ss"),v.totalProgramTemplateDurationTime=L.moment.utc(v.totalProgramTemplateDurationInMillis).format("HH:mm:ss")});const a=p,h=a.item.channel.outputs[0].outputType;await i(a.item.sourceLocationId,h)}catch(l){z.value=L.getErrorMessageAsHtml(l),window.scrollTo(0,0)}finally{}},m=async()=>{},i=async(l,a)=>{try{let h=`/api/v1/vodsources/lookup/output-type/${a}`;await N.get(h).then(_=>{p.lookups.adBreakVodSources=_.data})}catch(h){z.value=L.getErrorMessageAsHtml(h),window.scrollTo(0,0)}finally{}},d=l=>{const a=p.lookups.adBreakVodSources.find(h=>h.id==l.vodSourceId);l.sourceLocationId=a.sourceLocationId};return b({open:G,close:y}),(l,a)=>(t(),s("div",{class:"modal show","data-bs-backdrop":"static","data-bs-keyboard":"false",id:u.value,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"false"},[e("div",mh,[e("div",fh,[e("div",ph,[e("h5",vh,[a[14]||(a[14]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Y(c(o(k)),1)]),e("button",{type:"button",class:"btn-close",onClick:a[0]||(a[0]=h=>y(!1)),"aria-label":"Close"})]),e("div",gh,[o(z)?(t(),s("div",bh,[a[15]||(a[15]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Y("Error ")],-1)),e("div",{innerHTML:o(z)},null,8,yh)])):x("",!0),o(Q).size>0?(t(),s("div",$h,[a[16]||(a[16]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Y("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(A,null,E(o(Q).values(),h=>(t(),s("li",null,c(h),1))),256))])])):x("",!0),p.item?(t(),s("div",hh,[e("div",wh,[e("div",_h,[e("div",kh,[p.item.sourceLocation?q((t(),s("input",{key:0,"onUpdate:modelValue":a[1]||(a[1]=h=>p.item.sourceLocation.name=h),id:"sourceLocation",class:"form-control-plaintext",readonly:""},null,512)),[[ee,p.item.sourceLocation.name]]):x("",!0),a[17]||(a[17]=e("label",{for:"sourceLocation",class:""},"Source Location",-1))])]),e("div",Sh,[e("div",Th,[p.item.vodSource?q((t(),s("input",{key:0,"onUpdate:modelValue":a[2]||(a[2]=h=>p.item.vodSource.name=h),id:"vodSource",class:"form-control-plaintext",readonly:""},null,512)),[[ee,p.item.vodSource.name]]):x("",!0),a[18]||(a[18]=e("label",{for:"vodSource",class:""},"VOD Source",-1))])])]),e("div",Ih,[e("div",Mh,[e("div",xh,[p.item.relativeProgram?q((t(),s("input",{key:0,"onUpdate:modelValue":a[3]||(a[3]=h=>p.item.relativeProgram.name=h),id:"relativeProgram",class:"form-control-plaintext",readonly:""},null,512)),[[ee,p.item.relativeProgram.name]]):x("",!0),a[19]||(a[19]=e("label",{for:"relativeProgram",class:""},"Relative Program",-1))])]),e("div",Ch,[e("div",Vh,[q(e("input",{"onUpdate:modelValue":a[4]||(a[4]=h=>p.item.name=h),id:"name",class:te([o(L).getValidFeedbackCss(p.item.name),"form-control"]),placeholder:"Name"},null,2),[[ee,p.item.name]]),a[20]||(a[20]=e("label",{for:"name",class:""},"Name",-1)),o(g).item.name.$error?(t(),s("div",Ah,[(t(!0),s(A,null,E(o(g).item.name.$errors,h=>(t(),s("div",{key:h.$uid},c(h.$message),1))),128))])):x("",!0)])]),e("div",Oh,[e("div",Ph,[q(e("input",{"onUpdate:modelValue":a[5]||(a[5]=h=>p.item.dateScheduledStart=h),type:"datetime-local",id:"dateScheduledStart",class:te([o(L).getValidFeedbackCss(p.item.dateScheduledStart),"form-control"])},null,2),[[ee,p.item.dateScheduledStart]]),a[21]||(a[21]=e("label",{for:"dateScheduledStart",class:""},"Date Scheduled Start",-1)),o(g).item.dateScheduledStart.$error?(t(),s("div",Uh,[(t(!0),s(A,null,E(o(g).item.dateScheduledStart.$errors,h=>(t(),s("div",{key:h.$uid},c(h.$message),1))),128))])):x("",!0)])])]),e("div",null,[e("div",Lh,[e("div",Hh,[e("div",Dh,[q(e("input",{"onUpdate:modelValue":a[6]||(a[6]=h=>p.item.startOffsetTime=h),id:"startOffsetTime",class:"form-control-plaintext",readonly:""},null,512),[[ee,p.item.startOffsetTime]]),a[22]||(a[22]=e("label",{for:"startOffsetTime",class:""},"Start Offset",-1))])]),e("div",Eh,[e("div",qh,[q(e("input",{"onUpdate:modelValue":a[7]||(a[7]=h=>p.item.endOffsetTime=h),id:"endOffsetTime",class:"form-control-plaintext",readonly:""},null,512),[[ee,p.item.endOffsetTime]]),a[23]||(a[23]=e("label",{for:"endOffsetTime",class:""},"End Offset",-1))])]),e("div",Bh,[e("div",Nh,[q(e("input",{"onUpdate:modelValue":a[8]||(a[8]=h=>p.item.durationTime=h),id:"durationTime",class:"form-control-plaintext",readonly:""},null,512),[[ee,p.item.durationTime]]),a[24]||(a[24]=e("label",{for:"durationTime",class:""},"Clip Duration",-1))])])]),e("div",Rh,[e("div",Fh,[e("div",zh,[q(e("input",{"onUpdate:modelValue":a[9]||(a[9]=h=>p.item.adBreaksDurationTime=h),id:"adBreaksDurationTime",class:"form-control-plaintext",readonly:""},null,512),[[ee,p.item.adBreaksDurationTime]]),a[25]||(a[25]=e("label",{for:"adBreaksDurationTime",class:""},"Total Ad Breaks Duration",-1))])]),e("div",Gh,[e("div",jh,[q(e("input",{"onUpdate:modelValue":a[10]||(a[10]=h=>p.item.totalProgramTemplateDurationTime=h),id:"totalProgramTemplateDurationTime",class:"form-control-plaintext",readonly:""},null,512),[[ee,p.item.totalProgramTemplateDurationTime]]),a[26]||(a[26]=e("label",{for:"totalProgramTemplateDurationTime",class:""},"Total Program Duration",-1))])]),p.item.relativeProgram?(t(),s("div",Yh,[e("div",Kh,[q(e("input",{"onUpdate:modelValue":a[11]||(a[11]=h=>p.item.relativeProgram.name=h),id:"relativeProgram",class:"form-control-plaintext",readonly:""},null,512),[[ee,p.item.relativeProgram.name]]),a[27]||(a[27]=e("label",{for:"relativeProgram",class:""},"Relative Program",-1))])])):x("",!0)])]),a[30]||(a[30]=e("hr",null,null,-1)),p.item?(t(),s("div",Wh,[a[29]||(a[29]=e("div",{class:"d-flex flex-row justify-content-between"},[e("fieldset",null,[e("legend",null," Ad Breaks ")])],-1)),e("div",Qh,[e("table",Jh,[a[28]||(a[28]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Offset"),e("th",null,"Duration"),e("th",null,"VOD Source")])],-1)),e("tbody",null,[(t(!0),s(A,null,E(p.item.adBreaks,(h,_)=>(t(),s("tr",Zh,[e("td",null,c(_+1),1),e("td",null,c(o(L).moment.utc(h.offsetMillis).format("HH:mm:ss")),1),e("td",null,c(o(L).moment.utc(h.durationInMillis).format("HH:mm:ss")),1),e("td",null,[q(e("select",{"onUpdate:modelValue":v=>h.vodSourceId=v,onChange:v=>d(h),class:"form-select",id:"adBreakVodSourceId"},[(t(!0),s(A,null,E(p.lookups.adBreakVodSources,v=>(t(),s(A,null,[v.durationInMillis===h.durationInMillis?(t(),s("option",{key:0,value:v.id}," ["+c(o(L).moment.utc(v.durationInMillis).format("HH:mm:ss"))+"] "+c(v.name),9,ew)):x("",!0)],64))),256))],40,Xh),[[pe,h.vodSourceId]])])]))),256))])])])])):x("",!0)])):x("",!0)]),e("div",tw,[e("button",{disabled:o(g).$dirty&&o(g).$invalid,onClick:a[12]||(a[12]=h=>y(!0)),class:"btn btn-primary ms-2",type:"button"},a[31]||(a[31]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,sw),e("button",{onClick:a[13]||(a[13]=h=>y(!1)),class:"btn btn-secondary ms-1"},a[32]||(a[32]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])])],8,ch))}},ow={class:"input-group"},aw=["value"],lw={class:"card m-1"},nw={class:"p-2"},rw={__name:"index",props:{id:{type:String,required:!0},urlView:{type:String,default:"/channels/view"},urlMain:{type:String,default:"/channels"}},setup(r){const{appTitle:b,pageTitle:T,busy:M,infoMessage:k,warningMessage:H,errorMessage:V,router:Q,axios:j,utils:S,toasts:z,close:ae,closeWithReturnUrl:N,security:L}=he({appTitle:"Arcadian-FAST",pageTitle:"Schedule Channel Programs"}),n=r,I=ge(null),$={viewType:"Week",cellDuration:15,heightSpec:"Full",startDate:Ge.DayPilot.Date.today(),onTimeRangeSelected:i=>{var d=i.control;const l={start:i.start,end:i.end,id:Ge.DayPilot.guid(),text:"NEW",tags:{type:"new"}};d.events.add(l);var a=d.events.find(l.id);g(a)},onBeforeEventRender:i=>{},eventDeleteHandling:"Disabled",onEventMoved:async i=>{const d=i.newStart.value,l=i.e.id();let a=S.moment(d).utc(!0).format();if(u.selectedTimezone){debugger;a=S.moment(d).tz(u.selectedTimezone).utc().format()}try{let h="/api/v1/programs/scheduled-date-start";const _={programId:l,dateScheduledStart:a};await j.put(h,_).then(v=>{z.success("Program date scheduled start was edited.")})}catch(h){V.value=S.getErrorMessageAsHtml(h),window.scrollTo(0,0);return}finally{}await p()},onEventResized:()=>{console.log("Event resized")},onEventClicked:async i=>{var d=i.e.id();G(d)},contextMenu:new Ge.DayPilot.Menu([{text:"Clone",onClick:async i=>{const d=i.source.id();try{let l=`/api/v1/programs/${d}/clone`;await j.post(l).then(a=>{z.success("Clone Program","Program was cloned.")})}catch(l){V.value=S.getErrorMessageAsHtml(l),window.scrollTo(0,0);return}finally{await p()}}},{text:"Delete",onClick:async i=>{if(!confirm("Do you want to remove this program?"))return;const l=i.source.id();try{let a=`/api/v1/programs/${l}/`;await j.delete(a).then(h=>{z.success("Delete Program","Program was deleted.")}),I.value.control.events.remove(i.source)}catch(a){V.value=S.getErrorMessageAsHtml(a),window.scrollTo(0,0);return}finally{await p()}}}])},K=ge([]),J=()=>{I.value.control.update({events:K.value})},u=ye({lookups:{visibilityTypes:[],timezones:[{id:"",name:"UTC"},{id:"America/Los_Angeles",name:"(-07:00) America/Los_Angeles"},{id:"Asia/Manila",name:"(+08:00) Asia/Manila"},{id:"Australia/Brisbane",name:"(+10:00) Australia/Brisbane"},{id:"Europe/Berlin",name:"(+02:00) Europe/Berlin"},{id:"Pacific/Honolulu",name:"(-10:00) Pacific/Honolulu"}]},editorElementId:"editor",item:{userId:null,givenName:null,surname:null,displayName:null,email:null,mobilePhone:null,jobTitle:null},selectedTimezone:"",displayUtc:!1});fe(async()=>{u.selectedTimezone=localStorage.getItem("selectedTimezone")||"",await p()});const p=async()=>{await W(),await J()},W=async()=>{const i=u;if(!M.value)try{M.value=!0,V.value="";const d=`/api/v1/channels/${n.id}/`;await j.get(d).then(l=>{i.item=l.data;const a=i.item.outputs,h=i.item.programs.map(_=>{let v=`${_.name}`,B=`[${_.name}]`,P=S.moment(_.dateScheduledStart).utc(!1).format(),w=S.moment(_.dateScheduledEnd).utc(!1).format();const D=u.selectedTimezone;return D&&(P=S.moment(_.dateScheduledStart).tz(D).utc(!0).format(),w=S.moment(_.dateScheduledEnd).tz(D).utc(!0).format()),{start:P,end:w,id:_.programId,text:v,html:_.arn?`<div><span class="fas fa-fw fa-check-circle text-success me-1"></span>${v}</div>`:v,toolTip:B,backColor:_.arn?"azure":null,barColor:_.arn?"green":null}});K.value=h})}catch(d){V.value=S.getErrorMessageAsHtml(d),window.scrollTo(0,0)}finally{M.value=!1}},g=async i=>{const d=Ae(uh,{channelId:n.id,eventId:i.id(),dateScheduledStart:i.start().value,timezone:u.selectedTimezone},{chore:!0,keepInitial:!1}),{data:l,isCanceled:a}=await d.reveal();d.closeAll(),!a&&l&&await p()},G=async i=>{const d=Ae(ft,{programId:i},{chore:!0,keepInitial:!1}),{data:l,isCanceled:a}=await d.reveal();d.closeAll(),a||await p()},y=async()=>{localStorage.setItem("selectedTimezone",u.selectedTimezone),await p()},f=()=>{const i=I.value;i.control.startDate=i.control.startDate.addDays(-7),i.control.update()},m=()=>{const i=I.value;i.control.startDate=i.control.startDate.addDays(7),i.control.update()};return(i,d)=>{const l=oe("PageHeader"),a=oe("PageBody");return t(),be($e,null,{default:R(()=>[e("div",null,[F(l,{"page-icon":"fas fa-fw fa-calendar-plus",pageTitle:o(T)},{default:R(()=>[e("div",ow,[d[6]||(d[6]=e("span",{class:"input-group-text fw-bold"},"Timezone",-1)),q(e("select",{"onUpdate:modelValue":d[0]||(d[0]=h=>u.selectedTimezone=h),onChange:d[1]||(d[1]=h=>y()),class:"form-select"},[(t(!0),s(A,null,E(u.lookups.timezones,h=>(t(),s("option",{value:h.id},c(h.name),9,aw))),256))],544),[[pe,u.selectedTimezone]])]),e("button",{onClick:d[2]||(d[2]=h=>p()),class:"btn btn-secondary ms-2"},d[7]||(d[7]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)])),e("button",{onClick:d[3]||(d[3]=h=>o(N)(`${r.urlView}/${r.id}`)),class:"btn btn-secondary ms-1"},d[8]||(d[8]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),F(a,{errorMessage:o(V)},{default:R(()=>[e("div",lw,[e("div",nw,[e("button",{onClick:d[4]||(d[4]=h=>f()),class:"btn btn-sm btn-outline-info"},"Previous"),d[9]||(d[9]=Y(" | ")),e("button",{onClick:d[5]||(d[5]=h=>m()),class:"btn btn-sm btn-outline-info"},"Next")]),F(o(Ge.DayPilotCalendar),{id:"dp",config:$,ref_key:"calendarRef",ref:I},null,512)])]),_:1},8,["errorMessage"])])]),_:1})}}},iw=["id"],dw={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},uw={class:"modal-content"},cw={class:"modal-header"},mw={class:"modal-title"},fw={class:"modal-body"},pw={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},vw=["innerHTML"],gw={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},bw={class:"container"},yw={class:"row row-cols-1 row-cols-sm-3"},$w={class:"col"},hw={class:"form-floating mb-2"},ww=["disabled"],_w=["value"],kw={class:"col"},Sw={class:"form-floating mb-2"},Tw={key:0,class:"d-block invalid-feedback"},Iw={class:"col"},Mw={class:"form-floating mb-2"},xw={key:0,class:"d-block invalid-feedback"},Cw={class:"row row-cols-sm-2"},Vw={class:"col"},Aw={class:"form-floating mb-2"},Ow=["value"],Pw={key:0,class:"d-block invalid-feedback"},Uw={class:"col"},Lw={class:"form-floating mb-2"},Hw=["value"],Dw={key:0,class:"d-block invalid-feedback"},Ew={class:"col"},qw={class:"input-group mb-1"},Bw={class:"form-floating"},Nw={key:0,class:"input-group-text"},Rw={key:0},Fw={key:1},zw={key:2},Gw={key:3,class:"d-block invalid-feedback"},jw={class:"col"},Yw={class:"input-group mb-1"},Kw={class:"form-floating"},Ww={key:0,class:"input-group-text"},Qw={key:0},Jw={key:1},Zw={key:2,class:"d-block invalid-feedback"},Xw={class:"table-responsive border mt-1"},e_={class:"table"},t_={class:"input-group mb-1"},s_=["onUpdate:modelValue"],o_={key:0,class:"input-group-text"},a_=["onUpdate:modelValue"],l_=["value"],n_=["onUpdate:modelValue"],r_=["value"],i_=["onClick"],d_={class:"modal-footer"},u_=["disabled"],c_={__name:"_addProgram",emits:["refresh"],setup(r,{expose:b,emit:T}){const{appTitle:M,pageTitle:k,busy:H,isDirty:V,validations:Q,infoMessage:j,warningMessage:S,errorMessage:z,router:ae,axios:N,utils:L,toasts:n,closeWithReturnUrl:I,security:$}=he({appTitle:"Arcadian-FAST",pageTitle:"Add Program"}),K=T,J=ge(),u=ge("modalAddProgram"),p=ye({lookups:{sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[],channelPrograms:[]},item:{name:null,relativeProgramId:null,dateScheduledStart:null,sourceLocationId:null,vodSource:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]}}),W={item:{name:{required:le.withMessage("Name is required.",re),$autoDirty:!0,$lazy:!0},dateScheduledStart:{required:le.withMessage("Date Scheduled Start is required.",re),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:le.withMessage("sourceLocationId is required.",re),$autoDirty:!0,$lazy:!0},vodSourceId:{required:le.withMessage("vodSourceId is required.",re),$autoDirty:!0,$lazy:!0},startOffsetMillis:{required:le.withMessage("startOffsetMillis is required.",re),minValue:Be(0),$autoDirty:!0,$lazy:!0},endOffsetMillis:{required:le.withMessage("endOffsetMillis is required.",re),minValue:Be(0),$autoDirty:!0,$lazy:!0}}},g=Te(W,p);fe(async()=>{g.value.$reset()});const G=async P=>{J.value=P;const w=p;Q.value.clear(),z.value="";const D=L.moment().local().add(2,"m"),U=D.format("YYYY-MM-DD HH:mm"),ne=D.format("YYYY_MM_DD")+"_PROGRAM_";w.lookups={sourceLocations:[],vodSources:[],adBreakSourceLocations:[],adBreakVodSources:[],channelPrograms:[]},w.item={name:ne,relativeProgramId:null,dateScheduledStart:U,sourceLocationId:null,vodSource:null,vodSourceId:null,startOffsetMillis:0,endOffsetMillis:0,adBreaks:[]},await m(),g.value.$reset();var Z=document.getElementById(u.value),se=_e.getOrCreateInstance(Z);se.show()},y=async()=>{var P=document.getElementById(u.value),w=_e.getOrCreateInstance(P);w.hide(),K("refresh")},f=async()=>{const P=p;if(H.value)return;if(!await g.value.$validate()){window.scrollTo(0,0);return}try{H.value=!0,z.value="";const X=P.item;delete X.vodSource,X.channelId=J.value;var D=X.dateScheduledStart;X.dateScheduledStart=L.moment(D).utc().format(),await N.post("/api/v1/programs/",X).then(U=>{n.success("Add Program","Program added to Channel",{async onClose(){}})}),await y()}catch(X){z.value=L.getErrorMessageAsHtml(X),window.scrollTo(0,0)}finally{H.value=!1}},m=async()=>{await i(),await l(),await h()},i=async()=>{try{await N.get("/api/v1/sourcelocations/lookup/").then(w=>{p.lookups.sourceLocations=w.data,p.lookups.sourceLocations.length===1&&(p.item.sourceLocationId=p.lookups.sourceLocations[0].id)}),p.item.sourceLocationId&&await d(p.item.sourceLocationId)}catch(P){z.value=L.getErrorMessageAsHtml(P),window.scrollTo(0,0)}finally{}},d=async P=>{try{let w=`/api/v1/vodSources/lookup/source-location/${P}`;await N.get(w).then(D=>{p.lookups.vodSources=D.data})}catch(w){z.value=L.getErrorMessageAsHtml(w),window.scrollTo(0,0)}finally{}},l=async()=>{try{await N.get("/api/v1/sourcelocations/lookup/").then(w=>{p.lookups.adBreakSourceLocations=w.data})}catch(P){z.value=L.getErrorMessageAsHtml(P),window.scrollTo(0,0)}finally{}},a=async P=>{try{let w=`/api/v1/vodSources/lookup/source-location/${P}`;await N.get(w).then(D=>{p.lookups.adBreakVodSources=D.data})}catch(w){z.value=L.getErrorMessageAsHtml(w),window.scrollTo(0,0)}finally{}},h=async()=>{try{const P=`/api/v1/programs/lookup/?channelId=${J.value}`;await N.get(P).then(w=>{if(p.lookups.channelPrograms=w.data,p.lookups.channelPrograms.length===1){const X=p.lookups.channelPrograms[0];p.item.relativeProgramId=X.id}})}catch(P){z.value=L.getErrorMessageAsHtml(P),window.scrollTo(0,0)}finally{}},_=()=>{const P={offsetMillis:0,sourceLocationId:null,vodSourceId:null},w=p.item.adBreaks.length;if(w>0){const D=p.item.adBreaks[w-1];P.offsetMillis=D.offsetMillis+1e4}p.item.adBreaks.push(P)},v=P=>{p.item.adBreaks.splice(P,1)},B=()=>{const P=p.item.vodSource;p.item.vodSourceId=P.id};return b({open:G,close:y}),(P,w)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:u.value,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[e("div",dw,[e("div",uw,[e("div",cw,[e("h5",mw,[w[12]||(w[12]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Y(c(o(k)),1)]),e("button",{type:"button",class:"btn-close",onClick:w[0]||(w[0]=D=>y()),"aria-label":"Close"})]),e("div",fw,[o(z)?(t(),s("div",pw,[w[13]||(w[13]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Y("Error ")],-1)),e("div",{innerHTML:o(z)},null,8,vw)])):x("",!0),o(Q).size>0?(t(),s("div",gw,[w[14]||(w[14]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Y("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(A,null,E(o(Q).values(),D=>(t(),s("li",null,c(D),1))),256))])])):x("",!0),e("div",bw,[e("div",yw,[e("div",$w,[e("div",hw,[q(e("select",{"onUpdate:modelValue":w[1]||(w[1]=D=>p.item.relativeProgramId=D),class:"form-select",id:"sourceLocationId",disabled:p.lookups.channelPrograms.length<=0},[(t(!0),s(A,null,E(p.lookups.channelPrograms,D=>(t(),s("option",{value:D.id},c(D.name),9,_w))),256))],8,ww),[[pe,p.item.relativeProgramId]]),w[15]||(w[15]=e("label",{for:"relativeProgramId",class:""},"Relative Program",-1))])]),e("div",kw,[e("div",Sw,[q(e("input",{"onUpdate:modelValue":w[2]||(w[2]=D=>p.item.name=D),id:"name",class:"form-control",placeholder:"Name"},null,512),[[ee,p.item.name]]),w[16]||(w[16]=e("label",{for:"name",class:""},"Name",-1)),o(g).item.name.$error?(t(),s("div",Tw,[(t(!0),s(A,null,E(o(g).item.name.$errors,D=>(t(),s("div",{key:D.$uid},c(D.$message),1))),128))])):x("",!0)])]),e("div",Iw,[e("div",Mw,[q(e("input",{"onUpdate:modelValue":w[3]||(w[3]=D=>p.item.dateScheduledStart=D),type:"datetime-local",id:"dateScheduledStart",class:"form-control"},null,512),[[ee,p.item.dateScheduledStart]]),w[17]||(w[17]=e("label",{for:"dateScheduledStart",class:""},"Date Scheduled Start",-1)),o(g).item.dateScheduledStart.$error?(t(),s("div",xw,[(t(!0),s(A,null,E(o(g).item.dateScheduledStart.$errors,D=>(t(),s("div",{key:D.$uid},c(D.$message),1))),128))])):x("",!0)])])]),e("div",Cw,[e("div",Vw,[e("div",Aw,[q(e("select",{"onUpdate:modelValue":w[4]||(w[4]=D=>p.item.sourceLocationId=D),onChange:w[5]||(w[5]=D=>d(p.item.sourceLocationId)),class:"form-select",id:"sourceLocationId"},[(t(!0),s(A,null,E(p.lookups.sourceLocations,D=>(t(),s("option",{value:D.id},c(D.name),9,Ow))),256))],544),[[pe,p.item.sourceLocationId]]),w[18]||(w[18]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o(g).item.sourceLocationId.$error?(t(),s("div",Pw,[(t(!0),s(A,null,E(o(g).item.sourceLocationId.$errors,D=>(t(),s("div",{key:D.$uid},c(D.$message),1))),128))])):x("",!0)])]),e("div",Uw,[e("div",Lw,[q(e("select",{"onUpdate:modelValue":w[6]||(w[6]=D=>p.item.vodSource=D),onChange:w[7]||(w[7]=D=>B()),class:"form-select",id:"vodSourceId"},[(t(!0),s(A,null,E(p.lookups.vodSources,D=>(t(),s("option",{value:D},c(D.name),9,Hw))),256))],544),[[pe,p.item.vodSource]]),w[19]||(w[19]=e("label",{for:"vodSourceId",class:""},"VOD Source",-1)),o(g).item.vodSourceId.$error?(t(),s("div",Dw,[(t(!0),s(A,null,E(o(g).item.vodSourceId.$errors,D=>(t(),s("div",{key:D.$uid},c(D.$message),1))),128))])):x("",!0)])]),e("div",Ew,[e("div",qw,[e("div",Bw,[q(e("input",{"onUpdate:modelValue":w[8]||(w[8]=D=>p.item.startOffsetMillis=D),id:"startOffsetMillis",type:"number",class:"form-control",placeholder:"Start OffSet Millis"},null,512),[[ee,p.item.startOffsetMillis]]),w[20]||(w[20]=e("label",{for:"startOffsetMillis",class:""},"Start OffSet Millis",-1))]),p.item.startOffsetMillis>0?(t(),s("span",Nw,c(o(L).moment.utc(p.item.startOffsetMillis).format("HH:mm:ss")),1)):x("",!0)]),p.item.startOffsetMillis>0&&p.item.startOffsetMillis<3e4?(t(),s("div",Rw,w[21]||(w[21]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset must be at least 30 seconds ",-1)]))):x("",!0),p.item.startOffsetMillis>p.item.endOffsetMillis&&p.item.endOffsetMillis>0?(t(),s("div",Fw,w[22]||(w[22]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Exceeds End Offset Millis ",-1)]))):x("",!0),p.item.vodSource&&p.item.startOffsetMillis>p.item.vodSource.durationInMillis?(t(),s("div",zw,w[23]||(w[23]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," Start Offset Millis Exceeds VOD Source Duration ",-1)]))):x("",!0),o(g).item.startOffsetMillis.$error?(t(),s("div",Gw,[(t(!0),s(A,null,E(o(g).item.startOffsetMillis.$errors,D=>(t(),s("div",{key:D.$uid},c(D.$message),1))),128))])):x("",!0)]),e("div",jw,[e("div",Yw,[e("div",Kw,[q(e("input",{"onUpdate:modelValue":w[9]||(w[9]=D=>p.item.endOffsetMillis=D),id:"endOffsetMillis",type:"number",class:"form-control",placeholder:"End OffSet Millis"},null,512),[[ee,p.item.endOffsetMillis]]),w[24]||(w[24]=e("label",{for:"endOffsetMillis",class:""},"End OffSet Millis",-1))]),p.item.endOffsetMillis>0?(t(),s("span",Ww,c(o(L).moment.utc(p.item.endOffsetMillis).format("HH:mm:ss")),1)):x("",!0)]),p.item.endOffsetMillis>0&&p.item.endOffsetMillis<3e4?(t(),s("div",Qw,w[25]||(w[25]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset must be at least 30 seconds ",-1)]))):x("",!0),p.item.vodSource&&p.item.endOffsetMillis>p.item.vodSource.durationInMillis?(t(),s("div",Jw,w[26]||(w[26]=[e("span",{class:"fas fa-fw fa-triangle-exclamation text-warning"},null,-1),e("span",{class:"text-warning"}," End Offset Millis Exceeds VOD Source Duration ",-1)]))):x("",!0),o(g).item.endOffsetMillis.$error?(t(),s("div",Zw,[(t(!0),s(A,null,E(o(g).item.endOffsetMillis.$errors,D=>(t(),s("div",{key:D.$uid},c(D.$message),1))),128))])):x("",!0)])]),w[30]||(w[30]=e("hr",null,null,-1)),e("div",null,[e("div",{class:"d-flex flex-row justify-content-between"},[w[27]||(w[27]=e("fieldset",null,[e("legend",null," Ad Break ")],-1)),e("button",{onClick:_,class:"btn btn-outline-primary"}," Insert Ad Break ")]),e("div",Xw,[e("table",e_,[w[29]||(w[29]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Offset Millis"),e("th",null,"Source Location"),e("th",null,"VOD Source"),e("th")])],-1)),e("tbody",null,[(t(!0),s(A,null,E(p.item.adBreaks,(D,X)=>(t(),s("tr",null,[e("td",null,c(X+1),1),e("td",null,[e("div",t_,[q(e("input",{"onUpdate:modelValue":U=>D.offsetMillis=U,type:"number",class:"form-control",placeholder:"Enter Offset Millis..."},null,8,s_),[[ee,D.offsetMillis]]),D.offsetMillis>0?(t(),s("span",o_,c(o(L).moment.utc(D.offsetMillis).format("HH:mm:ss")),1)):x("",!0)])]),e("td",null,[q(e("select",{"onUpdate:modelValue":U=>D.sourceLocationId=U,onChange:w[10]||(w[10]=U=>a(p.item.sourceLocationId)),class:"form-select",id:"adBreakSourceLocationId"},[(t(!0),s(A,null,E(p.lookups.adBreakSourceLocations,U=>(t(),s("option",{value:U.id},c(U.name),9,l_))),256))],40,a_),[[pe,D.sourceLocationId]])]),e("td",null,[q(e("select",{"onUpdate:modelValue":U=>D.vodSourceId=U,class:"form-select",id:"adBreakVodSourceId"},[(t(!0),s(A,null,E(p.lookups.adBreakVodSources,U=>(t(),s("option",{value:U.id},c(U.name),9,r_))),256))],8,n_),[[pe,D.vodSourceId]])]),e("td",null,[e("button",{onClick:U=>v(X),class:"btn btn-outline-warning"},w[28]||(w[28]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,i_)])]))),256))])])])])])]),e("div",d_,[e("button",{disabled:o(g).$dirty&&o(g).$invalid,onClick:w[11]||(w[11]=D=>f()),class:"btn btn-primary",type:"button"},w[31]||(w[31]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,u_),w[32]||(w[32]=e("button",{"data-bs-dismiss":"modal",class:"btn btn-secondary ms-1"},[e("span",{class:"fas fa-fw fa-times"})],-1))])])])],8,iw))}},m_=["id"],f_={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},p_={class:"modal-content"},v_={class:"modal-header"},g_={class:"modal-title"},b_={class:"modal-body"},y_={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},$_=["innerHTML"],h_={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},w_={class:"container"},__={class:"col"},k_={class:"form-floating mb-2"},S_={class:"col"},T_={class:"form-floating mb-2"},I_={key:0,class:"d-block invalid-feedback"},M_={class:"col"},x_={class:"form-floating mb-2 d-none"},C_={key:0,class:"d-block invalid-feedback"},V_={class:"col"},A_={class:"form-floating mb-2"},O_={key:0,class:"d-block invalid-feedback"},P_={class:"modal-footer"},U_=["disabled"],L_={__name:"_addPlaybackConfiguration",props:{channelOutputId:{type:String,required:!0},playbackUrl:{type:String,required:!0}},emits:["confirm","cancel"],setup(r,{expose:b,emit:T}){const{appTitle:M,pageTitle:k,busy:H,isDirty:V,validations:Q,infoMessage:j,warningMessage:S,errorMessage:z,router:ae,axios:N,utils:L,toasts:n,closeWithReturnUrl:I,security:$}=he({appTitle:"Arcadian-FAST",pageTitle:"Add Channel Output Playback Configuration"}),K=T,J=r,u=ge("modalAddPlaybackConfiguration"),p=ye({lookups:{},item:{name:null,adDecisionServerUrl:null,videoContentSourceUrl:null}}),W={item:{name:{required:le.withMessage("Name is required.",re),$autoDirty:!0,$lazy:!0},adDecisionServerUrl:{required:le.withMessage("adDecisionServerUrl is required.",re),$autoDirty:!0,$lazy:!0},videoContentSourceUrl:{required:le.withMessage("videoContentSourceUrl is required.",re),$autoDirty:!0,$lazy:!0}}},g=Te(W,p);fe(async()=>{g.value.$reset(),await G()});const G=async()=>{const m=p;Q.value.clear(),z.value="";debugger;const i=J.playbackUrl;let d=i.lastIndexOf("/");const l=i.substring(0,d);let a=i.substring(d+1);d=a.lastIndexOf("."),a=a.substring(0,d)+"_ADCAMPAIGN_",m.item={name:a,originalVideoContentSourceUrl:J.playbackUrl,videoContentSourceUrl:l,adDecisionServerUrl:"https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=/124319096/external/ad_rule_samples&ciu_szs=300x250&ad_rule=1&impl=s&gdfp_req=1&env=vp&output=vmap&unviewed_position_start=1&cust_params=deployment%3Ddevsite%26sample_ar%3Dpremidpost&cmsid=496&vid=short_onecue&correlator=[avail.random]"},g.value.$reset();var h=document.getElementById(u.value),_=_e.getOrCreateInstance(h);_.show()},y=async()=>{var m=document.getElementById(u.value),i=_e.getOrCreateInstance(m);i.hide(),K("cancel")},f=async()=>{const m=p;if(H.value)return;if(!await g.value.$validate()){window.scrollTo(0,0);return}try{H.value=!0,z.value="";const a=m.item;a.channelOutputId=J.channelOutputId,await N.put("/api/v1/channelOutputs/playback/",a).then(h=>{n.success("Add Channel Output Playback Configuration","Channel Output playback configuration added.",{async onClose(){}})});var d=document.getElementById(u.value),l=_e.getOrCreateInstance(d);l.hide(),K("confirm")}catch(a){z.value=L.getErrorMessageAsHtml(a),window.scrollTo(0,0)}finally{H.value=!1}};return b({open:G,close:y}),(m,i)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:u.value,tabindex:"-1","aria-hidden":"false"},[e("div",f_,[e("div",p_,[e("div",v_,[e("h5",g_,[i[6]||(i[6]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Y(c(o(k)),1)]),e("button",{type:"button",class:"btn-close",onClick:i[0]||(i[0]=d=>y()),"aria-label":"Close"})]),e("div",b_,[o(z)?(t(),s("div",y_,[i[7]||(i[7]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Y("Error ")],-1)),e("div",{innerHTML:o(z)},null,8,$_)])):x("",!0),o(Q).size>0?(t(),s("div",h_,[i[8]||(i[8]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Y("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(A,null,E(o(Q).values(),d=>(t(),s("li",null,c(d),1))),256))])])):x("",!0),e("div",w_,[e("div",__,[e("div",k_,[q(e("textarea",{"onUpdate:modelValue":i[1]||(i[1]=d=>p.item.originalVideoContentSourceUrl=d),id:"originalVideoContentSourceUrl",class:"form-control",style:{height:"5rem"},placeholder:"originalVideoContentSourceUrl",readonly:""},null,512),[[ee,p.item.originalVideoContentSourceUrl]]),i[9]||(i[9]=e("label",{for:"originalVideoContentSourceUrl",class:""},"Original Video Content Source Url",-1))])]),e("div",S_,[e("div",T_,[q(e("input",{"onUpdate:modelValue":i[2]||(i[2]=d=>p.item.name=d),id:"name",class:"form-control",placeholder:"Name"},null,512),[[ee,p.item.name]]),i[10]||(i[10]=e("label",{for:"name",class:""},"Name",-1)),o(g).item.name.$error?(t(),s("div",I_,[(t(!0),s(A,null,E(o(g).item.name.$errors,d=>(t(),s("div",{key:d.$uid},c(d.$message),1))),128))])):x("",!0)])]),e("div",M_,[e("div",x_,[q(e("input",{"onUpdate:modelValue":i[3]||(i[3]=d=>p.item.videoContentSourceUrl=d),id:"videoContentSourceUrl",class:"form-control",placeholder:"videoContentSourceUrl"},null,512),[[ee,p.item.videoContentSourceUrl]]),i[11]||(i[11]=e("label",{for:"videoContentSourceUrl",class:""},"Video Content Source Url",-1)),i[12]||(i[12]=e("div",null,[e("span",{class:"fas fa-fw fa-info-circle"}),e("span",{class:"text-info small"},"The URL prefix for the parent manifest for the stream, minus the asset ID")],-1)),o(g).item.videoContentSourceUrl.$error?(t(),s("div",C_,[(t(!0),s(A,null,E(o(g).item.videoContentSourceUrl.$errors,d=>(t(),s("div",{key:d.$uid},c(d.$message),1))),128))])):x("",!0)])]),e("div",V_,[e("div",A_,[q(e("textarea",{"onUpdate:modelValue":i[4]||(i[4]=d=>p.item.adDecisionServerUrl=d),id:"adDecisionServerUrl",class:"form-control",placeholder:"adDecisionServerUrl",style:{height:"10rem"}},null,512),[[ee,p.item.adDecisionServerUrl]]),i[13]||(i[13]=e("label",{for:"adDecisionServerUrl",class:""},"Ad Decision Server Url",-1)),o(g).item.adDecisionServerUrl.$error?(t(),s("div",O_,[(t(!0),s(A,null,E(o(g).item.adDecisionServerUrl.$errors,d=>(t(),s("div",{key:d.$uid},c(d.$message),1))),128))])):x("",!0),i[14]||(i[14]=Xe('<div class="mt-2 ms-3"><span class="fas fa-fw fa-info-circle text-info"></span><span class="small">Sample value for the Ad Decision Server Url</span><div class="form-floating mb-2"><textarea class="form-control" style="height:4rem;" readonly>https://basil79.github.io/vast-sample-tags/pg/vast.xml</textarea><label for="" class="">Sample VAST 1</label></div><div class="form-floating mb-2"><textarea class="form-control" style="height:4rem;" readonly>https://basil79.github.io/vast-sample-tags/rama/vast.xml</textarea><label for="" class="">Sample VAST 2</label></div><div class="form-floating mb-2"><textarea class="form-control" style="height:8rem;" readonly>https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&amp;iu=/124319096/external/ad_rule_samples&amp;ciu_szs=300x250&amp;ad_rule=1&amp;impl=s&amp;gdfp_req=1&amp;env=vp&amp;output=vmap&amp;unviewed_position_start=1&amp;cust_params=deployment%3Ddevsite%26sample_ar%3Dpremidpost&amp;cmsid=496&amp;vid=short_onecue&amp;correlator=[avail.random]</textarea><label for="" class="">Sample VMAP 1</label></div><div class="form-floating mb-2"><textarea class="form-control" style="height:8rem;" readonly>https://pubads.g.doubleclick.net/gampad/ads?iu=/21775744923/external/single_ad_samples&amp;sz=640x480&amp;cust_params=sample_ct%3Dlinear&amp;ciu_szs=300x250%2C728x90&amp;gdfp_req=1&amp;output=vast&amp;unviewed_position_start=1&amp;env=vp&amp;impl=s&amp;correlator=</textarea><label for="" class="">Sample VMAP 2 (Linear)</label></div><div class="form-floating mb-2"><textarea class="form-control" style="height:8rem;" readonly>https://pubads.g.doubleclick.net/gampad/ads?iu=/21775744923/external/single_preroll_skippable&amp;sz=640x480&amp;ciu_szs=300x250%2C728x90&amp;gdfp_req=1&amp;output=vast&amp;unviewed_position_start=1&amp;env=vp&amp;impl=s&amp;correlator=</textarea><label for="" class="">Sample VMAP 3 (Skippable)</label></div></div>',1))])])])]),e("div",P_,[e("button",{disabled:o(g).$dirty&&o(g).$invalid,onClick:i[5]||(i[5]=d=>f()),class:"btn btn-primary",type:"button"},i[15]||(i[15]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,U_),i[16]||(i[16]=e("button",{"data-bs-dismiss":"modal",class:"btn btn-secondary ms-1"},[e("span",{class:"fas fa-fw fa-times"})],-1))])])])],8,m_))}},H_=["id"],D_={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},E_={class:"modal-content"},q_={class:"modal-header"},B_={class:"modal-title"},N_={class:"modal-body"},R_={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},F_=["innerHTML"],z_={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},G_={class:"container"},j_={class:"row row-cols-1 row-cols-md-3"},Y_={class:"col"},K_={class:"form-floating mb-2"},W_=["value"],Q_={key:0,class:"d-block invalid-feedback"},J_={class:"col"},Z_={class:"form-floating mb-2"},X_={key:0,class:"d-block invalid-feedback"},e2={class:"col"},t2={class:"form-floating mb-2"},s2={key:0,class:"d-block invalid-feedback"},o2={class:"modal-footer"},a2=["disabled"],l2={__name:"_addChannelOutput",props:{channelId:{type:String}},emits:["confirm","cancel"],setup(r,{expose:b,emit:T}){const{appTitle:M,pageTitle:k,busy:H,isDirty:V,validations:Q,infoMessage:j,warningMessage:S,errorMessage:z,router:ae,axios:N,utils:L,toasts:n,closeWithReturnUrl:I,security:$}=he({appTitle:"Arcadian-FAST",pageTitle:"Add Channel Output"}),K=T,J=r,u=ge("modalAddChannelOutput"),p=ye({lookups:{sourceGroups:[]},item:{sourceGroupId:null,manifestName:null,outputType:null}}),W={item:{sourceGroupId:{required:le.withMessage("Source Group is required.",re),$autoDirty:!0,$lazy:!0},manifestName:{required:le.withMessage("Manifest Name is required.",re),$autoDirty:!0,$lazy:!0},outputType:{required:le.withMessage("Output Type is required.",re),$autoDirty:!0,$lazy:!0}}},g=Te(W,p);fe(async()=>{g.value.$reset(),f()});const G=async()=>{await y()},y=async()=>{try{await N.get("/api/v1/sourceGroups/lookup/").then(l=>{p.lookups.sourceGroups=l.data,p.lookups.sourceGroups.length===1&&(p.item.sourceGroupId=p.lookups.sourceGroups[0].id)})}catch(d){z.value=L.getErrorMessageAsHtml(d),window.scrollTo(0,0)}finally{}},f=async()=>{const d=p;Q.value.clear(),z.value="",d.lookups={sourceGroups:[]},d.item={sourceGroupId:null,outputType:null},await G(),g.value.$reset();var l=document.getElementById(u.value),a=_e.getOrCreateInstance(l);a.show()},m=async()=>{var d=document.getElementById(u.value),l=_e.getOrCreateInstance(d);l.hide(),K("cancel")},i=async()=>{const d=p;if(H.value)return;if(!await g.value.$validate()){window.scrollTo(0,0);return}try{H.value=!0,z.value="";const _=d.item;_.channelId=J.channelId,await N.post("/api/v1/channelOutputs",_).then(v=>{n.success("Add Channel Output","Channel output added.")});var a=document.getElementById(u.value),h=_e.getOrCreateInstance(a);h.hide(),K("confirm")}catch(_){z.value=L.getErrorMessageAsHtml(_),window.scrollTo(0,0)}finally{H.value=!1}};return b({open:f,close:m}),(d,l)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:u.value,tabindex:"-1","aria-hidden":"true"},[e("div",D_,[e("div",E_,[e("div",q_,[e("h5",B_,[l[4]||(l[4]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Y(c(o(k)),1)]),l[5]||(l[5]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),e("div",N_,[o(z)?(t(),s("div",R_,[l[6]||(l[6]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Y("Error ")],-1)),e("div",{innerHTML:o(z)},null,8,F_)])):x("",!0),o(Q).size>0?(t(),s("div",z_,[l[7]||(l[7]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Y("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(A,null,E(o(Q).values(),a=>(t(),s("li",null,c(a),1))),256))])])):x("",!0),e("div",G_,[e("div",j_,[e("div",Y_,[e("div",K_,[q(e("select",{"onUpdate:modelValue":l[0]||(l[0]=a=>p.item.sourceGroupId=a),class:te([o(L).getValidFeedbackCss(p.item.sourceGroupId),"form-select"]),id:"sourceGroupId"},[(t(!0),s(A,null,E(p.lookups.sourceGroups,a=>(t(),s("option",{value:a.id},c(a.name),9,W_))),256))],2),[[pe,p.item.sourceGroupId]]),l[8]||(l[8]=e("label",{for:"sourceGroupId",class:""},"Source Group",-1)),o(g).item.sourceGroupId.$error?(t(),s("div",Q_,[(t(!0),s(A,null,E(o(g).item.sourceGroupId.$errors,a=>(t(),s("div",{key:a.$uid},c(a.$message),1))),128))])):x("",!0)])]),e("div",J_,[e("div",Z_,[q(e("select",{"onUpdate:modelValue":l[1]||(l[1]=a=>p.item.outputType=a),class:te([o(L).getValidFeedbackCss(p.item.outputType),"form-select"]),id:"outputType"},l[9]||(l[9]=[e("option",{value:"HLS",selected:""},"HLS",-1),e("option",{value:"DASH"},"DASH",-1)]),2),[[pe,p.item.outputType]]),l[10]||(l[10]=e("label",{for:"outputType",class:""},"Output Type",-1)),o(g).item.outputType.$error?(t(),s("div",X_,[(t(!0),s(A,null,E(o(g).item.outputType.$errors,a=>(t(),s("div",{key:a.$uid},c(a.$message),1))),128))])):x("",!0)])]),e("div",e2,[e("div",t2,[q(e("input",{"onUpdate:modelValue":l[2]||(l[2]=a=>p.item.manifestName=a),class:te([o(L).getValidFeedbackCss(p.item.manifestName),"form-control"]),id:"manifestName"},null,2),[[ee,p.item.manifestName]]),l[11]||(l[11]=e("label",{for:"manifestName",class:""},"Manifest Name",-1)),o(g).item.manifestName.$error?(t(),s("div",s2,[(t(!0),s(A,null,E(o(g).item.manifestName.$errors,a=>(t(),s("div",{key:a.$uid},c(a.$message),1))),128))])):x("",!0)])])])])]),e("div",o2,[e("button",{disabled:o(g).$dirty&&o(g).$invalid,onClick:l[3]||(l[3]=a=>i()),class:"btn btn-primary",type:"button"},l[12]||(l[12]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,a2),l[13]||(l[13]=e("button",{"data-bs-dismiss":"modal",class:"btn btn-secondary ms-1"},[e("span",{class:"fas fa-fw fa-times"})],-1))])])])],8,H_))}},n2=["id"],r2={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl modal-fullscreen-lg-down"},i2={class:"modal-content"},d2={class:"modal-header"},u2={class:"modal-title"},c2={class:"modal-body"},m2={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},f2=["innerHTML"],p2={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},v2={class:"container"},g2={class:"row row-cols-1 row-cols-md-2"},b2={class:"col"},y2={class:"form-floating mb-2"},$2=["value"],h2={key:0,class:"d-block invalid-feedback"},w2={class:"col"},_2={class:"form-floating mb-2"},k2=["value"],S2={key:0,class:"d-block invalid-feedback"},T2={class:"col"},I2={class:"card h-100"},M2=["id"],x2={class:"modal-footer"},C2=["disabled"],V2={__name:"_editFillerSlate",props:{channelId:{type:String},sourceLocationId:{type:String},vodSourceId:{type:String}},emits:["confirm","cancel"],setup(r,{expose:b,emit:T}){const{appTitle:M,pageTitle:k,busy:H,isDirty:V,validations:Q,infoMessage:j,warningMessage:S,errorMessage:z,router:ae,axios:N,utils:L,toasts:n,closeWithReturnUrl:I,security:$}=he({appTitle:"Arcadian-FAST",pageTitle:"Edit Filler Slate"}),K=T,J=r,u=ge("modalEditFillerSlate"),p=ye({lookups:{sourceLocations:[],vodSources:[]},item:{channelId:null,sourceLocationId:null,vodSourceId:null},hls:null}),W={item:{channelId:{required:le.withMessage("channelId is required.",re),$autoDirty:!0,$lazy:!0},sourceLocationId:{required:le.withMessage("sourceLocationId is required.",re),$autoDirty:!0,$lazy:!0},vodSourceId:{required:le.withMessage("vodSourceId is required.",re),$autoDirty:!0,$lazy:!0}}},g=Te(W,p);fe(async()=>{m(),g.value.$reset()}),Le(()=>{p.hls&&(p.hls.stopLoad(),p.hls.destroy())});const G=async()=>{await y()},y=async()=>{try{await N.get("/api/v1/sourcelocations/lookup/").then(v=>{p.lookups.sourceLocations=v.data}),p.item.sourceLocationId&&await f(p.item.sourceLocationId)}catch(_){z.value=L.getErrorMessageAsHtml(_),window.scrollTo(0,0)}finally{}},f=async _=>{try{let v=`/api/v1/vodSources/lookup/source-Location/${_}/?category=2`;await N.get(v).then(B=>{p.lookups.vodSources=B.data})}catch(v){z.value=L.getErrorMessageAsHtml(v),window.scrollTo(0,0)}finally{}},m=async()=>{const _=p;Q.value.clear(),z.value="",_.lookups={sourceLocations:[],vodSources:[]},_.item={channelId:J.channelId,sourceLocationId:J.sourceLocationId,vodSourceId:J.vodSourceId},await G(),p.item.vodSourceId&&await h(p.item.vodSourceId),g.value.$reset();var v=document.getElementById(u.value),B=_e.getOrCreateInstance(v);B.show()},i=async()=>{var _=document.getElementById(u.value),v=_e.getOrCreateInstance(_);v.hide(),p.hls&&(p.hls.stopLoad(),p.hls.destroy()),K("cancel","cancel clicked")},d=async()=>{const _=p;if(H.value)return;if(!await g.value.$validate()){window.scrollTo(0,0);return}try{H.value=!0,z.value="";const w=_.item;await N.put("/api/v1/channels/filler-slate",w).then(D=>{n.success("Update Channel Filler Slate","Channel's Filler slate was updated.")});var B=document.getElementById(u.value),P=_e.getOrCreateInstance(B);P.hide(),p.hls&&(p.hls.stopLoad(),p.hls.destroy()),K("confirm",p.item)}catch(w){z.value=L.getErrorMessageAsHtml(w),window.scrollTo(0,0)}finally{H.value=!1}},l=async()=>{p.item.vodSourceId=null,await f(p.item.sourceLocationId)},a=async()=>{await h(p.item.vodSourceId)},h=async _=>{try{let v=`/api/v1/vodSources/${_}/hls`;const B=await N.get(v).then(w=>w.data);if(p.hls){p.hls.loadSource(B);return}const P=document.getElementById(`video-${p.item.channelId}`);p.hls=L.createHlsStream(P,B)}catch(v){z.value=L.getErrorMessageAsHtml(v),window.scrollTo(0,0)}finally{}};return b({open:m,close:i}),(_,v)=>(t(),s("div",{class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:u.value,tabindex:"-1","aria-hidden":"true"},[e("div",r2,[e("div",i2,[e("div",d2,[e("h5",u2,[v[6]||(v[6]=e("span",{class:"fas fa-fw fa-pen-to-square me-1"},null,-1)),Y(c(o(k)),1)]),e("button",{type:"button",class:"btn-close",onClick:v[0]||(v[0]=B=>i()),"aria-label":"Close"})]),e("div",c2,[o(z)?(t(),s("div",m2,[v[7]||(v[7]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Y("Error ")],-1)),e("div",{innerHTML:o(z)},null,8,f2)])):x("",!0),o(Q).size>0?(t(),s("div",p2,[v[8]||(v[8]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Y("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(A,null,E(o(Q).values(),B=>(t(),s("li",null,c(B),1))),256))])])):x("",!0),e("div",v2,[e("div",g2,[e("div",b2,[e("div",y2,[q(e("select",{"onUpdate:modelValue":v[1]||(v[1]=B=>p.item.sourceLocationId=B),onChange:v[2]||(v[2]=B=>l()),class:te([o(L).getValidFeedbackCss(p.item.sourceLocationId),"form-select"]),id:"sourceLocationId"},[(t(!0),s(A,null,E(p.lookups.sourceLocations,B=>(t(),s("option",{value:B.id},c(B.name),9,$2))),256))],34),[[pe,p.item.sourceLocationId]]),v[9]||(v[9]=e("label",{for:"sourceLocationId",class:""},"Source Location",-1)),o(g).item.sourceLocationId.$error?(t(),s("div",h2,[(t(!0),s(A,null,E(o(g).item.sourceLocationId.$errors,B=>(t(),s("div",{key:B.$uid},c(B.$message),1))),128))])):x("",!0)])]),e("div",w2,[e("div",_2,[q(e("select",{"onUpdate:modelValue":v[3]||(v[3]=B=>p.item.vodSourceId=B),onChange:a,class:te([o(L).getValidFeedbackCss(p.item.vodSourceId),"form-select"]),id:"vodSourceId"},[(t(!0),s(A,null,E(p.lookups.vodSources,B=>(t(),s("option",{value:B.id},c(B.name),9,k2))),256))],34),[[pe,p.item.vodSourceId]]),v[10]||(v[10]=e("label",{for:"vodSourceId",class:""},"VOD Source",-1)),o(g).item.vodSourceId.$error?(t(),s("div",S2,[(t(!0),s(A,null,E(o(g).item.vodSourceId.$errors,B=>(t(),s("div",{key:B.$uid},c(B.$message),1))),128))])):x("",!0)])])]),e("div",T2,[e("div",I2,[e("video",{id:`video-${p.item.channelId}`,controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain"},null,8,M2)])])])]),e("div",x2,[e("button",{disabled:o(g).$dirty&&o(g).$invalid,onClick:v[4]||(v[4]=B=>d()),class:"btn btn-primary",type:"button"},v[11]||(v[11]=[e("span",{class:"fas fa-fw fa-save"},null,-1)]),8,C2),e("button",{onClick:v[5]||(v[5]=B=>i()),class:"btn btn-secondary ms-1"},v[12]||(v[12]=[e("span",{class:"fas fa-fw fa-times"},null,-1)]))])])])],8,n2))}},A2={class:"my-2"},O2={class:""},P2={class:"form-floating mb-2"},U2={id:"vodSourceTitle",class:"form-control-plaintext"},L2={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},H2={class:"row"},D2={class:"col-12 col-md-4"},E2={class:"form-floating mb-2"},q2={id:"vodSourceVideoTitle",class:"form-control-plaintext"},B2={class:"col-12 col-md-8"},N2={class:"form-floating mb-2"},R2={id:"vodSourceVideoDesc",class:"form-control-plaintext"},F2={class:"mt-2"},z2={class:"row row-cols-1 row-cols-sm-3"},G2={class:"col"},j2={class:"form-floating mb-2"},Y2={id:"startOffsetMillis",class:"form-control-plaintext"},K2={class:"col"},W2={class:"form-floating mb-2"},Q2={id:"endOffsetMillis",class:"form-control-plaintext"},J2={class:"col"},Z2={class:"form-floating mb-2"},X2={id:"durationInMillis",class:"form-control-plaintext"},ek={class:"row row-cols-1 row-cols-sm-3"},tk={class:"col"},sk={class:"form-floating mb-2"},ok={id:"adBreaksDurationInMillis",class:"form-control-plaintext"},ak={class:"col"},lk={class:"form-floating mb-2"},nk={id:"totalProgramTemplateDurationInMillis",class:"form-control-plaintext"},rk={class:"row row-cols-1 row-cols-sm-3"},ik={class:"col"},dk={class:"form-floating mb-2"},uk={id:"dateScheduledStart",class:"form-control-plaintext"},ck={class:"col"},mk={class:"form-floating mb-2"},fk={id:"dateScheduledEnd",class:"form-control-plaintext"},pk={key:0,class:"col"},vk={class:"form-floating mb-2"},gk={id:"relativeProgram",class:"form-control-plaintext"},bk={key:0,class:"mt-2"},yk={class:"table-responsive border overflow-y-auto",style:{height:"20rem"}},$k={class:"table table-bordered1 mb-0"},hk={class:"align-center"},wk={class:"text-center me-1"},_k={class:"text-center"},kk={class:"text-center"},Sk={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},Tk={key:1,class:"fas fa-fw fa-triangle-exclamation text-warning me-1"},Ik={__name:"_programDetail",props:{item:{type:Object,required:!0},urlViewVideo:{type:String,required:!0},urlViewVodSource:{type:String,required:!0}},setup(r){const b=r,{moment:T,generateReturnUrl:M}=tt();return fe(()=>{b.item.value}),(k,H)=>{const V=oe("router-link");return t(),s("div",A2,[e("div",null,[H[1]||(H[1]=e("h5",null," VOD ",-1)),e("div",O2,[e("div",P2,[e("div",U2,[F(V,{to:`${r.urlViewVodSource}/${r.item.vodSourceId}/${o(M)()}`,class:"link-offset-2"},{default:R(()=>[r.item.vodSource.arn?(t(),s("span",L2)):x("",!0),Y(" "+c(r.item.vodSource.name),1)]),_:1},8,["to"])]),H[0]||(H[0]=e("label",{for:"vodSourceTitle"},"Title",-1))])])]),e("div",null,[H[4]||(H[4]=e("h5",null," Video ",-1)),e("div",H2,[e("div",D2,[e("div",E2,[e("div",q2,[F(V,{to:`${r.urlViewVideo}/${r.item.vodSource.video.videoId}/${o(M)()}`,class:"link-offset-2"},{default:R(()=>[Y(c(r.item.vodSource.video.title),1)]),_:1},8,["to"])]),H[2]||(H[2]=e("label",{for:"vodSourceVideoTitle"},"Title",-1))])]),e("div",B2,[e("div",N2,[e("div",R2,c(r.item.vodSource.video.description),1),H[3]||(H[3]=e("label",{for:"vodSourceVideoDesc"},"Description",-1))])])])]),e("div",F2,[H[13]||(H[13]=e("h5",null," Schedule ",-1)),e("div",z2,[e("div",G2,[e("div",j2,[e("div",Y2,c(o(T).utc(r.item.startOffsetMillis).format("HH:mm:ss")),1),H[5]||(H[5]=e("label",{for:"startOffsetMillis"},"Start Offset",-1))])]),e("div",K2,[e("div",W2,[e("div",Q2,c(o(T).utc(r.item.endOffsetMillis).format("HH:mm:ss")),1),H[6]||(H[6]=e("label",{for:"endOffsetMillis"},"End Offset",-1))])]),e("div",J2,[e("div",Z2,[e("div",X2,c(o(T).utc(r.item.durationInMillis).format("HH:mm:ss")),1),H[7]||(H[7]=e("label",{for:"durationInMillis"},"Clip Duration",-1))])])]),e("div",ek,[e("div",tk,[e("div",sk,[e("div",ok,c(o(T).utc(r.item.adBreaksDurationInMillis).format("HH:mm:ss")),1),H[8]||(H[8]=e("label",{for:"adBreaksDurationInMillis"},"Total Ad Breaks Duration",-1))])]),e("div",ak,[e("div",lk,[e("div",nk,c(o(T).utc(r.item.totalProgramTemplateDurationInMillis).format("HH:mm:ss")),1),H[9]||(H[9]=e("label",{for:"totalProgramTemplateDurationInMillis"},"Total Program Duration",-1))])])]),e("div",rk,[e("div",ik,[e("div",dk,[e("div",uk,c(o(T).utc(r.item.dateScheduledStart).format("lll")),1),H[10]||(H[10]=e("label",{for:"dateScheduledStart"},"Program Start",-1))])]),e("div",ck,[e("div",mk,[e("div",fk,c(o(T).utc(r.item.dateScheduledEnd).format("lll")),1),H[11]||(H[11]=e("label",{for:"dateScheduledEnd"},"Program End",-1))])]),r.item.relativeProgram?(t(),s("div",pk,[e("div",vk,[e("div",gk,c(r.item.relativeProgram.name),1),H[12]||(H[12]=e("label",{for:"relativeProgram"},"Relative Program",-1))])])):x("",!0)])]),r.item.adBreaks.length?(t(),s("div",bk,[H[15]||(H[15]=e("h5",null," Ad Breaks ",-1)),e("div",yk,[e("table",$k,[e("tbody",null,[H[14]||(H[14]=e("tr",null,[e("th",{class:"text-center"},"#"),e("th",{class:"text-center"},"Offset"),e("th",{class:"text-center"},"Duration"),e("th",{class:"text-center1"},"VOD")],-1)),(t(!0),s(A,null,E(r.item.adBreaks,(Q,j)=>(t(),s("tr",hk,[e("td",wk,c(j+1),1),e("td",_k,c(o(T).utc(Q.offsetMillis).format("HH:mm:ss")),1),e("td",kk,c(o(T).utc(Q.durationInMillis).format("HH:mm:ss")),1),e("td",null,[F(V,{to:`${r.urlViewVodSource}/${Q.vodSource.vodSourceId}/${o(M)()}`,class:"link-offset-2"},{default:R(()=>[Q.vodSource.arn?(t(),s("span",Sk)):(t(),s("span",Tk)),Y(" "+c(Q.vodSource.name),1)]),_:2},1032,["to"])])]))),256))])])])])):x("",!0)])}}},Mk={key:0,class:"dropdown"},xk={key:0,class:"fas fa-fw fa-play"},Ck={key:1,class:"fas fa-fw fa-stop"},Vk={class:"dropdown-menu"},Ak={key:0},Ok={key:1},Pk={key:2},Uk={key:0},Lk={class:"nav nav-tabs",id:"myTab",role:"tablist"},Hk={class:"nav-item",role:"presentation"},Dk={class:"nav-item",role:"presentation"},Ek={class:"nav-item",role:"presentation"},qk={class:"nav-item",role:"presentation"},Bk={class:"nav-item",role:"presentation"},Nk={class:"tab-content",id:"myTabContent"},Rk={class:""},Fk={class:"row row-cols-1 row-cols-lg-2"},zk={class:"col"},Gk={class:"row row-cols-1 row-cols-xl-3"},jk={class:"col"},Yk={class:"form-floating mb-2"},Kk={class:"col"},Wk={class:"form-floating mb-2"},Qk={class:"col"},Jk={class:"form-floating mb-2"},Zk={class:"col"},Xk={class:"input-group"},eS={class:"form-floating"},tS=["value"],sS={class:"w-100 mt-2"},oS={class:"text-center"},aS=["src"],lS={class:"col"},nS={class:"mt-1 mt-lg-0"},rS={class:"col"},iS={class:"form-floating mb-2"},dS={class:"form-control-plaintext card"},uS={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},cS={class:"col"},mS={class:"input-group border mb-2"},fS={class:"form-floating"},pS={class:"form-control-plaintext card"},vS={key:0,class:"fas fa-fw fa-check-circle text-success me-1"},gS={class:""},bS={class:"d-flex flex-row justify-content-start align-items-center"},yS={class:"ms-2"},$S={key:0,class:"alert bg-warning mt-2"},hS={class:"table-responsive border mt-1"},wS={class:"table table-bordered1 mb-0"},_S={class:"badge bg-info"},kS={key:0,class:"text-wrap"},SS={key:1,class:"text-warning"},TS={key:0,class:"text-end"},IS={key:1,class:"text-end"},MS=["onClick"],xS={key:0},CS={colspan:"999"},VS={class:"d-flex flex-row justify-content-start align-items-center"},AS={class:"ms-2"},OS={if:"item.playbackUrl"},PS=["onClick"],US={key:0,class:"table-responsive mt-2"},LS={class:"table table-borderless mb-0 table-sm"},HS={class:"align-middle1"},DS={class:"badge bg-success"},ES={class:"border p-2 mt-2 text-wrap text-truncate",style:{"max-width":"65rem"}},qS={class:"text-end"},BS={class:"d-flex flex-row justify-content-end align-items-baseline"},NS=["onClick"],RS=["onClick"],FS={class:""},zS={class:"table-responsive border"},GS={class:"table mb-0 table-sm table-bordered1"},jS={class:"align-middle1"},YS={class:"text-center me-1"},KS={class:"d-flex flex-column flex-md-row justify-content-start gap-1"},WS={class:""},QS={class:"mb-1 mb-md-0"},JS=["src"],ZS={class:"me-auto ms-md-2"},XS={key:0,class:"fas fa-fw fa-check-circle text-success"},e0={class:"mx-md-5"},t0={class:"fw-lighter small text-nowrap"},s0={class:"fw-lighter small text-nowrap"},o0={class:"me-md-5"},a0={class:"fw-lighter small text-nowrap"},l0={class:"fw-lighter small text-nowrap"},n0={class:"text-center"},r0={class:"text-center"},i0={class:"text-end"},d0={class:"btn-group position-static"},u0=["onClick"],c0={key:0,class:"fas fa-fw fa-chevron-circle-up"},m0={key:1,class:"fas fa-fw fa-chevron-circle-down"},f0={class:"dropdown-menu"},p0=["onClick"],v0={key:0},g0=["onClick"],b0=["onClick"],y0=["onClick"],$0={key:0},h0={colspan:"999"},w0={class:"text-end mt-2 d-none"},_0={class:""},k0={class:"text-end mb-2"},S0={class:"row row-cols-1 row-cols-sm-2 row-cols-md-3 g-4",id:"masonry"},T0={class:"col"},I0={class:"card shadow-sm"},M0=["id"],x0={class:"p-1"},C0={class:"card-title1 text-center"},V0={class:"col"},A0={class:"card shadow-sm"},O0=["id"],P0={class:"p-1"},U0={class:"card-title1 text-center text-truncate"},L0={class:"small1"},H0={class:""},D0={key:0,class:"fas fa-fw fa-check-circle text-success"},E0={key:1,class:"fas fa-fw fa-times-circle text-warning"},q0={key:0,class:"fas fa-fw fa-check-circle text-success"},B0={key:1,class:"fas fa-fw fa-times-circle text-warning"},N0={key:0,class:"fas fa-fw fa-check-circle text-success"},R0={key:1,class:"fas fa-fw fa-times-circle text-warning"},F0={key:0,class:"fas fa-fw fa-check text-warning"},z0={key:1,class:"fas fa-fw fa-circle-exclamation text-warning"},G0={key:0,class:"fas fa-fw fa-check-circle text-success"},j0={key:1,class:"fas fa-fw fa-times-circle text-warning"},Y0={__name:"index",props:{id:{type:String,required:!0},urlMain:{type:String,default:"/channels"},urlViewSourceGroup:{type:String,default:"/source-groups/view"},urlViewSourceLocation:{type:String,default:"/source-locations/view"},urlViewVodSource:{type:String,default:"/vod-sources/view"},urlViewVideo:{type:String,default:"/videos/view"},urlSchedulePrograms:{type:String,default:"/channels/schedule-programs"}},setup(r){const b=r,{appTitle:T,pageTitle:M,busy:k,isDirty:H,validations:V,infoMessage:Q,warningMessage:j,errorMessage:S,router:z,axios:ae,utils:N,toasts:L,close:n,closeWithReturnUrl:I,generateReturnUrl:$,security:K}=he({appTitle:"Arcadian-FAST",pageTitle:"View Channel"});Ce("$config");const J=we();J.user;const u=ye({lookups:{logos:[]},user:J.user,logoUrl:null,item:null}),p=ge(null),W=ge(),g=xe(()=>u.item&&u.item.state==="RUNNING");u.lookups.logos=[{id:"Viva | Batang 90s",url:"https://d1qfpvemzhsbpm.cloudfront.net/images/P00203_KA_MAIN_HORIZ_LM_TGIS%20THE%20MOVIE.480.jpg"},{id:"Viva | Kids & Family",url:"https://d1qfpvemzhsbpm.cloudfront.net/images/P00219_KA_MAIN_HORIZ_LM_ANG%20TANGING%20INA.480.jpg"},{id:"Viva | Horror Movie Marathon",url:"https://d1qfpvemzhsbpm.cloudfront.net/images/P00408_KA_MAIN_HORIZ_FM_WINNIE%20THE%20POOH%20BLOOD%20AND%20HONEY.480.jpg"},{id:"Viva | BitterSweet Stories",url:"https://d1qfpvemzhsbpm.cloudfront.net/images/P00074_KA_MAIN_HORIZ_LM_CAMP%20SAWI.480.jpg"},{id:"Viva | Comedy",url:"https://d1qfpvemzhsbpm.cloudfront.net/images/P00207_KA_MAIN_HORIZ_LM_THE%20GIFTED.480.jpg"},{id:"Viva | Romance",url:"https://d1qfpvemzhsbpm.cloudfront.net/images/P00697_KA_MAIN_HORIZ_LM_CLOSE%20TO%20YOU.480.jpg"},{id:"Viva | ROMCOM",url:"https://d1qfpvemzhsbpm.cloudfront.net/images/P00220_KA_MAIN_HORIZ_LM_KASAL,%20KASALI,%20KASALO.480.jpg"}],fe(async()=>{await m();const ce=N.getPageTab("channel")||"information-tab";G(ce)}),Le(()=>{me()});const G=ce=>{N.setPageTab("channel",ce),W.value=ce,ce==="preview-tab"&&setTimeout(()=>{var C=document.getElementById("masonry");new rt(C,{})},2e3)},y=ce=>ce===W.value?"active":"",f=ce=>ce===W.value?"show active":"",m=async()=>{const ce=u;if(me(),!k.value)try{k.value=!0,S.value="",u.item=null;const C=`/api/v1/channels/${b.id}/`;await ae.get(C).then(ve=>{ce.item=ve.data,ce.item.outputs.forEach(Pe=>{Pe.playbackConfigurations.forEach(ie=>{if(Pe.playbackUrl){const Ue=Pe.playbackUrl,Me=Ue.lastIndexOf("/"),lt=Ue.substring(0,Me),Ke=Ue.substring(Me+1),nt=ie.hlsConfigurationManifestEndpointPrefix;nt&&(ie.hlsPlaylist=nt+Ke)}})})}),u.logoUrl=u.item.logoUrl,ue()}catch(C){S.value=N.getErrorMessageAsHtml(C),window.scrollTo(0,0)}finally{k.value=!1}},i=async()=>{if(confirm("Do you want to delete this Channel?")&&!k.value)try{k.value=!0,S.value="";const C=`/api/v1/channels/${b.id}/`;await ae.delete(C).then(ve=>{}),I(b.urlMain)}catch(C){S.value=N.getErrorMessageAsHtml(C),window.scrollTo(0,0)}finally{k.value=!1}},d=async()=>{await m()},l=async ce=>{if(confirm("Channel will be submitted to AWS MediaTailer. Are you sure you want to publish the channel?")&&!k.value){S.value=null;try{k.value=!0;var ve=ce?"?include-program=true":"";await ae.post(`/api/v1/channels/${b.id}/publish/${ve}`).then(Ie=>{L.success("Publish Channel","Channel was published.")}),k.value=!1,await d()}catch(Ie){S.value=N.getErrorMessageAsHtml(Ie),window.scrollTo(0,0)}finally{k.value=!1}}},a=async()=>{if(confirm("Channel will be removed to AWS MediaTailer. Are you sure you want to remove the channel?")&&!k.value){S.value=null;try{k.value=!0,await ae.delete(`/api/v1/channels/${b.id}/unpublish/`).then(C=>{L.warning("Remove Channel","Channel was removed.")}),k.value=!1,await d()}catch(C){S.value=N.getErrorMessageAsHtml(C),window.scrollTo(0,0)}finally{k.value=!1}}},h=()=>{p.value.open(b.id)},_=async ce=>{if(ce.outputType==="HLS"){debugger;const C=Ae(L_,{channelOutputId:ce.channelOutputId,playbackUrl:ce.playbackUrl},{chore:!0,keepInitial:!1}),{data:ve,isCanceled:Ie}=await C.reveal();C.close(),Ie||await d()}},v=async()=>{const ce=Ae(l2,{channelId:u.item.channelId},{chore:!0,keepInitial:!1}),{data:C,isCanceled:ve}=await ce.reveal();ce.close(),ve||await d()},B=async ce=>{const C=Ae(ft,{programId:ce},{chore:!0,keepInitial:!1}),{data:ve,isCanceled:Ie}=await C.reveal();C.closeAll(),Ie||await d()},P=async(ce,C)=>{const ve=Ae(V2,{channelId:u.item.channelId,sourceLocationId:u.item.fillerSlateSourceLocation.sourceLocationId,vodSourceId:u.item.fillerSlateVodSource.vodSourceId},{chore:!0,keepInitial:!1}),{data:Ie,isCanceled:Pe}=await ve.reveal();ve.close(),Pe||await d()},w=async ce=>{if(confirm("Program will be deleted. Are you sure you want to delete the program?")&&!k.value){S.value=null;try{k.value=!0,await ae.delete(`/api/v1/programs/${ce}/`).then(ve=>{L.success("Delete Program","Program was deleted..",{async onClose(){}})}),k.value=!1,await d()}catch(ve){S.value=N.getErrorMessageAsHtml(ve),window.scrollTo(0,0)}finally{k.value=!1}}},D=async ce=>{if(confirm("Channel output will be unpublished (if published) and will be deleted. Are you sure you want to delete this channel output?")&&!k.value){S.value=null;try{k.value=!0,await ae.delete(`/api/v1/channelOutputs/${ce}/`).then(ve=>{L.success("Delete Channel Output","Channel output was deleted..")}),k.value=!1,await d()}catch(ve){S.value=N.getErrorMessageAsHtml(ve),window.scrollTo(0,0)}finally{k.value=!1}}},X=async ce=>{if(confirm("Program will be published to AWS MediaTailor. Are you sure you want to publish the program?")&&!k.value){S.value=null;try{k.value=!0,await ae.post(`/api/v1/programs/${ce}/publish/`).then(ve=>{L.success("Publish Program","Program was published..",{async onClose(){}})}),k.value=!1,await d()}catch(ve){S.value=N.getErrorMessageAsHtml(ve),window.scrollTo(0,0)}finally{k.value=!1}}},U=async ce=>{if(confirm("Program will be unpublished to AWS MediaTailor. Are you sure you want to unpublish the program?")&&!k.value){S.value=null;try{k.value=!0,await ae.delete(`/api/v1/programs/${ce}/unpublish/`).then(ve=>{L.success("Unpublish Program","Program was unpublished..",{async onClose(){}})}),k.value=!1,await d()}catch(ve){S.value=N.getErrorMessageAsHtml(ve),window.scrollTo(0,0)}finally{k.value=!1}}},ne=async ce=>{if(!k.value){S.value=null;try{k.value=!0,await ae.put(`/api/v1/channels/${b.id}/change-state/${ce}`).then(C=>{L.success("Update Channel state","Change state was updated")}),k.value=!1,ce==="STOPPED"&&W.value==="preview-tab"&&(me(),G("information-tab")),await d()}catch(C){S.value=N.getErrorMessageAsHtml(C),window.scrollTo(0,0)}finally{k.value=!1}}},Z=async ce=>{if(!k.value)try{k.value=!0,S.value="",await ae.post(`/api/v1/channelOutputs/${ce}/playback/publish/`).then(C=>{L.success("Publish Channel Output Playback Configuration","Channel Output playback configuration published.")}),k.value=!1,await d()}catch(C){S.value=N.getErrorMessageAsHtml(C),window.scrollTo(0,0)}finally{k.value=!1}},se=async ce=>{if(confirm("Do you want to remove this Playback Configuration?")&&!k.value)try{k.value=!0,S.value="",await ae.delete(`/api/v1/channelOutputs/${ce}/playback/`).then(ve=>{L.warning("Delete Channel Output Playback Configuration","Channel Output playback configuration deleted.")}),k.value=!1,await d()}catch(ve){S.value=N.getErrorMessageAsHtml(ve),window.scrollTo(0,0)}finally{k.value=!1}},O=()=>{if(Hls.isSupported()&&console.log("Hello HLS.js!"),Hls.isMSESupported()&&Hls.getMediaSource().isTypeSupported('video/mp4;codecs="av01.0.01M.08"')){console.log("Hello AV1 playback! AVC who?");const ce=u.item.outputs;me(),ce.forEach(C=>{var ve=document.getElementById(`video-${C.channelOutputId}`);C.hls&&C.hls.destroy(),C.hls=N.createHlsStream(ve,C.playbackUrl,"Main playlist started."),ve.play(),C.playbackConfigurations.forEach(Ie=>{if(Ie.hls&&Ie.hls.destroy(),Ie.arn){var Pe=document.getElementById(`video-${Ie.channelOutputPlaybackConfigurationId}`);try{Ie.hls=N.createHlsStream(Pe,Ie.hlsPlaylist,"Playback with Server-side Ad Insertion playlist started."),Pe.play()}catch(ie){L.error("Failed Stream SSAI Playlist",ie)}}})}),setTimeout(()=>{var C=document.getElementById("masonry");new rt(C,{})},2e3)}},me=()=>{u.item&&u.item.outputs&&u.item.outputs.forEach(C=>{C.hls&&(C.hls.detachMedia(),C.hls.destroy(),delete C.hls),C.playbackConfigurations.forEach(ve=>{ve.hls&&(ve.hls.detachMedia(),ve.hls.destroy(),delete ve.hls)})})},ue=()=>{if(Hls.isSupported()){u.hls&&(u.hls.stopLoad(),u.hls.destroy());var ce=document.getElementById("video-filler-slate"),C=u.item.fillerSlateVodSource;const Ie=C.video.formats.find(ie=>ie.formatName==="HLS"),Pe=Ie.serverUrl+Ie.path;u.hls=N.createHlsStream(ce,Pe)}},de=async()=>{const ce=u;if(!k.value)try{k.value=!0,S.value="";const C=encodeURIComponent(ce.logoUrl);await ae.put(`/api/v1/channels/${b.id}/logo/?url=${C}`).then(ve=>{L.success("Edit Channel Logo","Channel logo was updated.")}),k.value=!1,await d()}catch(C){S.value=N.getErrorMessageAsHtml(C),window.scrollTo(0,0)}finally{k.value=!1}};return(ce,C)=>{const ve=oe("router-link"),Ie=oe("PageHeader"),Pe=oe("PageBody");return t(),be($e,null,{default:R(()=>[e("div",null,[F(Ie,{"page-icon":"fas fa-fw fa-tv",pageTitle:o(M)},{default:R(()=>[o(k)?x("",!0):(t(),s(A,{key:0},[u.item?(t(),s("div",Mk,[e("button",{class:te([[g.value?"btn-outline-success":"btn-outline-info"],"btn dropdown-toggle"]),type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[g.value?(t(),s("span",xk)):(t(),s("span",Ck)),Y(" "+c(u.item.state),1)],2),e("ul",Vk,[u.item.arn?(t(),s("li",Ak,[g.value?(t(),s("button",{key:0,onClick:C[0]||(C[0]=ie=>ne("STOPPED")),class:"dropdown-item"},C[24]||(C[24]=[e("span",{class:"fas fa-fw fa-stop me-1"},null,-1),Y("Stop ")]))):(t(),s("button",{key:1,onClick:C[1]||(C[1]=ie=>ne("RUNNING")),class:"dropdown-item"},C[25]||(C[25]=[e("span",{class:"fas fa-fw fa-play me-1"},null,-1),Y("Start ")])))])):x("",!0),g.value?x("",!0):(t(),s("li",Ok,[u.item.arn?(t(),s("button",{key:0,onClick:C[2]||(C[2]=ie=>a()),class:"dropdown-item"},C[26]||(C[26]=[e("span",{class:"fas fa-fw fa-unlink me-1"},null,-1),Y("Unpublish ")]))):(t(),s(A,{key:1},[e("button",{onClick:C[3]||(C[3]=ie=>l()),class:"dropdown-item"},C[27]||(C[27]=[e("span",{class:"fas fa-fw fa-link me-1"},null,-1),Y("Publish ")])),e("button",{onClick:C[4]||(C[4]=ie=>l(!0)),class:"dropdown-item"},C[28]||(C[28]=[e("span",{class:"fas fa-fw fa-link me-1"},null,-1),Y("Publish With Programs ")]))],64))])),u.item.arn?(t(),s("li",Pk,[e("button",{onClick:C[5]||(C[5]=ie=>l()),class:"dropdown-item"},C[29]||(C[29]=[e("span",{class:"fas fa-fw fa-link me-1"},null,-1),Y("Republish ")]))])):x("",!0),!g.value&&!u.item.arn?(t(),s(A,{key:3},[C[31]||(C[31]=e("li",null,[e("hr",{class:"dropdown-divider"})],-1)),e("li",null,[e("button",{onClick:C[6]||(C[6]=ie=>i()),class:"dropdown-item"},C[30]||(C[30]=[e("span",{class:"fas fa-fw fa-trash me-1"},null,-1),Y("Delete ")]))])],64)):x("",!0)])])):x("",!0),F(ve,{to:`${r.urlSchedulePrograms}/${r.id}`,class:"ms-2 btn btn-primary"},{default:R(()=>C[32]||(C[32]=[e("span",{class:"fas fa-fw fa-calendar"},null,-1)])),_:1},8,["to"]),e("button",{onClick:C[7]||(C[7]=ie=>d()),class:"ms-2 btn btn-secondary"},C[33]||(C[33]=[e("span",{class:"fas fa-fw fa-sync"},null,-1)]))],64)),e("button",{onClick:C[8]||(C[8]=ie=>o(I)(b.urlMain)),class:"btn btn-secondary ms-1"},C[34]||(C[34]=[e("span",{class:"fas fa-fw fa-close"},null,-1)]))]),_:1},8,["pageTitle"]),F(Pe,{errorMessage:o(S)},{default:R(()=>[u.item?(t(),s("div",Uk,[e("ul",Lk,[e("li",Hk,[e("button",{onClick:C[9]||(C[9]=ie=>G("information-tab")),class:te([y("information-tab"),"nav-link"]),id:"information-tab","data-bs-toggle":"tab","data-bs-target":"#information",type:"button",role:"tab","aria-controls":"information","aria-selected":"false"},C[35]||(C[35]=[e("span",{class:"fas fa-fw fa-info-circle me-1"},null,-1),Y("Information ")]),2)]),e("li",Dk,[e("button",{onClick:C[10]||(C[10]=ie=>G("outputPlayback-tab")),class:te([y("outputPlayback-tab"),"nav-link"]),id:"outputPlayback-tab","data-bs-toggle":"tab","data-bs-target":"#outputPlayback",type:"button",role:"tab","aria-controls":"outputPlayback","aria-selected":"false"},C[36]||(C[36]=[e("span",{class:"fas fa-fw fa-gears me-1"},null,-1),Y("Output/Playback ")]),2)]),e("li",Ek,[e("button",{onClick:C[11]||(C[11]=ie=>G("programs-tab")),class:te([y("programs-tab"),"nav-link"]),id:"programs-tab","data-bs-toggle":"tab","data-bs-target":"#programs",type:"button",role:"tab","aria-controls":"programs","aria-selected":"false"},C[37]||(C[37]=[e("span",{class:"fas fa-fw fa-list me-1"},null,-1),Y("Programs ")]),2)]),e("li",qk,[e("button",{onClick:C[12]||(C[12]=ie=>G("preview-tab")),class:te([[g.value?"":"disabled",y("preview-tab")],"nav-link"]),id:"preview-tab","data-bs-toggle":"tab","data-bs-target":"#preview",type:"button",role:"tab","aria-controls":"preview","aria-selected":"false"},C[38]||(C[38]=[e("span",{class:"fas fa-fw fa-list me-1"},null,-1),Y("Preview ")]),2)]),e("li",Bk,[e("button",{onClick:C[13]||(C[13]=ie=>G("checklist-tab")),class:te([y("checklist-tab"),"nav-link"]),id:"checklist-tab","data-bs-toggle":"tab","data-bs-target":"#checklist",type:"button",role:"tab","aria-controls":"checklist","aria-selected":"false"},C[39]||(C[39]=[e("span",{class:"fas fa-fw fa-list-check me-1"},null,-1),Y("Checklist ")]),2)])]),e("div",Nk,[e("div",{class:te([f("information-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",Rk,[e("div",null,[e("div",Fk,[e("div",zk,[e("div",Gk,[e("div",jk,[e("div",Yk,[q(e("input",{"onUpdate:modelValue":C[14]||(C[14]=ie=>u.item.name=ie),type:"text",class:"form-control-plaintext card",id:"name"},null,512),[[ee,u.item.name]]),C[40]||(C[40]=e("label",{for:"name"},"Name",-1))])]),e("div",Kk,[e("div",Wk,[q(e("input",{"onUpdate:modelValue":C[15]||(C[15]=ie=>u.item.playbackMode=ie),type:"text",class:"form-control-plaintext card",id:"playbackMode",readonly:""},null,512),[[ee,u.item.playbackMode]]),C[41]||(C[41]=e("label",{for:"playbackMode"},"Playback Mode",-1))])]),e("div",Qk,[e("div",Jk,[q(e("input",{"onUpdate:modelValue":C[16]||(C[16]=ie=>u.item.tier=ie),type:"text",class:"form-control-plaintext card",id:"tier",readonly:""},null,512),[[ee,u.item.tier]]),C[42]||(C[42]=e("label",{for:"tier"},"Tier",-1))])])]),e("div",Zk,[e("div",Xk,[e("div",eS,[q(e("select",{"onUpdate:modelValue":C[17]||(C[17]=ie=>u.logoUrl=ie),class:"form-select",id:"logoUrl"},[(t(!0),s(A,null,E(u.lookups.logos,ie=>(t(),s("option",{value:ie.url},c(ie.id),9,tS))),256))],512),[[pe,u.logoUrl]]),C[43]||(C[43]=e("label",{for:"logoUrl",class:""},"Logo",-1))]),u.logoUrl!==u.item.logoUrl?(t(),s("button",{key:0,onClick:C[18]||(C[18]=ie=>de()),class:"btn btn-primary"},C[44]||(C[44]=[e("i",{class:"fa-solid fa-save"},null,-1)]))):x("",!0)]),e("div",sS,[e("div",oS,[e("img",{src:u.logoUrl,class:"img-fluid card"},null,8,aS)])])])]),e("div",lS,[e("div",nS,[e("div",rS,[e("div",iS,[e("div",dS,[F(ve,{to:`${r.urlViewSourceLocation}/${u.item.fillerSlateSourceLocation.sourceLocationId}/${o($)()}`,class:te([[u.item.fillerSlateSourceLocation.arn?"is-valid":"is-invalid"],"link-offset-2"]),id:"fillerSlateSourceLocationName"},{default:R(()=>[u.item.fillerSlateSourceLocation.arn?(t(),s("span",uS)):x("",!0),Y(c(u.item.fillerSlateSourceLocation.name),1)]),_:1},8,["to","class"])]),C[45]||(C[45]=e("label",{for:"fillerSlateSourceLocationName"},"Filler Slate Source LocationName",-1))])]),e("div",cS,[e("div",mS,[e("div",fS,[e("div",pS,[F(ve,{to:`${r.urlViewVodSource}/${u.item.fillerSlateVodSource.vodSourceId}/${o($)()}`,class:te([[u.item.fillerSlateVodSource.arn?"is-valid":"is-invalid"],"link-offset-2"]),id:"fillerSlateSourceLocationName",readonly:""},{default:R(()=>[u.item.fillerSlateVodSource.arn?(t(),s("span",vS)):x("",!0),Y(c(u.item.fillerSlateVodSource.name),1)]),_:1},8,["to","class"])]),C[46]||(C[46]=e("label",{for:"fillerSlateVodSourceName"},"Filler Slate Vod SourceName",-1))]),g.value?x("",!0):(t(),s("button",{key:0,onClick:C[19]||(C[19]=ie=>P(u.item.fillerSlateSourceLocation.sourceLocationId,u.item.fillerSlateVodSource.vodSourceId)),class:"btn btn-primary"},C[47]||(C[47]=[e("span",{class:"fas fa-fw fa-edit"},null,-1)])))])])]),C[48]||(C[48]=e("div",{class:"col"},[e("div",{class:"h-100"},[e("video",{id:"video-filler-slate",controls:"",autoplay:"",muted:"",class:"card-img-top object-fit-contain card"})])],-1))])])])])],2),e("div",{class:te([f("outputPlayback-tab"),"tab-pane fade"]),id:"information",role:"tabpanel","aria-labelledby":"information-tab"},[e("div",gS,[e("div",null,[e("div",bS,[C[50]||(C[50]=e("div",null,[e("h5",{class:"m-0"},"Outputs")],-1)),e("div",yS,[e("button",{onClick:C[20]||(C[20]=ie=>v()),class:"btn btn-outline-primary btn-sm"},C[49]||(C[49]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]))])]),u.item.outputs.length<=0?(t(),s("div",$S,C[51]||(C[51]=[e("span",{class:"fas fa-fw fa-info-circle me-1"},null,-1),Y("Channel Output is required ")]))):x("",!0),e("div",hS,[e("table",wS,[C[60]||(C[60]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Manifest"),e("th",null,"Source Group"),e("th",null,"Playback Url"),e("th")])],-1)),q(F(Se,{tag:"tbody",name:"list",class:"table-group-divider align-middle"},{default:R(()=>[(t(!0),s(A,null,E(u.item.outputs,(ie,Ue)=>(t(),s(A,{key:ie.channelOutputId},[e("tr",null,[e("td",null,c(Ue+1),1),e("td",null,[e("div",null,c(ie.manifestName),1),e("div",null,[e("span",_S,c(ie.outputType),1)])]),e("td",null,[e("div",null,[F(ve,{to:`${r.urlViewSourceGroup}/${ie.sourceGroupId}/${o($)()}`,class:"link-offset-2",tag:"button"},{default:R(()=>[Y(c(ie.sourceGroup.name),1)]),_:2},1032,["to"])])]),e("td",null,[ie.playbackUrl?(t(),s("div",kS,c(ie.playbackUrl),1)):(t(),s("div",SS,C[52]||(C[52]=[e("span",{class:"fas fa-fw fa-info-circle"},null,-1),Y("Publish channel to get the playback url ")])))]),g.value?(t(),s("td",TS)):(t(),s("td",IS,[e("button",{onClick:Me=>D(ie.channelOutputId),class:"btn btn-outline-danger btn-sm"},C[53]||(C[53]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,MS)]))]),ie.playbackUrl?(t(),s("tr",xS,[C[58]||(C[58]=e("td",null,null,-1)),C[59]||(C[59]=e("td",null,null,-1)),e("td",CS,[e("div",VS,[C[55]||(C[55]=e("h5",null,[Y("Configuration "),e("sub",null,"(SSAI)")],-1)),e("div",AS,[e("div",OS,[e("button",{onClick:Me=>_(ie),class:"btn btn-outline-primary btn-sm"},C[54]||(C[54]=[e("span",{class:"fas fa-fw fa-plus"},null,-1)]),8,PS)])])]),ie.playbackConfigurations.length>0?(t(),s("div",US,[e("table",LS,[e("tbody",null,[(t(!0),s(A,null,E(ie.playbackConfigurations,(Me,lt)=>(t(),s("tr",HS,[e("td",null,c(lt+1),1),e("td",null,[e("span",DS,c(Me.name),1),e("div",ES,[e("span",null,c(Me.adDecisionServerUrl),1)])]),e("td",qS,[e("div",BS,[Me.arn?x("",!0):(t(),s("button",{key:0,onClick:Ke=>Z(Me.channelOutputPlaybackConfigurationId),class:"btn btn-outline-warning btn-sm ms-1"},C[56]||(C[56]=[e("span",{class:"fas fa-fw fa-link"},null,-1)]),8,NS)),e("button",{onClick:Ke=>se(Me.channelOutputPlaybackConfigurationId),class:"btn btn-outline-danger btn-sm ms-2"},C[57]||(C[57]=[e("span",{class:"fas fa-fw fa-trash"},null,-1)]),8,RS)])])]))),256))])])])):x("",!0)])])):x("",!0)],64))),128))]),_:1},512),[[ke,u.item.outputs.length>0]])])])])])],2),e("div",{class:te([f("programs-tab"),"tab-pane fade"]),id:"programs",role:"tabpanel","aria-labelledby":"programs-tab"},[e("div",FS,[e("div",zS,[e("table",GS,[C[69]||(C[69]=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"#"),e("th",null,"Name"),e("th",{class:"text-center"},"Duration"),e("th",{class:"text-center"},"# Ad Breaks"),e("th")])],-1)),q(F(Se,{tag:"tbody",name:"list",class:"table-group-divider"},{default:R(()=>[(t(!0),s(A,null,E(u.item.programs,(ie,Ue)=>(t(),s(A,{key:ie.programId},[e("tr",jS,[e("td",YS,c(Ue+1),1),e("td",null,[e("div",KS,[e("div",WS,[ie.vodSource.video.thumbnails.length>0?(t(!0),s(A,{key:0},E(ie.vodSource.video.thumbnails,Me=>(t(),s("div",QS,[e("img",{src:Me.url,class:"img-fuild border",width:"128"},null,8,JS)]))),256)):x("",!0)]),e("div",ZS,[ie.arn?(t(),s("span",XS)):x("",!0),e("span",null,c(ie.name),1)]),e("div",e0,[C[61]||(C[61]=Y(" UTC ")),e("div",null,[e("span",t0,c(o(N).moment.utc(ie.dateScheduledStart).format("lll"))+" (utc)",1)]),e("div",null,[e("span",s0,c(o(N).moment.utc(ie.dateScheduledEnd).format("lll"))+" (utc)",1)])]),e("div",o0,[C[62]||(C[62]=Y(" Local ")),e("div",null,[e("span",a0,c(o(N).moment(ie.dateScheduledStart).format("lll"))+" (local)",1)]),e("div",null,[e("span",l0,c(o(N).moment(ie.dateScheduledEnd).format("lll"))+" (local)",1)])])])]),e("td",n0,c(o(N).moment.utc(ie.totalProgramTemplateDurationInMillis).format("HH:mm:ss")),1),e("td",r0,c(ie.adBreaks.length),1),e("td",i0,[e("div",d0,[e("button",{onClick:Me=>ie.expand=!ie.expand,type:"button",class:te([[ie.expand?"btn-secondary":"btn-outline-secondary"],"btn btn-sm"])},[ie.expand?(t(),s("span",c0)):(t(),s("span",m0))],10,u0),C[67]||(C[67]=e("button",{type:"button",class:"btn btn-secondary btn-sm dropdown-toggle dropdown-toggle-split","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("span",{class:"visually-hidden"},"Toggle Dropdown")],-1)),e("ul",f0,[e("li",null,[e("button",{onClick:Me=>B(ie.programId),class:"dropdown-item"},C[63]||(C[63]=[e("span",{class:"fas fa-fw fa-edit me-1"},null,-1),Y("Edit ")]),8,p0)]),ie.arn?(t(),s("li",v0,[e("button",{onClick:Me=>U(ie.programId),class:"dropdown-item"},C[64]||(C[64]=[e("span",{class:"fas fa-fw fa-unlink me-1"},null,-1),Y("Unpublish ")]),8,g0)])):(t(),s(A,{key:1},[e("li",null,[e("button",{onClick:Me=>X(ie.programId),class:"dropdown-item"},C[65]||(C[65]=[e("span",{class:"fas fa-fw fa-link me-1"},null,-1),Y("Publish ")]),8,b0)]),e("li",null,[e("button",{onClick:Me=>w(ie.programId),class:"dropdown-item"},C[66]||(C[66]=[e("span",{class:"fas fa-fw fa-trash me-1"},null,-1),Y("Remove ")]),8,y0)])],64))])])])]),ie.expand?(t(),s("tr",$0,[C[68]||(C[68]=e("td",null,null,-1)),e("td",h0,[F(Ik,{item:ie,urlViewVideo:r.urlViewVideo,urlViewVodSource:r.urlViewVodSource},null,8,["item","urlViewVideo","urlViewVodSource"])])])):x("",!0)],64))),128))]),_:1},512),[[ke,u.item.programs.length>0]])])]),e("div",w0,[e("button",{onClick:C[21]||(C[21]=ie=>h()),class:"btn btn-outline-primary"},C[70]||(C[70]=[e("span",{class:"fas fa-fw fa-plus me-1"},null,-1),Y("Program ")]))])])],2),g.value?(t(),s("div",{key:0,class:te([f("preview-tab"),"tab-pane fade"]),id:"preview",role:"tabpanel","aria-labelledby":"preview-tab"},[e("div",_0,[e("div",k0,[u.item.outputs[0].hls?(t(),s("button",{key:1,onClick:C[23]||(C[23]=ie=>me()),class:"btn btn-primary"},C[72]||(C[72]=[e("span",{class:"fas fa-fw fa-eye-slash"},null,-1)]))):(t(),s("button",{key:0,onClick:C[22]||(C[22]=ie=>O()),class:"btn btn-primary"},C[71]||(C[71]=[e("span",{class:"fas fa-fw fa-eye"},null,-1)])))]),e("div",S0,[(t(!0),s(A,null,E(u.item.outputs,ie=>(t(),s(A,null,[e("div",T0,[e("div",I0,[e("video",{id:`video-${ie.channelOutputId}`,controls:"",class:"card-img-top object-fit-cover shandow"},null,8,M0),e("div",x0,[e("div",C0,c(ie.manifestName),1)])])]),(t(!0),s(A,null,E(ie.playbackConfigurations,(Ue,Me)=>(t(),s("div",V0,[e("div",A0,[e("video",{id:`video-${Ue.channelOutputPlaybackConfigurationId}`,controls:"",class:"card-img-top object-fit-cover"},null,8,O0),e("div",P0,[e("div",U0,[Y(" #"+c(Me+1)+" ",1),e("span",L0,c(Ue.name),1)])])])]))),256))],64))),256))])])],2)):x("",!0),e("div",{class:te([f("checklist-tab"),"tab-pane fade"]),id:"checklist",role:"tabpanel","aria-labelledby":"checklist-tab"},[e("div",H0,[C[78]||(C[78]=Y(" Checklist ")),e("ul",null,[e("li",null,[u.item.fillerSlateSourceLocation.arn?(t(),s("span",D0)):(t(),s("span",E0)),C[73]||(C[73]=Y(" Filler Slate Source Location "))]),e("li",null,[u.item.fillerSlateVodSource.arn?(t(),s("span",q0)):(t(),s("span",B0)),C[74]||(C[74]=Y(" Filler Slate VOD Source "))]),e("li",null,[u.item.outputs.length>0?(t(),s("span",N0)):(t(),s("span",R0)),C[76]||(C[76]=Y(" Outputs ")),e("ul",null,[e("li",null,[u.item.outputs.some(ie=>ie.playbackConfigurations.length>0)?(t(),s("span",F0)):(t(),s("span",z0)),C[75]||(C[75]=Y(" Ad Insertion setup "))])])]),e("li",null,[u.item.programs.length>0?(t(),s("span",G0)):(t(),s("span",j0)),C[77]||(C[77]=Y(" Programs "))])])])],2)])])):x("",!0)]),_:1},8,["errorMessage"]),F(c_,{ref_key:"modalAddProgram",ref:p,onRefresh:d},null,512)])]),_:1})}}},K0={path:"/",component:Ha,props:!1,meta:{requiresAuth:!0},children:[{path:"",component:rl},{path:"videos",children:[{path:"",component:dr},{path:"view/:id",component:Yr,props:!0},{path:"add",component:zl},{path:"edit/:id",component:xn,props:!0}]},{path:"source-groups",children:[{path:"add",component:Jr},{path:"edit/:id",component:$i,props:!0},{path:"",component:Ci},{path:"view/:id",component:zi,props:!0}]},{path:"source-locations",children:[{path:"add",component:Xi},{path:"edit/:id",component:dd,props:!0},{path:"",component:hd},{path:"view/:id",component:jd,props:!0}]},{path:"vod-sources",children:[{path:"add",component:uc},{path:"edit/:id",component:Ec,props:!0},{path:"",component:vm},{path:"view/:id",component:ep,props:!0}]},{path:"channels",children:[{path:"add",component:Sb},{path:"edit/:id",component:Mb,props:!0},{path:"",component:Yb},{path:"schedule-programs/:id",component:rw,props:!0},{path:"view/:id",component:Y0,props:!0}]},{path:"program-templates",children:[{path:"add",component:Gv},{path:"edit/:id",component:Ng,props:!0},{path:"",component:r1},{path:"view/:id",component:G1,props:!0}]}]},at=yt({history:$t("/"),linkActiveClass:"active",routes:[{...ko},{path:"/administrator",redirect:"/"},{...K0}]});at.beforeEach(async r=>{Tt().clear();var T=r.meta;const M=["/accounts/login","/accounts/loginRedirect","/accounts/logout","/accounts/register"],k=T.requiresAuth&&!M.includes(r.path),H=we(),V=H.user;if(k&&!V)return H.returnUrl=r.fullPath,{path:"/accounts/login",query:{returnUrl:encodeURIComponent(r.fullPath)}};var Q=r.meta.roles;if(Q&&!H.user.roles.some(j=>Q.includes(j)))return alert("You are not authorized to acccess this page."),{path:"/accounts/login/",query:{returnUrl:encodeURIComponent(r.fullPath)}}});const W0={props:{uid:{type:String,required:!0},urlViewDeposit:{type:String,required:!1},urlViewWithdraw:{type:String,required:!1},urlViewManualModeOfPayment:{type:String,required:!1}},data(){return{messages:[],count:0}},created(){},async mounted(){await this.connectNotificationHub()},methods:{async connectNotificationHub(){const r=this,T=new ht().withUrl("https://vivafastpoc.azurewebsites.net//notificationHub").withAutomaticReconnect().build();T.on("onNotificationCreated",function(M){let k=M.content;M.notificationEntityClassText==="Deposit"&&(k+="<br/>",k+=`<a href="${r.urlViewDeposit}${M.referenceId}">Click ${M.notificationEntityClassText} here</a>`),M.notificationEntityClassText==="Withdraw"&&(k+="<br/>",k+=`<a href="${r.urlViewWithdraw}${M.referenceId}">Click ${M.notificationEntityClassText} here</a>`),M.notificationEntityClassText==="ManualModeOfPayment"&&(k+="<br/>",k+=`<a href="${r.urlViewManualModeOfPayment}${M.referenceId}">Click ${M.notificationEntityClassText} here</a>`),M.iconClass;let H="secondary";switch(M.notificationType){case 1:H="success";break;case 3:H="info";break;case 3:H="success";break;case 4:H="info";break;case 5:H="warning";break;case 6:H="error";break}r.$toast[H](M.subject,k,{timeOut:1e4});const V=M.subject,S={body:k,icon:"/img/192x102.png"};new Notification(V,S)}),T.on("jobUpdated",function(M){r.$bus.$emit("event:job-updated",M)}),await T.start().then(function(){}).catch(function(M){})}}};function Q0(r,b,T,M,k,H){return t(),s("div")}const J0=Oe(W0,[["render",Q0],["__scopeId","data-v-5b4a9fa2"]]),Z0={class:"navbar bg-dark bg-gradient shadow-sm flex-grow-0","data-bs-theme":"dark"},X0={class:"container-xxl"},eT={class:"col-md"},tT={class:"navbar-brand mb-0 ms-1 align-middle"},sT={class:"col-md-auto"},oT={class:"d-flex flex-row align-items-center justify-content-end"},aT={__name:"_pageHeader",props:{pageIcon:{type:String,required:!0},pageTitle:{type:String,required:!0},headerBreak:{type:String,required:!1,default:""}},setup(r){return(b,T)=>(t(),be($e,null,{default:R(()=>[e("nav",Z0,[e("div",X0,[e("div",eT,[Ee(b.$slots,"title",{},()=>[e("a",tT,[e("i",{class:te([r.pageIcon,"me-1 me-lg-2"])},null,2),e("span",null,c(r.pageTitle),1)])],!0)]),e("div",sT,[e("div",oT,[Ee(b.$slots,"default",{},void 0,!0)])])])])]),_:3}))}},lT=Oe(aT,[["__scopeId","data-v-4d803e86"]]),nT={key:0,class:"alert alert-danger border-0 border-5 border-start border-danger",role:"alert"},rT=["innerHTML"],iT={key:1,class:"alert alert-warning border-0 border-5 border-start border-warning",role:"alert"},dT={__name:"_pageMessages",props:{errorMessage:{type:String,required:!1},vuelidate:{type:Object,required:!1}},setup(r){return(b,T)=>(t(),be($e,null,{default:R(()=>[Ee(b.$slots,"default",{},()=>[r.errorMessage?(t(),s("div",nT,[T[0]||(T[0]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-circle-exclamation me-1"}),Y("Error ")],-1)),e("div",{innerHTML:r.errorMessage},null,8,rT)])):x("",!0),r.vuelidate&&r.vuelidate.$error?(t(),s("div",iT,[T[1]||(T[1]=e("h4",{class:"alert-heading"},[e("i",{class:"fas fa-triangle-exclamation me-1"}),Y("Validation Summary ")],-1)),e("ul",null,[(t(!0),s(A,null,E(r.vuelidate.$errors,M=>(t(),s("li",{key:M.$uid},[M.$validator==="$each"?(t(),s(A,{key:0},[Y(" Check errors in '"+c(M.$property)+"' ",1)],64)):(t(),s(A,{key:1},[Y(c(M.$message),1)],64))]))),128))])])):x("",!0)])]),_:3}))}},uT={class:"py-3 container-xxl flex-grow-1 overflow-y-auto"},cT={__name:"_pageBody",props:{errorMessage:{type:String,required:!1},vuelidate:{type:Object,required:!1}},setup(r){return(b,T)=>{const M=oe("PageMessages");return t(),be($e,null,{default:R(()=>[e("div",uT,[F(M,{errorMessage:r.errorMessage,vuelidate:r.vuelidate},null,8,["errorMessage","vuelidate"]),Ee(b.$slots,"default")])]),_:3})}}},mT={props:{filter:Object,search:Function,noRecords:String,showPerPage:Boolean,busy:Boolean},data(){return{}},created(){},methods:{async changePagination(){const r=this;r.busy||(document.activeElement&&document.activeElement.blur(),await r.search(1))},async moveFirst(){const r=this;if(r.busy)return;r.filter.pageIndex!==1&&(document.activeElement&&document.activeElement.blur(),await r.search(1))},async moveLast(){const r=this;if(r.busy)return;const b=r.filter;b.pageIndex!==b.totalPages&&(document.activeElement&&document.activeElement.blur(),await r.search(b.totalPages))},async move(r){const b=this;if(b.busy)return;const T=b.filter,M=T.pageIndex+r;M>=0&&M<=T.totalPages&&(document.activeElement&&document.activeElement.blur(),await b.search(M))}}},fT={class:"mt-2"},pT={key:0,class:"row row-cols-1 row-cols-sm-2 align-items-center w-100 gy-2 gx-0"},vT={key:0,class:"col-sm order-2 order-sm-1"},gT={class:"d-flex align-items-center small justify-content-center justify-content-sm-start"},bT={class:"me-1 fw-bold"},yT={class:"fw-bold"},$T={class:"ms-1"},hT={class:"col-sm-auto ms-auto order-1 order-sm-2"},wT={class:"pagination m-0 ms-1 justify-content-center justify-content-sm-end"},_T={key:0,class:"page-item"},kT={key:1,class:"page-item"},ST={key:2,class:"page-item"},TT={class:"page-item active"},IT={class:"page-link"},MT={key:3,class:"page-item"},xT={key:4,class:"page-item"},CT={key:5,class:"page-item"},VT={key:1,class:"text-info font-weight-bold text-center"},AT={key:0},OT={key:1};function PT(r,b,T,M,k,H){return t(),s("div",fT,[T.filter.items.length?(t(),s("div",pT,[T.showPerPage?(t(),s("div",vT,[e("div",gT,[e("div",null,[e("span",bT,c(T.filter.totalCount),1),b[8]||(b[8]=Y("records in ")),e("span",yT,c(T.filter.totalPages),1),b[9]||(b[9]=Y(" page(s) "))]),e("div",$T,[q(e("select",{"onUpdate:modelValue":b[0]||(b[0]=V=>T.filter.pageSize=V),onChange:b[1]||(b[1]=(...V)=>H.changePagination&&H.changePagination(...V)),class:"form-select form-select-sm me-1"},b[10]||(b[10]=[Xe('<option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="5">5</option><option value="10">10</option><option value="15">15</option><option value="25">25</option><option value="50">50</option><option value="100">100</option>',9)]),544),[[pe,T.filter.pageSize]])]),b[11]||(b[11]=e("div",{class:"ms-1"},"per page",-1))])])):x("",!0),e("div",hT,[e("ul",wT,[T.filter.pageIndex!==1?(t(),s("li",_T,[e("button",{class:"page-link","aria-label":"Previous",onClick:b[2]||(b[2]=(...V)=>H.moveFirst&&H.moveFirst(...V))},b[12]||(b[12]=[e("span",{class:"fas fa-fw fa-backward-step"},null,-1)]))])):x("",!0),T.filter.pageIndex>2?(t(),s("li",kT,[e("button",{class:"page-link",onClick:b[3]||(b[3]=V=>H.move(-2))},c(T.filter.pageIndex-2),1)])):x("",!0),T.filter.pageIndex>1?(t(),s("li",ST,[e("button",{class:"page-link",onClick:b[4]||(b[4]=V=>H.move(-1))},c(T.filter.pageIndex-1),1)])):x("",!0),e("li",TT,[e("span",IT,c(T.filter.pageIndex),1)]),T.filter.pageIndex<T.filter.totalPages?(t(),s("li",MT,[e("button",{class:"page-link",onClick:b[5]||(b[5]=V=>H.move(1))},c(T.filter.pageIndex+1),1)])):x("",!0),T.filter.pageIndex<T.filter.totalPages-1?(t(),s("li",xT,[e("button",{class:"page-link",onClick:b[6]||(b[6]=V=>H.move(2))},c(T.filter.pageIndex+2),1)])):x("",!0),T.filter.pageIndex<T.filter.totalPages?(t(),s("li",CT,[e("button",{class:"page-link","aria-label":"Next",onClick:b[7]||(b[7]=(...V)=>H.moveLast&&H.moveLast(...V))},b[13]||(b[13]=[e("span",{class:"fas fa-fw fa-forward-step"},null,-1)]))])):x("",!0)])])])):(t(),s("div",VT,[T.noRecords?(t(),s("div",AT,c(T.noRecords),1)):(t(),s("div",OT,"No record(s) found."))]))])}const UT=Oe(mT,[["render",PT]]),LT={props:{filter:Object,field:String,showSort:Boolean,enabled:Boolean},data(){return{}},mounted(){},methods:{currentSortField(){return this.filter.sortField===this.field},sortUp(){return this.filter.sortOrder===1},click(){let r=this;if(!r.enabled)return;let b=r.filter;b.sortField===r.field?b.sortOrder===0?b.sortField=null:b.sortOrder=b.sortOrder===0?1:0:(b.sortField=r.field,b.sortOrder=1),r.$emit("search")}}},HT={class:"align-self-center"};function DT(r,b,T,M,k,H){return t(),s("div",{onClick:b[0]||(b[0]=(...V)=>H.click&&H.click(...V)),class:"d-flex flex-row justify-content-start align-content-center",style:dt({cursor:T.enabled?"pointer":""})},[Ee(r.$slots,"default"),e("span",HT,[T.showSort?(t(),s("span",{key:0,class:te([{"fa-sort text-gray-500":!H.currentSortField(),"fa-sort-up":H.currentSortField()&&H.sortUp(),"fa-sort-down":H.currentSortField()&&!H.sortUp()},"fas fa-fw mr-1"])},null,2)):x("",!0)])],4)}const ET=Oe(LT,[["render",DT]]),qT={props:{items:Array,header:Object,getRowNumber:Function,setSelected:Function,isSelected:Function,tableCss:String,rowCss:String},data(){return{}},mounted(){},methods:{onSelectedRow(r){const b=this;b.setSelected(r),b.$emit("onSelectedRow",r)}}},BT={class:"table-responsive m-0"},NT=["href"],RT={key:1},FT=["onClick"],zT={class:"form-group row no-gutters"},GT={class:"col-5 col-form-label"},jT={class:"col align-self-center"},YT=["href"],KT={key:1};function WT(r,b,T,M,k,H){return t(),s("div",null,[e("div",BT,[e("table",{class:te(["table table-hover d-none d-md-table card",T.tableCss])},[e("thead",null,[Ee(r.$slots,"header",{},()=>[b[0]||(b[0]=e("th",null,"#",-1)),(t(!0),s(A,null,E(T.header.columns,V=>(t(),s("th",null,c(V.title),1))),256))],!0)]),e("tbody",null,[(t(!0),s(A,null,E(T.items,(V,Q)=>Ee(r.$slots,"table-row",{key:`row1-${V[T.header.key]}`,item:V,index:Q},()=>[e("td",null,c(T.getRowNumber(Q)),1),(t(!0),s(A,null,E(T.header.columns,j=>(t(),s("td",null,[j.href?(t(),s("a",{key:0,href:j.href(V[T.header.key]),class:"font-weight-bold"},c(V[j.field]),9,NT)):(t(),s("span",RT,c(V[j.field]),1))]))),256))],!0)),128))])],2)]),e("div",{class:te(["d-block d-md-none",T.rowCss])},[(t(!0),s(A,null,E(T.items,(V,Q)=>(t(),s("div",{key:`row2-${V[T.header.key]}`,onClick:j=>H.onSelectedRow(V),class:"border"},[e("div",{class:te(["p-2",{"b-left":T.isSelected(V)}])},[Ee(r.$slots,"table-list",{item:V,index:Q},()=>[(t(!0),s(A,null,E(T.header.columns,j=>(t(),s("div",zT,[e("label",GT,c(j.title),1),e("div",jT,[j.href?(t(),s("a",{key:0,href:j.href(V[T.header.key]),class:"font-weight-bold"},c(V[j.field]),9,YT)):(t(),s("span",KT,c(V[j.field]),1))])]))),256))],!0)],2)],8,FT))),128))],2)])}const QT=Oe(qT,[["render",WT],["__scopeId","data-v-65929213"]]),Ve=wt(St);Ve.use(_t());Ve.use(kt);Ve.use(at);Ve.component("m-notification",J0);Ve.component("m-pagination",UT);Ve.component("sort-field",ET);Ve.component("table-list",QT);Ve.component("Toasts",Oa);Ve.component("PageHeader",lT);Ve.component("PageMessages",dT);Ve.component("PageBody",cT);const JT="https://vivafastpoc.azurewebsites.net/",ZT="Arcadian-FAST",XT=void 0,eI={API_URL:JT,appName:ZT,tenantId:XT};Ve.provide("$config",eI);Ve.provide("$bus",st);Ve.mount("#app");
